{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$ref": "#/definitions/AuterionAppYml",
    "definitions": {
      "AuterionAppYml": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "auterion-api-version": {
            "type": "integer",
            "const": 2
          },
          "auterion-app-base": {
            "type": "string",
            "pattern": "^v\\d+|none$"
          },
          "app-name": {
            "type": "string",
            "pattern": "^[a-z0-9-_]+$"
          },
          "app-author": {
            "type": "string",
            "pattern": "^[a-z]+(\\.[a-z][a-z0-9-_]*)*$"
          },
          "app-version": {
            "type": "string"
          },
          "target-platform": {
            "anyOf": [
              {
                "$ref": "#/definitions/AuterionAppYmlTargetPlatform"
              },
              {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/AuterionAppYmlTargetPlatform"
                }
              }
            ]
          },
          "system-app": {
            "type": "boolean"
          },
          "dependencies": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^[a-z]+(\\.[a-z][a-z0-9-_]*)*$": {
                "type": "string"
              }
            },
            "minProperties": 1
          },
          "services": {
            "$ref": "#/definitions/AuterionAppYmlServices"
          },
          "compose-override": {
            "$ref": "compose-spec.json"
          }
        },
        "required": [
          "app-author",
          "app-name",
          "app-version",
          "auterion-api-version",
          "auterion-app-base",
          "services",
          "target-platform"
        ],
        "title": "AuterionAppYml"
      },
      "AuterionAppYmlTargetPlatform": {
        "type": "string"
      },
      "AuterionAppYmlServices": {
        "type": "object",
        "additionalProperties": false,
        "patternProperties": {
          "^[a-z0-9-_]+$": {
            "$ref": "#/definitions/AuterionAppYmlService"
          }
        },
        "title": "AuterionAppYmlServices",
        "minProperties": 1
      },
      "AuterionAppYmlService": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "build": {
            "type": "string"
          },
          "image": {
            "type": "string"
          },
          "http": {
            "$ref": "#/definitions/AuterionAppYmlServiceHttps"
          },
          "ssh": {
            "type": "boolean"
          }
        },
        "oneOf": [
          {
            "required": [
              "build"
            ]
          },
          {
            "required": [
              "image"
            ]
          }
        ],
        "title": "AuterionAppYmlService"
      },
      "AuterionAppYmlServiceHttps": {
        "type": "object",
        "additionalProperties": false,
        "patternProperties": {
          "^[-a-zA-Z0-9()@:%_\\+.~#?&/=]+$": {
            "$ref": "#/definitions/AuterionAppYmlServiceHttp"
          }
        },
        "title": "AuterionAppYmlServiceHttps",
        "minProperties": 1
      },
      "AuterionAppYmlServiceHttp": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "static-root": {
            "type": "string"
          },
          "proxy": {
            "$ref": "#/definitions/AuterionAppYmlServiceHttpProxy"
          },
          "function": {
            "anyOf": [
              {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/AuterionAppYmlServiceHttpFunction"
                }
              },
              {
                "$ref": "#/definitions/AuterionAppYmlServiceHttpFunction"
              }
            ]
          }
        },
        "title": "AuterionAppYmlServiceHttp",
        "oneOf": [
          {
            "required": [
              "static-root"
            ]
          },
          {
            "required": [
              "proxy"
            ]
          }
        ]
      },
      "AuterionAppYmlServiceHttpProxy": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "port": {
            "type": "number"
          }
        },
        "required": [
          "port"
        ],
        "title": "AuterionAppYmlServiceHttpProxy"
      },
      "AuterionAppYmlServiceHttpFunction": {
        "anyOf": [
          {
            "$ref": "#/definitions/AuterionAppYmlServiceHttpUIFunction"
          },
          {
            "$ref": "#/definitions/AuterionAppYmlServiceHttpCameraFunction"
          },
          {
            "$ref": "#/definitions/AuterionAppYmlServiceHttpUnknownFunction"
          }
        ]
      },
      "AuterionAppYmlServiceHttpUIFunction": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "type": {
            "type": "string",
            "pattern": "^ui$"
          },
          "label": {
            "type": "string"
          }
        },
        "required": [
          "label",
          "type"
        ]
      },
      "AuterionAppYmlServiceHttpCameraFunction": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "type": {
            "type": "string",
            "pattern": "^camera$"
          }
        },
        "required": [
          "type"
        ]
      },
      "AuterionAppYmlServiceHttpUnknownFunction": {
        "type": "object",
        "additionalProperties": true
      }
    }
  }