{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Minimal Analysis Payload",
  "description": "Privacy-preserving dataset analysis with no raw content",
  "type": "object",
  "required": [
    "schema_version",
    "datasets",
    "extensions",
    "estimated",
    "includes_symlinks"
  ],
  "properties": {
    "schema_version": {
      "type": "string",
      "const": "analysis.min.v1",
      "description": "Schema version identifier"
    },
    "datasets": {
      "type": "array",
      "description": "List of analyzed datasets",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "files", "bytes"],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^ds_[a-f0-9]{10}$",
            "description": "Deterministic, non-reversible dataset identifier"
          },
          "files": {
            "type": "integer",
            "minimum": 0,
            "description": "Total number of files"
          },
          "bytes": {
            "type": "integer",
            "minimum": 0,
            "description": "Total size in bytes"
          },
          "mtime_latest": {
            "type": ["string", "null"],
            "format": "date-time",
            "description": "Latest modification timestamp (ISO 8601)"
          }
        }
      }
    },
    "extensions": {
      "type": "object",
      "description": "File extension histogram with k-anonymity applied",
      "additionalProperties": {
        "type": "integer",
        "minimum": 1
      }
    },
    "evidence_refs": {
      "type": "object",
      "description": "References to locally-generated evidence files",
      "additionalProperties": {
        "type": "string",
        "description": "Local file path (not uploaded)"
      }
    },
    "estimated": {
      "type": "boolean",
      "description": "Whether statistics are estimated (for huge datasets)"
    },
    "includes_symlinks": {
      "type": "boolean",
      "description": "Whether symlinks were followed during analysis"
    }
  },
  "additionalProperties": false
}