# -*- coding: utf-8 -*-

import importlib.machinery
import io
import time

from scuq import *

from mpylab.device import device
from mpylab.device.nport import NPORT
from mpylab.device.powermeter import POWERMETER as PWRMTR
from mpylab.tools.Configuration import Configuration
from mpylab.tools.util import format_block
from mpylab.tools.util import locate

ini20dBLF = format_block("""
                    [description]
                    DESCRIPTION = 20 dB rx path, LF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = io.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.000000e+07 [-20.25, -82.65] [-20.05, -81.65] [-19.85, -80.65]
                                                        1.000000e+07 [-20.25, -82.65] [-20.05, -81.65] [-19.85, -80.65]
                                                        1.038189e+07 [-20.19, -85.70] [-19.99, -84.70] [-19.79, -83.70]
                                                        1.077836e+07 [-20.54, -89.94] [-20.34, -88.94] [-20.14, -87.94]
                                                        1.118997e+07 [-20.46, -90.99] [-20.26, -89.99] [-20.06, -88.99]
                                                        1.161731e+07 [-20.73, -94.41] [-20.53, -93.41] [-20.33, -92.41]
                                                        1.206096e+07 [-20.70, -98.51] [-20.50, -97.51] [-20.30, -96.51]
                                                        1.252155e+07 [-20.26, -103.83] [-20.06, -102.83] [-19.86, -101.83]
                                                        1.299974e+07 [-20.37, -110.05] [-20.17, -109.05] [-19.97, -108.05]
                                                        1.349618e+07 [-20.21, -112.13] [-20.01, -111.13] [-19.81, -110.13]
                                                        1.401158e+07 [-20.60, -114.53] [-20.40, -113.53] [-20.20, -112.53]
                                                        1.454667e+07 [-20.43, -118.23] [-20.23, -117.23] [-20.03, -116.23]
                                                        1.510219e+07 [-20.64, -124.18] [-20.44, -123.18] [-20.24, -122.18]
                                                        1.567893e+07 [-20.71, -129.87] [-20.51, -128.87] [-20.31, -127.87]
                                                        1.627769e+07 [-20.61, -130.57] [-20.41, -129.57] [-20.21, -128.57]
                                                        1.689931e+07 [-20.60, -136.99] [-20.40, -135.99] [-20.20, -134.99]
                                                        1.754468e+07 [-20.49, -144.78] [-20.29, -143.78] [-20.09, -142.78]
                                                        1.821469e+07 [-20.56, -146.76] [-20.36, -145.76] [-20.16, -144.76]
                                                        1.891029e+07 [-20.72, -153.52] [-20.52, -152.52] [-20.32, -151.52]
                                                        1.963245e+07 [-20.63, -160.62] [-20.43, -159.62] [-20.23, -158.62]
                                                        2.038219e+07 [-20.53, -167.53] [-20.33, -166.53] [-20.13, -165.53]
                                                        2.116056e+07 [-20.53, -172.80] [-20.33, -171.80] [-20.13, -170.80]
                                                        2.196866e+07 [-20.41, -179.36] [-20.21, -178.36] [-20.01, -177.36]
                                                        2.280762e+07 [-20.85, 172.58] [-20.65, 173.58] [-20.45, 174.58]
                                                        2.367862e+07 [-20.52, 167.35] [-20.32, 168.35] [-20.12, 169.35]
                                                        2.458288e+07 [-20.56, 160.01] [-20.36, 161.01] [-20.16, 162.01]
                                                        2.552167e+07 [-20.70, 151.41] [-20.50, 152.41] [-20.30, 153.41]
                                                        2.649631e+07 [-20.62, 144.96] [-20.42, 145.96] [-20.22, 146.96]
                                                        2.750818e+07 [-20.67, 136.33] [-20.47, 137.33] [-20.27, 138.33]
                                                        2.855868e+07 [-20.54, 127.13] [-20.34, 128.13] [-20.14, 129.13]
                                                        2.964930e+07 [-20.74, 118.30] [-20.54, 119.30] [-20.34, 120.30]
                                                        3.078158e+07 [-20.69, 108.93] [-20.49, 109.93] [-20.29, 110.93]
                                                        3.195709e+07 [-20.71, 101.02] [-20.51, 102.02] [-20.31, 103.02]
                                                        3.317750e+07 [-20.74, 89.82] [-20.54, 90.82] [-20.34, 91.82]
                                                        3.444451e+07 [-20.80, 79.55] [-20.60, 80.55] [-20.40, 81.55]
                                                        3.575990e+07 [-20.71, 69.50] [-20.51, 70.50] [-20.31, 71.50]
                                                        3.712553e+07 [-20.58, 58.02] [-20.38, 59.02] [-20.18, 60.02]
                                                        3.854331e+07 [-20.68, 47.67] [-20.48, 48.67] [-20.28, 49.67]
                                                        4.001524e+07 [-20.70, 35.98] [-20.50, 36.98] [-20.30, 37.98]
                                                        4.154338e+07 [-20.58, 22.48] [-20.38, 23.48] [-20.18, 24.48]
                                                        4.312987e+07 [-20.77, 10.72] [-20.57, 11.72] [-20.37, 12.72]
                                                        4.477695e+07 [-20.79, -4.04] [-20.59, -3.04] [-20.39, -2.04]
                                                        4.648693e+07 [-20.75, -17.05] [-20.55, -16.05] [-20.35, -15.05]
                                                        4.826221e+07 [-20.82, -30.96] [-20.62, -29.96] [-20.42, -28.96]
                                                        5.010529e+07 [-20.82, -45.67] [-20.62, -44.67] [-20.42, -43.67]
                                                        5.201875e+07 [-20.81, -61.60] [-20.61, -60.60] [-20.41, -59.60]
                                                        5.400529e+07 [-20.80, -77.65] [-20.60, -76.65] [-20.40, -75.65]
                                                        5.606769e+07 [-20.72, -94.81] [-20.52, -93.81] [-20.32, -92.81]
                                                        5.820885e+07 [-20.81, -111.20] [-20.61, -110.20] [-20.41, -109.20]
                                                        6.043178e+07 [-20.92, -129.48] [-20.72, -128.48] [-20.52, -127.48]
                                                        6.273960e+07 [-20.81, -148.31] [-20.61, -147.31] [-20.41, -146.31]
                                                        6.513556e+07 [-20.82, -167.12] [-20.62, -166.12] [-20.42, -165.12]
                                                        6.762301e+07 [-20.81, 173.27] [-20.61, 174.27] [-20.41, 175.27]
                                                        7.020545e+07 [-20.79, 152.04] [-20.59, 153.04] [-20.39, 154.04]
                                                        7.288652e+07 [-20.84, 130.52] [-20.64, 131.52] [-20.44, 132.52]
                                                        7.566997e+07 [-20.86, 108.27] [-20.66, 109.27] [-20.46, 110.27]
                                                        7.855972e+07 [-20.89, 85.04] [-20.69, 86.04] [-20.49, 87.04]
                                                        8.155983e+07 [-20.85, 60.44] [-20.65, 61.44] [-20.45, 62.44]
                                                        8.467450e+07 [-20.86, 35.82] [-20.66, 36.82] [-20.46, 37.82]
                                                        8.790813e+07 [-20.90, 9.90] [-20.70, 10.90] [-20.50, 11.90]
                                                        9.126524e+07 [-20.94, -17.44] [-20.74, -16.44] [-20.54, -15.44]
                                                        9.475055e+07 [-20.89, -45.30] [-20.69, -44.30] [-20.49, -43.30]
                                                        9.836897e+07 [-20.93, -75.00] [-20.73, -74.00] [-20.53, -73.00]
                                                        1.021256e+08 [-20.96, -104.73] [-20.76, -103.73] [-20.56, -102.73]
                                                        1.060256e+08 [-21.01, -136.17] [-20.81, -135.17] [-20.61, -134.17]
                                                        1.100746e+08 [-20.97, -168.91] [-20.77, -167.91] [-20.57, -166.91]
                                                        1.142782e+08 [-20.99, 157.59] [-20.79, 158.59] [-20.59, 159.59]
                                                        1.186424e+08 [-21.03, 122.03] [-20.83, 123.03] [-20.63, 124.03]
                                                        1.231732e+08 [-21.03, 85.92] [-20.83, 86.92] [-20.63, 87.92]
                                                        1.278771e+08 [-21.01, 47.87] [-20.81, 48.87] [-20.61, 49.87]
                                                        1.327605e+08 [-21.04, 8.66] [-20.84, 9.66] [-20.64, 10.66]
                                                        1.378305e+08 [-21.08, -31.98] [-20.88, -30.98] [-20.68, -29.98]
                                                        1.430941e+08 [-21.11, -74.43] [-20.91, -73.43] [-20.71, -72.43]
                                                        1.485587e+08 [-21.11, -118.17] [-20.91, -117.17] [-20.71, -116.17]
                                                        1.542320e+08 [-21.11, -163.99] [-20.91, -162.99] [-20.71, -161.99]
                                                        1.601219e+08 [-21.11, 148.80] [-20.91, 149.80] [-20.71, 150.80]
                                                        1.662368e+08 [-21.16, 99.58] [-20.96, 100.58] [-20.76, 101.58]
                                                        1.725852e+08 [-21.13, 48.46] [-20.93, 49.46] [-20.73, 50.46]
                                                        1.791760e+08 [-21.17, -4.55] [-20.97, -3.55] [-20.77, -2.55]
                                                        1.860186e+08 [-21.18, -59.55] [-20.98, -58.55] [-20.78, -57.55]
                                                        1.931224e+08 [-21.23, -116.56] [-21.03, -115.56] [-20.83, -114.56]
                                                        2.004975e+08 [-21.23, -175.93] [-21.03, -174.93] [-20.83, -173.93]
                                                        2.081543e+08 [-21.24, 122.50] [-21.04, 123.50] [-20.84, 124.50]
                                                        2.161035e+08 [-21.27, 58.63] [-21.07, 59.63] [-20.87, 60.63]
                                                        2.243562e+08 [-21.27, -7.70] [-21.07, -6.70] [-20.87, -5.70]
                                                        2.329241e+08 [-21.33, -76.58] [-21.13, -75.58] [-20.93, -74.58]
                                                        2.418192e+08 [-21.33, -148.05] [-21.13, -147.05] [-20.93, -146.05]
                                                        2.510540e+08 [-21.34, 137.82] [-21.14, 138.82] [-20.94, 139.82]
                                                        2.606415e+08 [-21.36, 60.55] [-21.16, 61.55] [-20.96, 62.55]
                                                        2.705951e+08 [-21.37, -19.29] [-21.17, -18.29] [-20.97, -17.29]
                                                        2.809288e+08 [-21.43, -102.45] [-21.23, -101.45] [-21.03, -100.45]
                                                        2.916571e+08 [-21.43, 171.34] [-21.23, 172.34] [-21.03, 173.34]
                                                        3.027952e+08 [-21.45, 81.81] [-21.25, 82.81] [-21.05, 83.81]
                                                        3.143586e+08 [-21.47, -11.11] [-21.27, -10.11] [-21.07, -9.11]
                                                        3.263636e+08 [-21.50, -107.63] [-21.30, -106.63] [-21.10, -105.63]
                                                        3.388271e+08 [-21.51, 152.25] [-21.31, 153.25] [-21.11, 154.25]
                                                        3.517665e+08 [-21.53, 48.30] [-21.33, 49.30] [-21.13, 50.30]
                                                        3.652000e+08 [-21.56, -59.66] [-21.36, -58.66] [-21.16, -57.66]
                                                        3.791466e+08 [-21.58, -171.63] [-21.38, -170.63] [-21.18, -169.63]
                                                        3.936258e+08 [-21.61, 71.90] [-21.41, 72.90] [-21.21, 73.90]
                                                        4.086579e+08 [-21.63, -48.78] [-21.43, -47.78] [-21.23, -46.78]
                                                        4.242641e+08 [-21.66, -174.17] [-21.46, -173.17] [-21.26, -172.17]
                                                        4.404662e+08 [-21.68, 55.54] [-21.48, 56.54] [-21.28, 57.54]
                                                        4.572871e+08 [-21.71, -79.58] [-21.51, -78.58] [-21.31, -77.58]
                                                        4.747504e+08 [-21.75, 140.13] [-21.55, 141.13] [-21.35, 142.13]
                                                        4.928806e+08 [-21.76, -5.49] [-21.56, -4.49] [-21.36, -3.49]
                                                        5.117031e+08 [-21.80, -156.69] [-21.60, -155.69] [-21.40, -154.69]
                                                        5.312445e+08 [-21.82, 46.31] [-21.62, 47.31] [-21.42, 48.31]
                                                        5.515321e+08 [-21.85, -116.76] [-21.65, -115.76] [-21.45, -114.76]
                                                        5.725945e+08 [-21.89, 74.18] [-21.69, 75.18] [-21.49, 76.18]
                                                        5.944612e+08 [-21.90, -101.50] [-21.70, -100.50] [-21.50, -99.50]
                                                        6.171630e+08 [-21.93, 76.12] [-21.73, 77.12] [-21.53, 78.12]
                                                        6.407317e+08 [-21.98, -113.26] [-21.78, -112.26] [-21.58, -111.26]
                                                        6.652006e+08 [-22.01, 50.25] [-21.81, 51.25] [-21.61, 52.25]
                                                        6.906038e+08 [-22.02, -153.77] [-21.82, -152.77] [-21.62, -151.77]
                                                        7.169772e+08 [-22.07, -5.56] [-21.87, -4.56] [-21.67, -3.56]
                                                        7.443577e+08 [-22.12, 134.58] [-21.92, 135.58] [-21.72, 136.58]
                                                        7.727839e+08 [-22.13, -93.83] [-21.93, -92.83] [-21.73, -91.83]
                                                        8.022956e+08 [-22.17, 28.98] [-21.97, 29.98] [-21.77, 30.98]
                                                        8.329344e+08 [-22.21, 142.91] [-22.01, 143.91] [-21.81, 144.91]
                                                        8.647432e+08 [-22.24, -112.56] [-22.04, -111.56] [-21.84, -110.56]
                                                        8.977667e+08 [-22.28, -17.69] [-22.08, -16.69] [-21.88, -15.69]
                                                        9.320514e+08 [-22.31, 67.06] [-22.11, 68.06] [-21.91, 69.06]
                                                        9.676454e+08 [-22.36, 140.99] [-22.16, 141.99] [-21.96, 142.99]
                                                        1.004599e+09 [-22.41, -155.53] [-22.21, -154.53] [-22.01, -153.53]
                                                        1.042963e+09 [-22.44, -103.87] [-22.24, -102.87] [-22.04, -101.87]
                                                        1.082793e+09 [-22.50, -63.39] [-22.30, -62.39] [-22.10, -61.39]
                                                        1.124143e+09 [-22.51, -35.57] [-22.31, -34.57] [-22.11, -33.57]
                                                        1.167073e+09 [-22.58, -20.21] [-22.38, -19.21] [-22.18, -18.21]
                                                        1.211642e+09 [-22.61, -18.31] [-22.41, -17.31] [-22.21, -16.31]
                                                        1.257913e+09 [-22.69, -29.47] [-22.49, -28.47] [-22.29, -27.47]
                                                        1.305952e+09 [-22.71, -55.60] [-22.51, -54.60] [-22.31, -53.60]
                                                        1.355825e+09 [-22.76, -95.66] [-22.56, -94.66] [-22.36, -93.66]
                                                        1.407602e+09 [-22.82, -151.63] [-22.62, -150.63] [-22.42, -149.63]
                                                        1.461357e+09 [-22.83, 136.78] [-22.63, 137.78] [-22.43, 138.78]
                                                        1.517164e+09 [-22.89, 48.80] [-22.69, 49.80] [-22.49, 50.80]
                                                        1.575103e+09 [-22.97, -56.63] [-22.77, -55.63] [-22.57, -54.63]
                                                        1.635254e+09 [-22.96, -179.48] [-22.76, -178.48] [-22.56, -177.48]
                                                        1.697703e+09 [-23.01, 39.26] [-22.81, 40.26] [-22.61, 41.26]
                                                        1.762536e+09 [-23.12, -121.40] [-22.92, -120.40] [-22.72, -119.40]
                                                        1.829845e+09 [-23.16, 57.87] [-22.96, 58.87] [-22.76, 59.87]
                                                        1.899725e+09 [-23.18, -143.60] [-22.98, -142.60] [-22.78, -141.60]
                                                        1.972273e+09 [-23.21, -5.73] [-23.01, -4.73] [-22.81, -3.73]
                                                        2.047592e+09 [-23.25, 109.66] [-23.05, 110.66] [-22.85, 111.66]
                                                        2.125787e+09 [-23.33, -158.12] [-23.13, -157.12] [-22.93, -156.12]
                                                        2.206969e+09 [-23.43, -89.81] [-23.23, -88.81] [-23.03, -87.81]
                                                        2.291250e+09 [-23.47, -46.64] [-23.27, -45.64] [-23.07, -44.64]
                                                        2.378751e+09 [-23.59, -28.84] [-23.39, -27.84] [-23.19, -26.84]
                                                        2.469592e+09 [-23.58, -38.60] [-23.38, -37.60] [-23.18, -36.60]
                                                        2.563903e+09 [-23.64, -73.98] [-23.44, -72.98] [-23.24, -71.98]
                                                        2.661816e+09 [-23.70, -142.97] [-23.50, -141.97] [-23.30, -140.97]
                                                        2.763468e+09 [-23.92, 121.27] [-23.72, 122.27] [-23.52, 123.27]
                                                        2.869001e+09 [-24.07, -5.43] [-23.87, -4.43] [-23.67, -3.43]
                                                        2.978565e+09 [-24.03, -163.82] [-23.83, -162.82] [-23.63, -161.82]
                                                        3.092313e+09 [-24.12, 0.70] [-23.92, 1.70] [-23.72, 2.70]
                                                        3.210405e+09 [-24.36, 134.02] [-24.16, 135.02] [-23.96, 136.02]
                                                        3.333007e+09 [-24.28, -129.40] [-24.08, -128.40] [-23.88, -127.40]
                                                        3.460290e+09 [-24.61, -72.53] [-24.41, -71.53] [-24.21, -70.53]
                                                        3.592435e+09 [-24.39, -51.64] [-24.19, -50.64] [-23.99, -49.64]
                                                        3.729626e+09 [-24.87, -72.57] [-24.67, -71.57] [-24.47, -70.57]
                                                        3.872056e+09 [-24.81, -137.95] [-24.61, -136.95] [-24.41, -135.95]
                                                        4.019925e+09 [-24.61, 116.67] [-24.41, 117.67] [-24.21, 118.67]
                                                        4.173442e+09 [-24.78, -33.87] [-24.58, -32.87] [-24.38, -31.87]
                                                        4.332821e+09 [-25.05, 127.07] [-24.85, 128.07] [-24.65, 129.07]
                                                        4.498286e+09 [-25.28, -122.06] [-25.08, -121.06] [-24.88, -120.06]
                                                        4.670071e+09 [-25.50, -61.61] [-25.30, -60.61] [-25.10, -59.61]
                                                        4.848415e+09 [-25.41, -53.43] [-25.21, -52.43] [-25.01, -51.43]
                                                        5.033571e+09 [-25.51, -100.42] [-25.31, -99.42] [-25.11, -98.42]
                                                        5.225797e+09 [-25.68, 155.92] [-25.48, 156.92] [-25.28, 157.92]
                                                        5.425364e+09 [-26.16, -3.82] [-25.96, -2.82] [-25.76, -1.82]
                                                        5.632553e+09 [-25.83, 134.58] [-25.63, 135.58] [-25.43, 136.58]
                                                        5.847653e+09 [-26.00, -152.15] [-25.80, -151.15] [-25.60, -150.15]
                                                        6.070969e+09 [-25.63, -144.68] [-25.43, -143.68] [-25.23, -142.68]
                                                        6.302812e+09 [-25.83, 154.47] [-25.63, 155.47] [-25.43, 156.47]
                                                        6.543509e+09 [-26.19, 23.46] [-25.99, 24.46] [-25.79, 25.46]
                                                        6.793398e+09 [-26.01, 175.89] [-25.81, 176.89] [-25.61, 177.89]
                                                        7.052830e+09 [-26.30, -107.01] [-26.10, -106.01] [-25.90, -105.01]
                                                        7.322170e+09 [-26.38, -107.38] [-26.18, -106.38] [-25.98, -105.38]
                                                        7.601795e+09 [-26.13, 166.56] [-25.93, 167.56] [-25.73, 168.56]
                                                        7.892099e+09 [-26.52, -5.34] [-26.32, -4.34] [-26.12, -3.34]
                                                        8.193489e+09 [-26.44, 97.52] [-26.24, 98.52] [-26.04, 99.52]
                                                        8.506389e+09 [-26.71, 106.16] [-26.51, 107.16] [-26.31, 108.16]
                                                        8.831239e+09 [-26.67, 18.62] [-26.47, 19.62] [-26.27, 20.62]
                                                        9.168493e+09 [-26.85, -169.63] [-26.65, -168.63] [-26.45, -167.63]
                                                        9.518628e+09 [-26.80, -103.13] [-26.60, -102.13] [-26.40, -101.13]
                                                        9.882133e+09 [-26.67, -140.68] [-26.47, -139.68] [-26.27, -138.68]
                                                        1.025952e+10 [-26.76, 67.93] [-26.56, 68.93] [-26.36, 69.93]
                                                        1.065132e+10 [-27.17, 165.05] [-26.97, 166.05] [-26.77, 167.05]
                                                        1.105808e+10 [-27.32, 137.08] [-27.12, 138.08] [-26.92, 139.08]
                                                        1.148038e+10 [-27.20, -14.28] [-27.00, -13.28] [-26.80, -12.28]
                                                        1.191880e+10 [-27.55, 65.43] [-27.35, 66.43] [-27.15, 67.43]
                                                        1.237396e+10 [-27.48, 12.37] [-27.28, 13.37] [-27.08, 14.37]
                                                        1.284651e+10 [-27.35, 174.95] [-27.15, 175.95] [-26.95, 176.95]
                                                        1.333711e+10 [-27.23, -163.20] [-27.03, -162.20] [-26.83, -161.20]
                                                        1.384643e+10 [-27.34, 64.80] [-27.14, 65.80] [-26.94, 66.80]
                                                        1.437521e+10 [-27.74, 136.55] [-27.54, 137.55] [-27.34, 138.55]
                                                        1.492419e+10 [-27.55, 45.92] [-27.35, 46.92] [-27.15, 47.92]
                                                        1.549412e+10 [-28.12, 146.64] [-27.92, 147.64] [-27.72, 148.64]
                                                        1.608583e+10 [-28.75, 71.62] [-28.55, 72.62] [-28.35, 73.62]
                                                        1.670013e+10 [-29.04, -179.59] [-28.84, -178.59] [-28.64, -177.59]
                                                        1.733789e+10 [-28.63, 91.57] [-28.43, 92.57] [-28.23, 93.57]
                                                        1.800000e+10 [-28.93, 167.97] [-28.73, 168.97] [-28.53, 169.97]
                                                        '''))
                    """)

ini20dBHF = format_block("""
                    [description]
                    DESCRIPTION = 20 dB rx path, HF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = io.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.000000e+07 [-20.27, -75.63] [-20.07, -74.63] [-19.87, -73.63]
                                                        1.000000e+07 [-20.27, -75.63] [-20.07, -74.63] [-19.87, -73.63]
                                                        1.038189e+07 [-20.19, -77.77] [-19.99, -76.77] [-19.79, -75.77]
                                                        1.077836e+07 [-20.49, -81.76] [-20.29, -80.76] [-20.09, -79.76]
                                                        1.118997e+07 [-20.48, -81.98] [-20.28, -80.98] [-20.08, -79.98]
                                                        1.161731e+07 [-20.80, -85.16] [-20.60, -84.16] [-20.40, -83.16]
                                                        1.206096e+07 [-20.64, -88.89] [-20.44, -87.89] [-20.24, -86.89]
                                                        1.252155e+07 [-20.27, -93.91] [-20.07, -92.91] [-19.87, -91.91]
                                                        1.299974e+07 [-20.41, -99.66] [-20.21, -98.66] [-20.01, -97.66]
                                                        1.349618e+07 [-20.25, -101.52] [-20.05, -100.52] [-19.85, -99.52]
                                                        1.401158e+07 [-20.58, -103.77] [-20.38, -102.77] [-20.18, -101.77]
                                                        1.454667e+07 [-20.50, -106.58] [-20.30, -105.58] [-20.10, -104.58]
                                                        1.510219e+07 [-20.66, -112.51] [-20.46, -111.51] [-20.26, -110.51]
                                                        1.567893e+07 [-20.79, -117.21] [-20.59, -116.21] [-20.39, -115.21]
                                                        1.627769e+07 [-20.57, -117.57] [-20.37, -116.57] [-20.17, -115.57]
                                                        1.689931e+07 [-20.57, -123.76] [-20.37, -122.76] [-20.17, -121.76]
                                                        1.754468e+07 [-20.51, -131.31] [-20.31, -130.31] [-20.11, -129.31]
                                                        1.821469e+07 [-20.52, -132.55] [-20.32, -131.55] [-20.12, -130.55]
                                                        1.891029e+07 [-20.69, -138.86] [-20.49, -137.86] [-20.29, -136.86]
                                                        1.963245e+07 [-20.62, -144.81] [-20.42, -143.81] [-20.22, -142.81]
                                                        2.038219e+07 [-20.47, -151.88] [-20.27, -150.88] [-20.07, -149.88]
                                                        2.116056e+07 [-20.57, -156.06] [-20.37, -155.06] [-20.17, -154.06]
                                                        2.196866e+07 [-20.36, -162.15] [-20.16, -161.15] [-19.96, -160.15]
                                                        2.280762e+07 [-20.88, -169.45] [-20.68, -168.45] [-20.48, -167.45]
                                                        2.367862e+07 [-20.51, -174.04] [-20.31, -173.04] [-20.11, -172.04]
                                                        2.458288e+07 [-20.56, -180.54] [-20.36, -179.54] [-20.16, -178.54]
                                                        2.552167e+07 [-20.71, 171.24] [-20.51, 172.24] [-20.31, 173.24]
                                                        2.649631e+07 [-20.69, 165.77] [-20.49, 166.77] [-20.29, 167.77]
                                                        2.750818e+07 [-20.65, 158.03] [-20.45, 159.03] [-20.25, 160.03]
                                                        2.855868e+07 [-20.54, 149.57] [-20.34, 150.57] [-20.14, 151.57]
                                                        2.964930e+07 [-20.71, 141.67] [-20.51, 142.67] [-20.31, 143.67]
                                                        3.078158e+07 [-20.70, 133.02] [-20.50, 134.02] [-20.30, 135.02]
                                                        3.195709e+07 [-20.72, 126.12] [-20.52, 127.12] [-20.32, 128.12]
                                                        3.317750e+07 [-20.73, 115.88] [-20.53, 116.88] [-20.33, 117.88]
                                                        3.444451e+07 [-20.75, 106.84] [-20.55, 107.84] [-20.35, 108.84]
                                                        3.575990e+07 [-20.71, 97.67] [-20.51, 98.67] [-20.31, 99.67]
                                                        3.712553e+07 [-20.59, 87.30] [-20.39, 88.30] [-20.19, 89.30]
                                                        3.854331e+07 [-20.66, 77.82] [-20.46, 78.82] [-20.26, 79.82]
                                                        4.001524e+07 [-20.67, 67.28] [-20.47, 68.28] [-20.27, 69.28]
                                                        4.154338e+07 [-20.54, 54.91] [-20.34, 55.91] [-20.14, 56.91]
                                                        4.312987e+07 [-20.72, 44.65] [-20.52, 45.65] [-20.32, 46.65]
                                                        4.477695e+07 [-20.78, 31.02] [-20.58, 32.02] [-20.38, 33.02]
                                                        4.648693e+07 [-20.75, 19.19] [-20.55, 20.19] [-20.35, 21.19]
                                                        4.826221e+07 [-20.78, 6.82] [-20.58, 7.82] [-20.38, 8.82]
                                                        5.010529e+07 [-20.79, -6.51] [-20.59, -5.51] [-20.39, -4.51]
                                                        5.201875e+07 [-20.80, -20.89] [-20.60, -19.89] [-20.40, -18.89]
                                                        5.400529e+07 [-20.78, -35.41] [-20.58, -34.41] [-20.38, -33.41]
                                                        5.606769e+07 [-20.71, -51.00] [-20.51, -50.00] [-20.31, -49.00]
                                                        5.820885e+07 [-20.80, -65.62] [-20.60, -64.62] [-20.40, -63.62]
                                                        6.043178e+07 [-20.89, -82.30] [-20.69, -81.30] [-20.49, -80.30]
                                                        6.273960e+07 [-20.78, -99.23] [-20.58, -98.23] [-20.38, -97.23]
                                                        6.513556e+07 [-20.81, -116.15] [-20.61, -115.15] [-20.41, -114.15]
                                                        6.762301e+07 [-20.80, -133.86] [-20.60, -132.86] [-20.40, -131.86]
                                                        7.020545e+07 [-20.77, -153.10] [-20.57, -152.10] [-20.37, -151.10]
                                                        7.288652e+07 [-20.80, -172.45] [-20.60, -171.45] [-20.40, -170.45]
                                                        7.566997e+07 [-20.82, 167.44] [-20.62, 168.44] [-20.42, 169.44]
                                                        7.855972e+07 [-20.85, 146.45] [-20.65, 147.45] [-20.45, 148.45]
                                                        8.155983e+07 [-20.84, 124.20] [-20.64, 125.20] [-20.44, 126.20]
                                                        8.467450e+07 [-20.84, 101.92] [-20.64, 102.92] [-20.44, 103.92]
                                                        8.790813e+07 [-20.87, 78.62] [-20.67, 79.62] [-20.47, 80.62]
                                                        9.126524e+07 [-20.92, 53.85] [-20.72, 54.85] [-20.52, 55.85]
                                                        9.475055e+07 [-20.86, 28.71] [-20.66, 29.71] [-20.46, 30.71]
                                                        9.836897e+07 [-20.90, 1.90] [-20.70, 2.90] [-20.50, 3.90]
                                                        1.021256e+08 [-20.92, -24.97] [-20.72, -23.97] [-20.52, -22.97]
                                                        1.060256e+08 [-20.97, -53.39] [-20.77, -52.39] [-20.57, -51.39]
                                                        1.100746e+08 [-20.94, -82.91] [-20.74, -81.91] [-20.54, -80.91]
                                                        1.142782e+08 [-20.97, -113.17] [-20.77, -112.17] [-20.57, -111.17]
                                                        1.186424e+08 [-20.99, -145.33] [-20.79, -144.33] [-20.59, -143.33]
                                                        1.231732e+08 [-20.99, -177.87] [-20.79, -176.87] [-20.59, -175.87]
                                                        1.278771e+08 [-20.97, 147.69] [-20.77, 148.69] [-20.57, 149.69]
                                                        1.327605e+08 [-20.99, 112.33] [-20.79, 113.33] [-20.59, 114.33]
                                                        1.378305e+08 [-21.05, 75.64] [-20.85, 76.64] [-20.65, 77.64]
                                                        1.430941e+08 [-21.07, 37.27] [-20.87, 38.27] [-20.67, 39.27]
                                                        1.485587e+08 [-21.06, -2.24] [-20.86, -1.24] [-20.66, -0.24]
                                                        1.542320e+08 [-21.07, -43.54] [-20.87, -42.54] [-20.67, -41.54]
                                                        1.601219e+08 [-21.07, -86.24] [-20.87, -85.24] [-20.67, -84.24]
                                                        1.662368e+08 [-21.11, -130.69] [-20.91, -129.69] [-20.71, -128.69]
                                                        1.725852e+08 [-21.08, -176.94] [-20.88, -175.94] [-20.68, -174.94]
                                                        1.791760e+08 [-21.12, 135.24] [-20.92, 136.24] [-20.72, 137.24]
                                                        1.860186e+08 [-21.13, 85.56] [-20.93, 86.56] [-20.73, 87.56]
                                                        1.931224e+08 [-21.18, 34.13] [-20.98, 35.13] [-20.78, 36.13]
                                                        2.004975e+08 [-21.18, -19.47] [-20.98, -18.47] [-20.78, -17.47]
                                                        2.081543e+08 [-21.18, -75.05] [-20.98, -74.05] [-20.78, -73.05]
                                                        2.161035e+08 [-21.21, -132.76] [-21.01, -131.76] [-20.81, -130.76]
                                                        2.243562e+08 [-21.21, 167.34] [-21.01, 168.34] [-20.81, 169.34]
                                                        2.329241e+08 [-21.27, 105.10] [-21.07, 106.10] [-20.87, 107.10]
                                                        2.418192e+08 [-21.27, 40.58] [-21.07, 41.58] [-20.87, 42.58]
                                                        2.510540e+08 [-21.29, -26.39] [-21.09, -25.39] [-20.89, -24.39]
                                                        2.606415e+08 [-21.30, -96.18] [-21.10, -95.18] [-20.90, -94.18]
                                                        2.705951e+08 [-21.32, -168.25] [-21.12, -167.25] [-20.92, -166.25]
                                                        2.809288e+08 [-21.37, 116.68] [-21.17, 117.68] [-20.97, 118.68]
                                                        2.916571e+08 [-21.37, 38.86] [-21.17, 39.86] [-20.97, 40.86]
                                                        3.027952e+08 [-21.37, -42.04] [-21.17, -41.04] [-20.97, -40.04]
                                                        3.143586e+08 [-21.39, -125.98] [-21.19, -124.98] [-20.99, -123.98]
                                                        3.263636e+08 [-21.43, 146.88] [-21.23, 147.88] [-21.03, 148.88]
                                                        3.388271e+08 [-21.43, 56.36] [-21.23, 57.36] [-21.03, 58.36]
                                                        3.517665e+08 [-21.46, -37.48] [-21.26, -36.48] [-21.06, -35.48]
                                                        3.652000e+08 [-21.49, -134.94] [-21.29, -133.94] [-21.09, -132.94]
                                                        3.791466e+08 [-21.51, 123.92] [-21.31, 124.92] [-21.11, 125.92]
                                                        3.936258e+08 [-21.55, 18.82] [-21.35, 19.82] [-21.15, 20.82]
                                                        4.086579e+08 [-21.55, -90.14] [-21.35, -89.14] [-21.15, -88.14]
                                                        4.242641e+08 [-21.58, 156.61] [-21.38, 157.61] [-21.18, 158.61]
                                                        4.404662e+08 [-21.60, 38.91] [-21.40, 39.91] [-21.20, 40.91]
                                                        4.572871e+08 [-21.63, -83.14] [-21.43, -82.14] [-21.23, -81.14]
                                                        4.747504e+08 [-21.67, 150.22] [-21.47, 151.22] [-21.27, 152.22]
                                                        4.928806e+08 [-21.67, 18.72] [-21.47, 19.72] [-21.27, 20.72]
                                                        5.117031e+08 [-21.71, -117.87] [-21.51, -116.87] [-21.31, -115.87]
                                                        5.312445e+08 [-21.74, 100.25] [-21.54, 101.25] [-21.34, 102.25]
                                                        5.515321e+08 [-21.80, -46.86] [-21.60, -45.86] [-21.40, -44.86]
                                                        5.725945e+08 [-21.79, 160.50] [-21.59, 161.50] [-21.39, 162.50]
                                                        5.944612e+08 [-21.83, 1.89] [-21.63, 2.89] [-21.43, 3.89]
                                                        6.171630e+08 [-21.84, -163.03] [-21.64, -162.03] [-21.44, -161.03]
                                                        6.407317e+08 [-21.90, 26.23] [-21.70, 27.23] [-21.50, 28.23]
                                                        6.652006e+08 [-21.91, -151.25] [-21.71, -150.25] [-21.51, -149.25]
                                                        6.906038e+08 [-21.92, 24.38] [-21.72, 25.38] [-21.52, 26.38]
                                                        7.169772e+08 [-21.98, -166.90] [-21.78, -165.90] [-21.58, -164.90]
                                                        7.443577e+08 [-22.02, -5.39] [-21.82, -4.39] [-21.62, -3.39]
                                                        7.727839e+08 [-22.01, 148.31] [-21.81, 149.31] [-21.61, 150.31]
                                                        8.022956e+08 [-22.08, -65.73] [-21.88, -64.73] [-21.68, -63.73]
                                                        8.329344e+08 [-22.12, 72.10] [-21.92, 73.10] [-21.72, 74.10]
                                                        8.647432e+08 [-22.13, -158.79] [-21.93, -157.79] [-21.73, -156.79]
                                                        8.977667e+08 [-22.21, -38.26] [-22.01, -37.26] [-21.81, -36.26]
                                                        9.320514e+08 [-22.19, 73.34] [-21.99, 74.34] [-21.79, 75.34]
                                                        9.676454e+08 [-22.26, 174.85] [-22.06, 175.85] [-21.86, 176.85]
                                                        1.004599e+09 [-22.31, -92.40] [-22.11, -91.40] [-21.91, -90.40]
                                                        1.042963e+09 [-22.30, -11.25] [-22.10, -10.25] [-21.90, -9.25]
                                                        1.082793e+09 [-22.40, 60.44] [-22.20, 61.44] [-22.00, 62.44]
                                                        1.124143e+09 [-22.37, 120.09] [-22.17, 121.09] [-21.97, 122.09]
                                                        1.167073e+09 [-22.49, 169.26] [-22.29, 170.26] [-22.09, 171.26]
                                                        1.211642e+09 [-22.46, -154.40] [-22.26, -153.40] [-22.06, -152.40]
                                                        1.257913e+09 [-22.56, -129.54] [-22.36, -128.54] [-22.16, -127.54]
                                                        1.305952e+09 [-22.62, -118.29] [-22.42, -117.29] [-22.22, -116.29]
                                                        1.355825e+09 [-22.63, -119.12] [-22.43, -118.12] [-22.23, -117.12]
                                                        1.407602e+09 [-22.70, -135.18] [-22.50, -134.18] [-22.30, -133.18]
                                                        1.461357e+09 [-22.69, -164.97] [-22.49, -163.97] [-22.29, -162.97]
                                                        1.517164e+09 [-22.80, 151.16] [-22.60, 152.16] [-22.40, 153.16]
                                                        1.575103e+09 [-22.86, 90.11] [-22.66, 91.11] [-22.46, 92.11]
                                                        1.635254e+09 [-22.81, 14.27] [-22.61, 15.27] [-22.41, 16.27]
                                                        1.697703e+09 [-22.88, -77.96] [-22.68, -76.96] [-22.48, -75.96]
                                                        1.762536e+09 [-23.00, 171.72] [-22.80, 172.72] [-22.60, 173.72]
                                                        1.829845e+09 [-23.05, 43.18] [-22.85, 44.18] [-22.65, 45.18]
                                                        1.899725e+09 [-23.02, -103.85] [-22.82, -102.85] [-22.62, -101.85]
                                                        1.972273e+09 [-23.04, 90.74] [-22.84, 91.74] [-22.64, 92.74]
                                                        2.047592e+09 [-23.10, -95.05] [-22.90, -94.05] [-22.70, -93.05]
                                                        2.125787e+09 [-23.21, 58.24] [-23.01, 59.24] [-22.81, 60.24]
                                                        2.206969e+09 [-23.30, -170.42] [-23.10, -169.42] [-22.90, -168.42]
                                                        2.291250e+09 [-23.38, -61.49] [-23.18, -60.49] [-22.98, -59.49]
                                                        2.378751e+09 [-23.47, 24.21] [-23.27, 25.21] [-23.07, 26.21]
                                                        2.469592e+09 [-23.49, 85.62] [-23.29, 86.62] [-23.09, 87.62]
                                                        2.563903e+09 [-23.47, 123.57] [-23.27, 124.57] [-23.07, 125.57]
                                                        2.661816e+09 [-23.49, 130.81] [-23.29, 131.81] [-23.09, 132.81]
                                                        2.763468e+09 [-23.72, 113.06] [-23.52, 114.06] [-23.32, 115.06]
                                                        2.869001e+09 [-23.96, 68.84] [-23.76, 69.84] [-23.56, 70.84]
                                                        2.978565e+09 [-24.05, -3.22] [-23.85, -2.22] [-23.65, -1.22]
                                                        3.092313e+09 [-23.81, -110.50] [-23.61, -109.50] [-23.41, -108.50]
                                                        3.210405e+09 [-24.26, 114.04] [-24.06, 115.04] [-23.86, 116.04]
                                                        3.333007e+09 [-24.18, -52.02] [-23.98, -51.02] [-23.78, -50.02]
                                                        3.460290e+09 [-24.46, 101.63] [-24.26, 102.63] [-24.06, 103.63]
                                                        3.592435e+09 [-24.22, -132.04] [-24.02, -131.04] [-23.82, -130.04]
                                                        3.729626e+09 [-24.99, -48.04] [-24.79, -47.04] [-24.59, -46.04]
                                                        3.872056e+09 [-24.59, -3.18] [-24.39, -2.18] [-24.19, -1.18]
                                                        4.019925e+09 [-24.34, 8.21] [-24.14, 9.21] [-23.94, 10.21]
                                                        4.173442e+09 [-24.67, -22.73] [-24.47, -21.73] [-24.27, -20.73]
                                                        4.332821e+09 [-24.97, -98.35] [-24.77, -97.35] [-24.57, -96.35]
                                                        4.498286e+09 [-25.19, 141.12] [-24.99, 142.12] [-24.79, 143.12]
                                                        4.670071e+09 [-25.48, -24.53] [-25.28, -23.53] [-25.08, -22.53]
                                                        4.848415e+09 [-25.52, 123.93] [-25.32, 124.93] [-25.12, 125.93]
                                                        5.033571e+09 [-25.49, -137.52] [-25.29, -136.52] [-25.09, -135.52]
                                                        5.225797e+09 [-25.16, -92.04] [-24.96, -91.04] [-24.76, -90.04]
                                                        5.425364e+09 [-25.80, -101.05] [-25.60, -100.05] [-25.40, -99.05]
                                                        5.632553e+09 [-26.00, -157.36] [-25.80, -156.36] [-25.60, -155.36]
                                                        5.847653e+09 [-25.50, 81.11] [-25.30, 82.11] [-25.10, 83.11]
                                                        6.070969e+09 [-25.47, -94.15] [-25.27, -93.15] [-25.07, -92.15]
                                                        6.302812e+09 [-25.99, 23.34] [-25.79, 24.34] [-25.59, 25.34]
                                                        6.543509e+09 [-25.96, 77.06] [-25.76, 78.06] [-25.56, 79.06]
                                                        6.793398e+09 [-25.56, 66.23] [-25.36, 67.23] [-25.16, 68.23]
                                                        7.052830e+09 [-25.87, -16.37] [-25.67, -15.37] [-25.47, -14.37]
                                                        7.322170e+09 [-26.18, -167.00] [-25.98, -166.00] [-25.78, -165.00]
                                                        7.601795e+09 [-26.17, -32.51] [-25.97, -31.51] [-25.77, -30.51]
                                                        7.892099e+09 [-25.90, 23.41] [-25.70, 24.41] [-25.50, 25.41]
                                                        8.193489e+09 [-26.64, -2.00] [-26.44, -1.00] [-26.24, -0.00]
                                                        8.506389e+09 [-26.17, -110.20] [-25.97, -109.20] [-25.77, -108.20]
                                                        8.831239e+09 [-26.08, 57.92] [-25.88, 58.92] [-25.68, 59.92]
                                                        9.168493e+09 [-26.25, 131.44] [-26.05, 132.44] [-25.85, 133.44]
                                                        9.518628e+09 [-26.29, 109.10] [-26.09, 110.10] [-25.89, 111.10]
                                                        9.882133e+09 [-26.57, -6.23] [-26.37, -5.23] [-26.17, -4.23]
                                                        1.025952e+10 [-26.56, 139.78] [-26.36, 140.78] [-26.16, 141.78]
                                                        1.065132e+10 [-26.97, 176.42] [-26.77, 177.42] [-26.57, 178.42]
                                                        1.105808e+10 [-26.62, 107.41] [-26.42, 108.41] [-26.22, 109.41]
                                                        1.148038e+10 [-26.81, -72.60] [-26.61, -71.60] [-26.41, -70.60]
                                                        1.191880e+10 [-27.11, -13.66] [-26.91, -12.66] [-26.71, -11.66]
                                                        1.237396e+10 [-27.27, -72.38] [-27.07, -71.38] [-26.87, -70.38]
                                                        1.284651e+10 [-27.68, 99.43] [-27.48, 100.43] [-27.28, 101.43]
                                                        1.333711e+10 [-27.70, 142.29] [-27.50, 143.29] [-27.30, 144.29]
                                                        1.384643e+10 [-27.62, 50.12] [-27.42, 51.12] [-27.22, 52.12]
                                                        1.437521e+10 [-27.68, 171.08] [-27.48, 172.08] [-27.28, 173.08]
                                                        1.492419e+10 [-27.82, 152.12] [-27.62, 153.12] [-27.42, 154.12]
                                                        1.549412e+10 [-28.25, -30.63] [-28.05, -29.63] [-27.85, -28.63]
                                                        1.608583e+10 [-28.44, -5.79] [-28.24, -4.79] [-28.04, -3.79]
                                                        1.670013e+10 [-29.22, -139.21] [-29.02, -138.21] [-28.82, -137.21]
                                                        1.733789e+10 [-28.41, -87.04] [-28.21, -86.04] [-28.01, -85.04]
                                                        1.800000e+10 [-29.74, 149.24] [-29.54, 150.24] [-29.34, 151.24]
                                                        '''))
                    """)

ini0dBHF = format_block("""
                    [description]
                    DESCRIPTION = 0 dB rx path, HF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = io.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.000000e+07 [-0.15, -58.03] [0.05, -57.03] [0.25, -56.03]
                                                        1.000000e+07 [-0.15, -58.03] [0.05, -57.03] [0.25, -56.03]
                                                        1.038189e+07 [-0.00, -59.13] [0.20, -58.13] [0.40, -57.13]
                                                        1.077836e+07 [-0.26, -62.82] [-0.06, -61.82] [0.14, -60.82]
                                                        1.118997e+07 [-0.28, -62.23] [-0.08, -61.23] [0.12, -60.23]
                                                        1.161731e+07 [-0.57, -64.74] [-0.37, -63.74] [-0.17, -62.74]
                                                        1.206096e+07 [-0.49, -66.42] [-0.29, -65.42] [-0.09, -64.42]
                                                        1.252155e+07 [0.05, -71.03] [0.25, -70.03] [0.45, -69.03]
                                                        1.299974e+07 [-0.17, -76.17] [0.03, -75.17] [0.23, -74.17]
                                                        1.349618e+07 [0.01, -77.41] [0.21, -76.41] [0.41, -75.41]
                                                        1.401158e+07 [-0.32, -78.68] [-0.12, -77.68] [0.08, -76.68]
                                                        1.454667e+07 [-0.19, -80.56] [0.01, -79.56] [0.21, -78.56]
                                                        1.510219e+07 [-0.40, -85.63] [-0.20, -84.63] [0.00, -83.63]
                                                        1.567893e+07 [-0.51, -89.53] [-0.31, -88.53] [-0.11, -87.53]
                                                        1.627769e+07 [-0.35, -88.42] [-0.15, -87.42] [0.05, -86.42]
                                                        1.689931e+07 [-0.25, -93.64] [-0.05, -92.64] [0.15, -91.64]
                                                        1.754468e+07 [-0.31, -99.95] [-0.11, -98.95] [0.09, -97.95]
                                                        1.821469e+07 [-0.25, -99.37] [-0.05, -98.37] [0.15, -97.37]
                                                        1.891029e+07 [-0.45, -104.76] [-0.25, -103.76] [-0.05, -102.76]
                                                        1.963245e+07 [-0.39, -110.10] [-0.19, -109.10] [0.01, -108.10]
                                                        2.038219e+07 [-0.20, -115.08] [0.00, -114.08] [0.20, -113.08]
                                                        2.116056e+07 [-0.26, -118.32] [-0.06, -117.32] [0.14, -116.32]
                                                        2.196866e+07 [-0.14, -122.71] [0.06, -121.71] [0.26, -120.71]
                                                        2.280762e+07 [-0.60, -128.73] [-0.40, -127.73] [-0.20, -126.73]
                                                        2.367862e+07 [-0.23, -132.01] [-0.03, -131.01] [0.17, -130.01]
                                                        2.458288e+07 [-0.29, -136.97] [-0.09, -135.97] [0.11, -134.97]
                                                        2.552167e+07 [-0.41, -143.28] [-0.21, -142.28] [-0.01, -141.28]
                                                        2.649631e+07 [-0.38, -146.82] [-0.18, -145.82] [0.02, -144.82]
                                                        2.750818e+07 [-0.37, -153.20] [-0.17, -152.20] [0.03, -151.20]
                                                        2.855868e+07 [-0.28, -159.73] [-0.08, -158.73] [0.12, -157.73]
                                                        2.964930e+07 [-0.43, -165.61] [-0.23, -164.61] [-0.03, -163.61]
                                                        3.078158e+07 [-0.41, -172.14] [-0.21, -171.14] [-0.01, -170.14]
                                                        3.195709e+07 [-0.43, -177.12] [-0.23, -176.12] [-0.03, -175.12]
                                                        3.317750e+07 [-0.43, 174.97] [-0.23, 175.97] [-0.03, 176.97]
                                                        3.444451e+07 [-0.48, 168.00] [-0.28, 169.00] [-0.08, 170.00]
                                                        3.575990e+07 [-0.43, 161.16] [-0.23, 162.16] [-0.03, 163.16]
                                                        3.712553e+07 [-0.32, 153.12] [-0.12, 154.12] [0.08, 155.12]
                                                        3.854331e+07 [-0.36, 146.37] [-0.16, 147.37] [0.04, 148.37]
                                                        4.001524e+07 [-0.38, 138.50] [-0.18, 139.50] [0.02, 140.50]
                                                        4.154338e+07 [-0.25, 128.81] [-0.05, 129.81] [0.15, 130.81]
                                                        4.312987e+07 [-0.42, 121.03] [-0.22, 122.03] [-0.02, 123.03]
                                                        4.477695e+07 [-0.47, 110.48] [-0.27, 111.48] [-0.07, 112.48]
                                                        4.648693e+07 [-0.44, 101.96] [-0.24, 102.96] [-0.04, 103.96]
                                                        4.826221e+07 [-0.49, 92.51] [-0.29, 93.51] [-0.09, 94.51]
                                                        5.010529e+07 [-0.49, 82.37] [-0.29, 83.37] [-0.09, 84.37]
                                                        5.201875e+07 [-0.49, 71.36] [-0.29, 72.36] [-0.09, 73.36]
                                                        5.400529e+07 [-0.47, 60.44] [-0.27, 61.44] [-0.07, 62.44]
                                                        5.606769e+07 [-0.39, 48.52] [-0.19, 49.52] [0.01, 50.52]
                                                        5.820885e+07 [-0.47, 37.66] [-0.27, 38.66] [-0.07, 39.66]
                                                        6.043178e+07 [-0.57, 24.94] [-0.37, 25.94] [-0.17, 26.94]
                                                        6.273960e+07 [-0.46, 12.02] [-0.26, 13.02] [-0.06, 14.02]
                                                        6.513556e+07 [-0.48, -0.68] [-0.28, 0.32] [-0.08, 1.32]
                                                        6.762301e+07 [-0.47, -14.01] [-0.27, -13.01] [-0.07, -12.01]
                                                        7.020545e+07 [-0.43, -28.66] [-0.23, -27.66] [-0.03, -26.66]
                                                        7.288652e+07 [-0.46, -43.37] [-0.26, -42.37] [-0.06, -41.37]
                                                        7.566997e+07 [-0.49, -58.41] [-0.29, -57.41] [-0.09, -56.41]
                                                        7.855972e+07 [-0.52, -74.43] [-0.32, -73.43] [-0.12, -72.43]
                                                        8.155983e+07 [-0.49, -91.36] [-0.29, -90.36] [-0.09, -89.36]
                                                        8.467450e+07 [-0.49, -108.18] [-0.29, -107.18] [-0.09, -106.18]
                                                        8.790813e+07 [-0.52, -125.71] [-0.32, -124.71] [-0.12, -123.71]
                                                        9.126524e+07 [-0.56, -144.54] [-0.36, -143.54] [-0.16, -142.54]
                                                        9.475055e+07 [-0.50, -163.55] [-0.30, -162.55] [-0.10, -161.55]
                                                        9.836897e+07 [-0.54, 175.98] [-0.34, 176.98] [-0.14, 177.98]
                                                        1.021256e+08 [-0.56, 155.80] [-0.36, 156.80] [-0.16, 157.80]
                                                        1.060256e+08 [-0.60, 134.34] [-0.40, 135.34] [-0.20, 136.34]
                                                        1.100746e+08 [-0.58, 111.80] [-0.38, 112.80] [-0.18, 113.80]
                                                        1.142782e+08 [-0.59, 88.97] [-0.39, 89.97] [-0.19, 90.97]
                                                        1.186424e+08 [-0.61, 64.55] [-0.41, 65.55] [-0.21, 66.55]
                                                        1.231732e+08 [-0.61, 39.99] [-0.41, 40.99] [-0.21, 41.99]
                                                        1.278771e+08 [-0.58, 13.91] [-0.38, 14.91] [-0.18, 15.91]
                                                        1.327605e+08 [-0.61, -12.90] [-0.41, -11.90] [-0.21, -10.90]
                                                        1.378305e+08 [-0.65, -40.65] [-0.45, -39.65] [-0.25, -38.65]
                                                        1.430941e+08 [-0.66, -69.74] [-0.46, -68.74] [-0.26, -67.74]
                                                        1.485587e+08 [-0.66, -99.59] [-0.46, -98.59] [-0.26, -97.59]
                                                        1.542320e+08 [-0.66, -130.94] [-0.46, -129.94] [-0.26, -128.94]
                                                        1.601219e+08 [-0.64, -163.27] [-0.44, -162.27] [-0.24, -161.27]
                                                        1.662368e+08 [-0.68, 163.13] [-0.48, 164.13] [-0.28, 165.13]
                                                        1.725852e+08 [-0.66, 128.08] [-0.46, 129.08] [-0.26, 130.08]
                                                        1.791760e+08 [-0.69, 91.84] [-0.49, 92.84] [-0.29, 93.84]
                                                        1.860186e+08 [-0.70, 54.22] [-0.50, 55.22] [-0.30, 56.22]
                                                        1.931224e+08 [-0.74, 15.28] [-0.54, 16.28] [-0.34, 17.28]
                                                        2.004975e+08 [-0.74, -25.37] [-0.54, -24.37] [-0.34, -23.37]
                                                        2.081543e+08 [-0.73, -67.46] [-0.53, -66.46] [-0.33, -65.46]
                                                        2.161035e+08 [-0.75, -111.17] [-0.55, -110.17] [-0.35, -109.17]
                                                        2.243562e+08 [-0.74, -156.50] [-0.54, -155.50] [-0.34, -154.50]
                                                        2.329241e+08 [-0.80, 156.38] [-0.60, 157.38] [-0.40, 158.38]
                                                        2.418192e+08 [-0.79, 107.48] [-0.59, 108.48] [-0.39, 109.48]
                                                        2.510540e+08 [-0.81, 56.78] [-0.61, 57.78] [-0.41, 58.78]
                                                        2.606415e+08 [-0.82, 3.91] [-0.62, 4.91] [-0.42, 5.91]
                                                        2.705951e+08 [-0.82, -50.62] [-0.62, -49.62] [-0.42, -48.62]
                                                        2.809288e+08 [-0.86, -107.55] [-0.66, -106.55] [-0.46, -105.55]
                                                        2.916571e+08 [-0.86, -166.47] [-0.66, -165.47] [-0.46, -164.47]
                                                        3.027952e+08 [-0.86, 132.23] [-0.66, 133.23] [-0.46, 134.23]
                                                        3.143586e+08 [-0.87, 68.64] [-0.67, 69.64] [-0.47, 70.64]
                                                        3.263636e+08 [-0.91, 2.64] [-0.71, 3.64] [-0.51, 4.64]
                                                        3.388271e+08 [-0.90, -65.90] [-0.70, -64.90] [-0.50, -63.90]
                                                        3.517665e+08 [-0.92, -136.98] [-0.72, -135.98] [-0.52, -134.98]
                                                        3.652000e+08 [-0.94, 149.18] [-0.74, 150.18] [-0.54, 151.18]
                                                        3.791466e+08 [-0.95, 72.62] [-0.75, 73.62] [-0.55, 74.62]
                                                        3.936258e+08 [-0.98, -7.03] [-0.78, -6.03] [-0.58, -5.03]
                                                        4.086579e+08 [-0.99, -89.56] [-0.79, -88.56] [-0.59, -87.56]
                                                        4.242641e+08 [-1.01, -175.33] [-0.81, -174.33] [-0.61, -173.33]
                                                        4.404662e+08 [-1.02, 95.53] [-0.82, 96.53] [-0.62, 97.53]
                                                        4.572871e+08 [-1.04, 3.14] [-0.84, 4.14] [-0.64, 5.14]
                                                        4.747504e+08 [-1.06, -92.83] [-0.86, -91.83] [-0.66, -90.83]
                                                        4.928806e+08 [-1.06, 167.54] [-0.86, 168.54] [-0.66, 169.54]
                                                        5.117031e+08 [-1.09, 64.09] [-0.89, 65.09] [-0.69, 66.09]
                                                        5.312445e+08 [-1.12, -43.28] [-0.92, -42.28] [-0.72, -41.28]
                                                        5.515321e+08 [-1.14, -154.75] [-0.94, -153.75] [-0.74, -152.75]
                                                        5.725945e+08 [-1.14, 89.61] [-0.94, 90.61] [-0.74, 91.61]
                                                        5.944612e+08 [-1.17, -30.58] [-0.97, -29.58] [-0.77, -28.58]
                                                        6.171630e+08 [-1.19, -155.38] [-0.99, -154.38] [-0.79, -153.38]
                                                        6.407317e+08 [-1.21, 75.23] [-1.01, 76.23] [-0.81, 77.23]
                                                        6.652006e+08 [-1.22, -59.25] [-1.02, -58.25] [-0.82, -57.25]
                                                        6.906038e+08 [-1.25, 161.15] [-1.05, 162.15] [-0.85, 163.15]
                                                        7.169772e+08 [-1.27, 16.32] [-1.07, 17.32] [-0.87, 18.32]
                                                        7.443577e+08 [-1.29, -134.11] [-1.09, -133.11] [-0.89, -132.11]
                                                        7.727839e+08 [-1.31, 69.71] [-1.11, 70.71] [-0.91, 71.71]
                                                        8.022956e+08 [-1.33, -92.42] [-1.13, -91.42] [-0.93, -90.42]
                                                        8.329344e+08 [-1.35, 99.15] [-1.15, 100.15] [-0.95, 101.15]
                                                        8.647432e+08 [-1.39, -75.50] [-1.19, -74.50] [-0.99, -73.50]
                                                        8.977667e+08 [-1.40, 103.08] [-1.20, 104.08] [-1.00, 105.08]
                                                        9.320514e+08 [-1.43, -85.22] [-1.23, -84.22] [-1.03, -83.22]
                                                        9.676454e+08 [-1.45, 79.15] [-1.25, 80.15] [-1.05, 81.15]
                                                        1.004599e+09 [-1.49, -123.62] [-1.29, -122.62] [-1.09, -121.62]
                                                        1.042963e+09 [-1.50, 25.48] [-1.30, 26.48] [-1.10, 27.48]
                                                        1.082793e+09 [-1.53, 166.80] [-1.33, 167.80] [-1.13, 168.80]
                                                        1.124143e+09 [-1.57, -60.40] [-1.37, -59.40] [-1.17, -58.40]
                                                        1.167073e+09 [-1.59, 63.86] [-1.39, 64.86] [-1.19, 65.86]
                                                        1.211642e+09 [-1.63, -180.96] [-1.43, -179.96] [-1.23, -178.96]
                                                        1.257913e+09 [-1.64, -75.07] [-1.44, -74.07] [-1.24, -73.07]
                                                        1.305952e+09 [-1.68, 21.03] [-1.48, 22.03] [-1.28, 23.03]
                                                        1.355825e+09 [-1.74, 107.13] [-1.54, 108.13] [-1.34, 109.13]
                                                        1.407602e+09 [-1.72, -177.21] [-1.52, -176.21] [-1.32, -175.21]
                                                        1.461357e+09 [-1.78, -112.51] [-1.58, -111.51] [-1.38, -110.51]
                                                        1.517164e+09 [-1.82, -58.88] [-1.62, -57.88] [-1.42, -56.88]
                                                        1.575103e+09 [-1.83, -17.27] [-1.63, -16.27] [-1.43, -15.27]
                                                        1.635254e+09 [-1.86, 12.34] [-1.66, 13.34] [-1.46, 14.34]
                                                        1.697703e+09 [-1.89, 29.55] [-1.69, 30.55] [-1.49, 31.55]
                                                        1.762536e+09 [-1.92, 33.31] [-1.72, 34.31] [-1.52, 35.31]
                                                        1.829845e+09 [-2.00, 23.85] [-1.80, 24.85] [-1.60, 25.85]
                                                        1.899725e+09 [-1.99, -0.26] [-1.79, 0.74] [-1.59, 1.74]
                                                        1.972273e+09 [-2.06, -38.34] [-1.86, -37.34] [-1.66, -36.34]
                                                        2.047592e+09 [-2.07, -92.21] [-1.87, -91.21] [-1.67, -90.21]
                                                        2.125787e+09 [-2.14, -161.64] [-1.94, -160.64] [-1.74, -159.64]
                                                        2.206969e+09 [-2.14, 112.62] [-1.94, 113.62] [-1.74, 114.62]
                                                        2.291250e+09 [-2.22, 9.73] [-2.02, 10.73] [-1.82, 11.73]
                                                        2.378751e+09 [-2.23, -110.89] [-2.03, -109.89] [-1.83, -108.89]
                                                        2.469592e+09 [-2.30, 110.22] [-2.10, 111.22] [-1.90, 112.22]
                                                        2.563903e+09 [-2.31, -46.11] [-2.11, -45.11] [-1.91, -44.11]
                                                        2.661816e+09 [-2.37, 134.59] [-2.17, 135.59] [-1.97, 136.59]
                                                        2.763468e+09 [-2.44, -63.47] [-2.24, -62.47] [-2.04, -61.47]
                                                        2.869001e+09 [-2.46, 77.20] [-2.26, 78.20] [-2.06, 79.20]
                                                        2.978565e+09 [-2.55, -164.35] [-2.35, -163.35] [-2.15, -162.35]
                                                        3.092313e+09 [-2.65, -69.08] [-2.45, -68.08] [-2.25, -67.08]
                                                        3.210405e+09 [-2.66, 2.36] [-2.46, 3.36] [-2.26, 4.36]
                                                        3.333007e+09 [-2.69, 49.37] [-2.49, 50.37] [-2.29, 51.37]
                                                        3.460290e+09 [-2.75, 70.72] [-2.55, 71.72] [-2.35, 72.72]
                                                        3.592435e+09 [-2.83, 65.55] [-2.63, 66.55] [-2.43, 67.55]
                                                        3.729626e+09 [-2.83, 32.15] [-2.63, 33.15] [-2.43, 34.15]
                                                        3.872056e+09 [-2.90, -30.69] [-2.70, -29.69] [-2.50, -28.69]
                                                        4.019925e+09 [-3.01, -123.08] [-2.81, -122.08] [-2.61, -121.08]
                                                        4.173442e+09 [-3.20, 115.11] [-3.00, 116.11] [-2.80, 117.11]
                                                        4.332821e+09 [-2.99, -40.51] [-2.79, -39.51] [-2.59, -38.51]
                                                        4.498286e+09 [-3.25, 130.62] [-3.05, 131.62] [-2.85, 132.62]
                                                        4.670071e+09 [-3.26, -90.49] [-3.06, -89.49] [-2.86, -88.49]
                                                        4.848415e+09 [-3.35, 9.07] [-3.15, 10.07] [-2.95, 11.07]
                                                        5.033571e+09 [-3.31, 73.69] [-3.11, 74.69] [-2.91, 75.69]
                                                        5.225797e+09 [-3.28, 97.42] [-3.08, 98.42] [-2.88, 99.42]
                                                        5.425364e+09 [-3.62, 79.93] [-3.42, 80.93] [-3.22, 81.93]
                                                        5.632553e+09 [-3.45, 24.43] [-3.25, 25.43] [-3.05, 26.43]
                                                        5.847653e+09 [-3.44, -77.29] [-3.24, -76.29] [-3.04, -75.29]
                                                        6.070969e+09 [-3.60, 137.05] [-3.40, 138.05] [-3.20, 139.05]
                                                        6.302812e+09 [-3.66, -55.83] [-3.46, -54.83] [-3.26, -53.83]
                                                        6.543509e+09 [-3.77, 62.68] [-3.57, 63.68] [-3.37, 64.68]
                                                        6.793398e+09 [-3.72, 130.06] [-3.52, 131.06] [-3.32, 132.06]
                                                        7.052830e+09 [-3.89, 145.74] [-3.69, 146.74] [-3.49, 147.74]
                                                        7.322170e+09 [-3.93, 106.47] [-3.73, 107.47] [-3.53, 108.47]
                                                        7.601795e+09 [-4.02, 11.38] [-3.82, 12.38] [-3.62, 13.38]
                                                        7.892099e+09 [-4.07, -142.54] [-3.87, -141.54] [-3.67, -140.54]
                                                        8.193489e+09 [-4.14, 2.60] [-3.94, 3.60] [-3.74, 4.60]
                                                        8.506389e+09 [-4.20, 84.90] [-4.00, 85.90] [-3.80, 86.90]
                                                        8.831239e+09 [-4.24, 100.29] [-4.04, 101.29] [-3.84, 102.29]
                                                        9.168493e+09 [-4.33, 48.38] [-4.13, 49.38] [-3.93, 50.38]
                                                        9.518628e+09 [-4.58, -74.69] [-4.38, -73.69] [-4.18, -72.69]
                                                        9.882133e+09 [-4.68, 90.09] [-4.48, 91.09] [-4.28, 92.09]
                                                        1.025952e+10 [-4.71, 177.02] [-4.51, 178.02] [-4.31, 179.02]
                                                        1.065132e+10 [-5.01, -174.28] [-4.81, -173.28] [-4.61, -172.28]
                                                        1.105808e+10 [-5.20, 109.86] [-5.00, 110.86] [-4.80, 111.86]
                                                        1.148038e+10 [-5.34, -49.06] [-5.14, -48.06] [-4.94, -47.06]
                                                        1.191880e+10 [-5.54, 64.16] [-5.34, 65.16] [-5.14, 66.16]
                                                        1.237396e+10 [-5.74, 87.61] [-5.54, 88.61] [-5.34, 89.61]
                                                        1.284651e+10 [-6.13, 13.25] [-5.93, 14.25] [-5.73, 15.25]
                                                        1.333711e+10 [-6.32, -161.13] [-6.12, -160.13] [-5.92, -159.13]
                                                        1.384643e+10 [-6.42, -75.56] [-6.22, -74.56] [-6.02, -73.56]
                                                        1.437521e+10 [-6.43, -99.21] [-6.23, -98.21] [-6.03, -97.21]
                                                        1.492419e+10 [-6.50, 126.13] [-6.30, 127.13] [-6.10, 128.13]
                                                        1.549412e+10 [-6.60, -126.54] [-6.40, -125.54] [-6.20, -124.54]
                                                        1.608583e+10 [-6.54, -136.21] [-6.34, -135.21] [-6.14, -134.21]
                                                        1.670013e+10 [-7.05, 88.14] [-6.85, 89.14] [-6.65, 90.14]
                                                        1.733789e+10 [-7.43, -169.65] [-7.23, -168.65] [-7.03, -167.65]
                                                        1.800000e+10 [-6.97, 153.53] [-6.77, 154.53] [-6.57, 155.53]
                                                        '''))
                    """)

ini0dBLF = format_block("""
                    [description]
                    DESCRIPTION = 0 dB rx path, LF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = io.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.000000e+07 [-0.11, -65.75] [0.09, -64.75] [0.29, -63.75]
                                                        1.000000e+07 [-0.11, -65.75] [0.09, -64.75] [0.29, -63.75]
                                                        1.038189e+07 [0.06, -67.29] [0.26, -66.29] [0.46, -65.29]
                                                        1.077836e+07 [-0.24, -71.85] [-0.04, -70.85] [0.16, -69.85]
                                                        1.118997e+07 [-0.25, -71.04] [-0.05, -70.04] [0.15, -69.04]
                                                        1.161731e+07 [-0.59, -73.61] [-0.39, -72.61] [-0.19, -71.61]
                                                        1.206096e+07 [-0.41, -76.29] [-0.21, -75.29] [-0.01, -74.29]
                                                        1.252155e+07 [0.03, -81.24] [0.23, -80.24] [0.43, -79.24]
                                                        1.299974e+07 [-0.13, -86.44] [0.07, -85.44] [0.27, -84.44]
                                                        1.349618e+07 [-0.04, -87.92] [0.16, -86.92] [0.36, -85.92]
                                                        1.401158e+07 [-0.35, -90.14] [-0.15, -89.14] [0.05, -88.14]
                                                        1.454667e+07 [-0.17, -92.06] [0.03, -91.06] [0.23, -90.06]
                                                        1.510219e+07 [-0.39, -97.52] [-0.19, -96.52] [0.01, -95.52]
                                                        1.567893e+07 [-0.48, -101.76] [-0.28, -100.76] [-0.08, -99.76]
                                                        1.627769e+07 [-0.39, -101.00] [-0.19, -100.00] [0.01, -99.00]
                                                        1.689931e+07 [-0.24, -107.20] [-0.04, -106.20] [0.16, -105.20]
                                                        1.754468e+07 [-0.34, -113.83] [-0.14, -112.83] [0.06, -111.83]
                                                        1.821469e+07 [-0.20, -114.33] [0.00, -113.33] [0.20, -112.33]
                                                        1.891029e+07 [-0.43, -120.11] [-0.23, -119.11] [-0.03, -118.11]
                                                        1.963245e+07 [-0.39, -125.37] [-0.19, -124.37] [0.01, -123.37]
                                                        2.038219e+07 [-0.22, -131.15] [-0.02, -130.15] [0.18, -129.15]
                                                        2.116056e+07 [-0.28, -135.01] [-0.08, -134.01] [0.12, -133.01]
                                                        2.196866e+07 [-0.13, -140.12] [0.07, -139.12] [0.27, -138.12]
                                                        2.280762e+07 [-0.62, -146.69] [-0.42, -145.69] [-0.22, -144.69]
                                                        2.367862e+07 [-0.26, -150.41] [-0.06, -149.41] [0.14, -148.41]
                                                        2.458288e+07 [-0.31, -156.12] [-0.11, -155.12] [0.09, -154.12]
                                                        2.552167e+07 [-0.45, -163.37] [-0.25, -162.37] [-0.05, -161.37]
                                                        2.649631e+07 [-0.38, -167.93] [-0.18, -166.93] [0.02, -165.93]
                                                        2.750818e+07 [-0.39, -174.93] [-0.19, -173.93] [0.01, -172.93]
                                                        2.855868e+07 [-0.29, 177.85] [-0.09, 178.85] [0.11, 179.85]
                                                        2.964930e+07 [-0.47, 171.13] [-0.27, 172.13] [-0.07, 173.13]
                                                        3.078158e+07 [-0.44, 163.64] [-0.24, 164.64] [-0.04, 165.64]
                                                        3.195709e+07 [-0.43, 157.88] [-0.23, 158.88] [-0.03, 159.88]
                                                        3.317750e+07 [-0.45, 148.86] [-0.25, 149.86] [-0.05, 150.86]
                                                        3.444451e+07 [-0.50, 140.91] [-0.30, 141.91] [-0.10, 142.91]
                                                        3.575990e+07 [-0.43, 133.15] [-0.23, 134.15] [-0.03, 135.15]
                                                        3.712553e+07 [-0.29, 123.92] [-0.09, 124.92] [0.11, 125.92]
                                                        3.854331e+07 [-0.36, 116.02] [-0.16, 117.02] [0.04, 118.02]
                                                        4.001524e+07 [-0.40, 107.00] [-0.20, 108.00] [0.00, 109.00]
                                                        4.154338e+07 [-0.27, 96.24] [-0.07, 97.24] [0.13, 98.24]
                                                        4.312987e+07 [-0.43, 87.29] [-0.23, 88.29] [-0.03, 89.29]
                                                        4.477695e+07 [-0.48, 75.53] [-0.28, 76.53] [-0.08, 77.53]
                                                        4.648693e+07 [-0.44, 65.48] [-0.24, 66.48] [-0.04, 67.48]
                                                        4.826221e+07 [-0.51, 54.65] [-0.31, 55.65] [-0.11, 56.65]
                                                        5.010529e+07 [-0.51, 43.15] [-0.31, 44.15] [-0.11, 45.15]
                                                        5.201875e+07 [-0.51, 30.66] [-0.31, 31.66] [-0.11, 32.66]
                                                        5.400529e+07 [-0.49, 18.09] [-0.29, 19.09] [-0.09, 20.09]
                                                        5.606769e+07 [-0.42, 4.61] [-0.22, 5.61] [-0.02, 6.61]
                                                        5.820885e+07 [-0.49, -7.91] [-0.29, -6.91] [-0.09, -5.91]
                                                        6.043178e+07 [-0.59, -22.45] [-0.39, -21.45] [-0.19, -20.45]
                                                        6.273960e+07 [-0.48, -37.07] [-0.28, -36.07] [-0.08, -35.07]
                                                        6.513556e+07 [-0.51, -51.68] [-0.31, -50.68] [-0.11, -49.68]
                                                        6.762301e+07 [-0.48, -66.98] [-0.28, -65.98] [-0.08, -64.98]
                                                        7.020545e+07 [-0.48, -83.62] [-0.28, -82.62] [-0.08, -81.62]
                                                        7.288652e+07 [-0.48, -100.28] [-0.28, -99.28] [-0.08, -98.28]
                                                        7.566997e+07 [-0.52, -117.62] [-0.32, -116.62] [-0.12, -115.62]
                                                        7.855972e+07 [-0.53, -135.85] [-0.33, -134.85] [-0.13, -133.85]
                                                        8.155983e+07 [-0.53, -155.10] [-0.33, -154.10] [-0.13, -153.10]
                                                        8.467450e+07 [-0.53, -174.29] [-0.33, -173.29] [-0.13, -172.29]
                                                        8.790813e+07 [-0.55, 165.59] [-0.35, 166.59] [-0.15, 167.59]
                                                        9.126524e+07 [-0.59, 144.16] [-0.39, 145.16] [-0.19, 146.16]
                                                        9.475055e+07 [-0.53, 122.41] [-0.33, 123.41] [-0.13, 124.41]
                                                        9.836897e+07 [-0.57, 99.12] [-0.37, 100.12] [-0.17, 101.12]
                                                        1.021256e+08 [-0.60, 76.00] [-0.40, 77.00] [-0.20, 78.00]
                                                        1.060256e+08 [-0.64, 51.43] [-0.44, 52.43] [-0.24, 53.43]
                                                        1.100746e+08 [-0.61, 25.80] [-0.41, 26.80] [-0.21, 27.80]
                                                        1.142782e+08 [-0.63, -0.32] [-0.43, 0.68] [-0.23, 1.68]
                                                        1.186424e+08 [-0.64, -28.11] [-0.44, -27.11] [-0.24, -26.11]
                                                        1.231732e+08 [-0.63, -56.23] [-0.43, -55.23] [-0.23, -54.23]
                                                        1.278771e+08 [-0.62, -85.99] [-0.42, -84.99] [-0.22, -83.99]
                                                        1.327605e+08 [-0.64, -116.55] [-0.44, -115.55] [-0.24, -114.55]
                                                        1.378305e+08 [-0.69, -148.29] [-0.49, -147.29] [-0.29, -146.29]
                                                        1.430941e+08 [-0.70, 178.53] [-0.50, 179.53] [-0.30, 180.53]
                                                        1.485587e+08 [-0.70, 144.44] [-0.50, 145.44] [-0.30, 146.44]
                                                        1.542320e+08 [-0.70, 108.63] [-0.50, 109.63] [-0.30, 110.63]
                                                        1.601219e+08 [-0.69, 71.76] [-0.49, 72.76] [-0.29, 73.76]
                                                        1.662368e+08 [-0.73, 33.32] [-0.53, 34.32] [-0.33, 35.32]
                                                        1.725852e+08 [-0.71, -6.61] [-0.51, -5.61] [-0.31, -4.61]
                                                        1.791760e+08 [-0.73, -47.96] [-0.53, -46.96] [-0.33, -45.96]
                                                        1.860186e+08 [-0.75, -90.94] [-0.55, -89.94] [-0.35, -88.94]
                                                        1.931224e+08 [-0.79, -135.41] [-0.59, -134.41] [-0.39, -133.41]
                                                        2.004975e+08 [-0.78, 178.14] [-0.58, 179.14] [-0.38, 180.14]
                                                        2.081543e+08 [-0.78, 130.10] [-0.58, 131.10] [-0.38, 132.10]
                                                        2.161035e+08 [-0.81, 80.23] [-0.61, 81.23] [-0.41, 82.23]
                                                        2.243562e+08 [-0.80, 28.43] [-0.60, 29.43] [-0.40, 30.43]
                                                        2.329241e+08 [-0.86, -25.33] [-0.66, -24.33] [-0.46, -23.33]
                                                        2.418192e+08 [-0.85, -81.20] [-0.65, -80.20] [-0.45, -79.20]
                                                        2.510540e+08 [-0.87, -139.05] [-0.67, -138.05] [-0.47, -137.05]
                                                        2.606415e+08 [-0.88, 160.60] [-0.68, 161.60] [-0.48, 162.60]
                                                        2.705951e+08 [-0.88, 98.31] [-0.68, 99.31] [-0.48, 100.31]
                                                        2.809288e+08 [-0.93, 33.36] [-0.73, 34.36] [-0.53, 35.36]
                                                        2.916571e+08 [-0.93, -33.95] [-0.73, -32.95] [-0.53, -31.95]
                                                        3.027952e+08 [-0.93, -103.90] [-0.73, -102.90] [-0.53, -101.90]
                                                        3.143586e+08 [-0.94, -176.48] [-0.74, -175.48] [-0.54, -174.48]
                                                        3.263636e+08 [-0.97, 108.13] [-0.77, 109.13] [-0.57, 110.13]
                                                        3.388271e+08 [-0.97, 29.92] [-0.77, 30.92] [-0.57, 31.92]
                                                        3.517665e+08 [-0.99, -51.21] [-0.79, -50.21] [-0.59, -49.21]
                                                        3.652000e+08 [-1.02, -135.55] [-0.82, -134.55] [-0.62, -133.55]
                                                        3.791466e+08 [-1.02, 137.03] [-0.82, 138.03] [-0.62, 139.03]
                                                        3.936258e+08 [-1.05, 46.08] [-0.85, 47.08] [-0.65, 48.08]
                                                        4.086579e+08 [-1.06, -48.20] [-0.86, -47.20] [-0.66, -46.20]
                                                        4.242641e+08 [-1.09, -146.10] [-0.89, -145.10] [-0.69, -144.10]
                                                        4.404662e+08 [-1.09, 112.17] [-0.89, 113.17] [-0.69, 114.17]
                                                        4.572871e+08 [-1.12, 6.67] [-0.92, 7.67] [-0.72, 8.67]
                                                        4.747504e+08 [-1.14, -102.84] [-0.94, -101.84] [-0.74, -100.84]
                                                        4.928806e+08 [-1.15, 143.39] [-0.95, 144.39] [-0.75, 145.39]
                                                        5.117031e+08 [-1.17, 25.29] [-0.97, 26.29] [-0.77, 27.29]
                                                        5.312445e+08 [-1.19, -97.32] [-0.99, -96.32] [-0.79, -95.32]
                                                        5.515321e+08 [-1.21, 135.33] [-1.01, 136.33] [-0.81, 137.33]
                                                        5.725945e+08 [-1.23, 3.29] [-1.03, 4.29] [-0.83, 5.29]
                                                        5.944612e+08 [-1.26, -133.90] [-1.06, -132.90] [-0.86, -131.90]
                                                        6.171630e+08 [-1.27, 83.66] [-1.07, 84.66] [-0.87, 85.66]
                                                        6.407317e+08 [-1.29, -64.16] [-1.09, -63.16] [-0.89, -62.16]
                                                        6.652006e+08 [-1.32, 142.33] [-1.12, 143.33] [-0.92, 144.33]
                                                        6.906038e+08 [-1.34, -17.05] [-1.14, -16.05] [-0.94, -15.05]
                                                        7.169772e+08 [-1.36, 177.54] [-1.16, 178.54] [-0.96, 179.54]
                                                        7.443577e+08 [-1.39, 5.85] [-1.19, 6.85] [-0.99, 7.85]
                                                        7.727839e+08 [-1.41, -172.47] [-1.21, -171.47] [-1.01, -170.47]
                                                        8.022956e+08 [-1.43, 2.35] [-1.23, 3.35] [-1.03, 4.35]
                                                        8.329344e+08 [-1.46, 170.14] [-1.26, 171.14] [-1.06, 172.14]
                                                        8.647432e+08 [-1.48, -29.35] [-1.28, -28.35] [-1.08, -27.35]
                                                        8.977667e+08 [-1.50, 123.55] [-1.30, 124.55] [-1.10, 125.55]
                                                        9.320514e+08 [-1.53, -91.48] [-1.33, -90.48] [-1.13, -89.48]
                                                        9.676454e+08 [-1.56, 45.26] [-1.36, 46.26] [-1.16, 47.26]
                                                        1.004599e+09 [-1.58, 173.54] [-1.38, 174.54] [-1.18, 175.54]
                                                        1.042963e+09 [-1.61, -67.13] [-1.41, -66.13] [-1.21, -65.13]
                                                        1.082793e+09 [-1.64, 43.09] [-1.44, 44.09] [-1.24, 45.09]
                                                        1.124143e+09 [-1.67, 143.77] [-1.47, 144.77] [-1.27, 145.77]
                                                        1.167073e+09 [-1.70, -125.45] [-1.50, -124.45] [-1.30, -123.45]
                                                        1.211642e+09 [-1.73, -44.93] [-1.53, -43.93] [-1.33, -42.93]
                                                        1.257913e+09 [-1.76, 24.91] [-1.56, 25.91] [-1.36, 26.91]
                                                        1.305952e+09 [-1.79, 83.58] [-1.59, 84.58] [-1.39, 85.58]
                                                        1.355825e+09 [-1.84, 130.83] [-1.64, 131.83] [-1.44, 132.83]
                                                        1.407602e+09 [-1.85, 166.19] [-1.65, 167.19] [-1.45, 168.19]
                                                        1.461357e+09 [-1.89, -171.02] [-1.69, -170.02] [-1.49, -169.02]
                                                        1.517164e+09 [-1.92, -160.92] [-1.72, -159.92] [-1.52, -158.92]
                                                        1.575103e+09 [-1.95, -164.24] [-1.75, -163.24] [-1.55, -162.24]
                                                        1.635254e+09 [-1.99, 178.56] [-1.79, 179.56] [-1.59, 180.56]
                                                        1.697703e+09 [-2.03, 146.96] [-1.83, 147.96] [-1.63, 148.96]
                                                        1.762536e+09 [-2.06, 100.26] [-1.86, 101.26] [-1.66, 102.26]
                                                        1.829845e+09 [-2.11, 38.25] [-1.91, 39.25] [-1.71, 40.25]
                                                        1.899725e+09 [-2.13, -40.21] [-1.93, -39.21] [-1.73, -38.21]
                                                        1.972273e+09 [-2.17, -134.86] [-1.97, -133.86] [-1.77, -132.86]
                                                        2.047592e+09 [-2.21, 112.71] [-2.01, 113.71] [-1.81, 114.71]
                                                        2.125787e+09 [-2.26, -17.54] [-2.06, -16.54] [-1.86, -15.54]
                                                        2.206969e+09 [-2.29, -166.64] [-2.09, -165.64] [-1.89, -164.64]
                                                        2.291250e+09 [-2.34, 24.93] [-2.14, 25.93] [-1.94, 26.93]
                                                        2.378751e+09 [-2.39, -163.82] [-2.19, -162.82] [-1.99, -161.82]
                                                        2.469592e+09 [-2.43, -13.40] [-2.23, -12.40] [-2.03, -11.40]
                                                        2.563903e+09 [-2.45, 116.85] [-2.25, 117.85] [-2.05, 118.85]
                                                        2.661816e+09 [-2.51, -138.99] [-2.31, -137.99] [-2.11, -136.99]
                                                        2.763468e+09 [-2.56, -56.01] [-2.36, -55.01] [-2.16, -54.01]
                                                        2.869001e+09 [-2.61, 2.48] [-2.41, 3.48] [-2.21, 4.48]
                                                        2.978565e+09 [-2.67, 35.43] [-2.47, 36.43] [-2.27, 37.43]
                                                        3.092313e+09 [-2.75, 42.30] [-2.55, 43.30] [-2.35, 44.30]
                                                        3.210405e+09 [-2.80, 21.89] [-2.60, 22.89] [-2.40, 23.89]
                                                        3.333007e+09 [-2.83, -26.75] [-2.63, -25.75] [-2.43, -24.75]
                                                        3.460290e+09 [-2.87, -104.89] [-2.67, -103.89] [-2.47, -102.89]
                                                        3.592435e+09 [-2.92, 146.88] [-2.72, 147.88] [-2.52, 148.88]
                                                        3.729626e+09 [-2.95, 6.77] [-2.75, 7.77] [-2.55, 8.77]
                                                        3.872056e+09 [-3.04, -166.50] [-2.84, -165.50] [-2.64, -164.50]
                                                        4.019925e+09 [-3.15, -13.93] [-2.95, -12.93] [-2.75, -11.93]
                                                        4.173442e+09 [-3.29, 104.57] [-3.09, 105.57] [-2.89, 106.57]
                                                        4.332821e+09 [-3.20, -175.24] [-3.00, -174.24] [-2.80, -173.24]
                                                        4.498286e+09 [-3.41, -132.64] [-3.21, -131.64] [-3.01, -130.64]
                                                        4.670071e+09 [-3.41, -128.36] [-3.21, -127.36] [-3.01, -126.36]
                                                        4.848415e+09 [-3.42, -167.45] [-3.22, -166.45] [-3.02, -165.45]
                                                        5.033571e+09 [-3.61, 111.61] [-3.41, 112.61] [-3.21, 113.61]
                                                        5.225797e+09 [-3.51, -13.06] [-3.31, -12.06] [-3.11, -11.06]
                                                        5.425364e+09 [-3.89, 175.84] [-3.69, 176.84] [-3.49, 177.84]
                                                        5.632553e+09 [-3.64, -43.35] [-3.44, -42.35] [-3.24, -41.35]
                                                        5.847653e+09 [-3.72, 47.57] [-3.52, 48.57] [-3.32, 49.57]
                                                        6.070969e+09 [-3.77, 88.39] [-3.57, 89.39] [-3.37, 90.39]
                                                        6.302812e+09 [-3.84, 74.42] [-3.64, 75.42] [-3.44, 76.42]
                                                        6.543509e+09 [-3.92, 5.82] [-3.72, 6.82] [-3.52, 7.82]
                                                        6.793398e+09 [-4.03, -121.40] [-3.83, -120.40] [-3.63, -119.40]
                                                        7.052830e+09 [-4.10, 52.46] [-3.90, 53.46] [-3.70, 54.46]
                                                        7.322170e+09 [-4.21, 163.90] [-4.01, 164.90] [-3.81, 165.90]
                                                        7.601795e+09 [-4.24, -149.07] [-4.04, -148.07] [-3.84, -147.07]
                                                        7.892099e+09 [-4.35, -169.24] [-4.15, -168.24] [-3.95, -167.24]
                                                        8.193489e+09 [-4.44, 101.36] [-4.24, 102.36] [-4.04, 103.36]
                                                        8.506389e+09 [-4.47, -60.79] [-4.27, -59.79] [-4.07, -58.79]
                                                        8.831239e+09 [-4.59, 62.66] [-4.39, 63.66] [-4.19, 64.66]
                                                        9.168493e+09 [-4.66, 107.80] [-4.46, 108.80] [-4.26, 109.80]
                                                        9.518628e+09 [-4.87, 73.43] [-4.67, 74.43] [-4.47, 75.43]
                                                        9.882133e+09 [-4.87, -45.30] [-4.67, -44.30] [-4.47, -43.30]
                                                        1.025952e+10 [-5.03, 107.52] [-4.83, 108.52] [-4.63, 109.52]
                                                        1.065132e+10 [-5.16, 171.49] [-4.96, 172.49] [-4.76, 173.49]
                                                        1.105808e+10 [-5.45, 140.70] [-5.25, 141.70] [-5.05, 142.70]
                                                        1.148038e+10 [-5.70, 12.90] [-5.50, 13.90] [-5.30, 14.90]
                                                        1.191880e+10 [-5.77, 144.50] [-5.57, 145.50] [-5.37, 146.50]
                                                        1.237396e+10 [-6.39, 170.40] [-6.19, 171.40] [-5.99, 172.40]
                                                        1.284651e+10 [-6.27, 88.48] [-6.07, 89.48] [-5.87, 90.48]
                                                        1.333711e+10 [-6.33, -105.76] [-6.13, -104.76] [-5.93, -103.76]
                                                        1.384643e+10 [-6.02, -58.64] [-5.82, -57.64] [-5.62, -56.64]
                                                        1.437521e+10 [-6.06, -135.98] [-5.86, -134.98] [-5.66, -133.98]
                                                        1.492419e+10 [-6.27, 21.99] [-6.07, 22.99] [-5.87, 23.99]
                                                        1.549412e+10 [-6.64, 47.94] [-6.44, 48.94] [-6.24, 49.94]
                                                        1.608583e+10 [-6.78, -64.11] [-6.58, -63.11] [-6.38, -62.11]
                                                        1.670013e+10 [-7.06, 45.04] [-6.86, 46.04] [-6.66, 47.04]
                                                        1.733789e+10 [-7.04, 8.07] [-6.84, 9.07] [-6.64, 10.07]
                                                        1.800000e+10 [-6.98, 172.65] [-6.78, 173.65] [-6.58, 174.65]
                                                        '''))
                    """)


class POWERMETER(PWRMTR):
    conftmpl = PWRMTR.conftmpl
    conftmpl['description']['pmini'] = str

    _FP = r'[-+]?(\d+(\.\d*)?|\d*\.\d+)([eE][-+]?\d+)?'

    def __init__(self, **kw):
        super().__init__()
        self.ini20dBLF = io.StringIO(ini20dBLF)
        self.ini20dBHF = io.StringIO(ini20dBHF)
        self.ini0dBHF = io.StringIO(ini0dBHF)
        self.ini0dBLF = io.StringIO(ini0dBLF)

        self.SearchPaths = kw.get('SearchPaths', ['.'])
        if self.SearchPaths is None:
            self.SearchPaths = ['.']
        self.pm_instance = None
        self.freq = None
        self.power = None
        self.unit = None
        self._internal_unit = 'dBm'
        self.np20L = NPORT()
        self.np20L.Init(self.ini20dBLF)
        self.np20H = NPORT()
        self.np20H.Init(self.ini20dBHF)
        self.np0L = NPORT()
        self.np0L.Init(self.ini0dBLF)
        self.np0H = NPORT()
        self.np0H.Init(self.ini0dBHF)
        self.swfreq = 1e9
        self.att20 = None
        self.att0 = None
        self.np20 = None
        self.np0 = None
        self.pfac = None
        self.plimit = quantities.Quantity(si.WATT, 1.0)  # 1 Watt max power for the sensor

    def Init(self, ininame, channel=1):
        self.conf = Configuration(ininame, self.conftmpl).conf
        pmini = self.conf['description']['pmini']
        pmini = next(locate(pmini, paths=self.SearchPaths))
        self.pm_instance = getattr(device, 'Powermeter')(SearchPaths=self.SearchPaths)
        stat = self.pm_instance.Init(pmini, channel)
        methods = ('Quit',
                   'SetVirtual',
                   'GetVirtual',
                   'Trigger',
                   'Zero')
        for m in methods:
            setattr(self, m, getattr(self.pm_instance, m))

        # sw=imp.load_source('sw', 'c:\\MpyConfig\\LargeRC\\script\\sw_rc_rx.py')
        sw = importlib.machinery.SourceFileLoader('sw', '/opt/share/MpyConfig/LargeRC/script/sw_rc_rx.py').load_module()
        self.sw_instance = sw.SWController()
        swini = format_block("""
                        [DESCRIPTION]
                        DESCRIPTION = RC RX Switch
                        TYPE = Custom
                        VENDOR = 
                        SERIALNR = 
                        DEVICEID = 
                        DRIVER = sw_rc_rx
                        CLASS = SWController

                        [INIT_VALUE]
                        FSTART = 0
                        FSTOP = 18e9
                        FSTEP = 0.0
                        GPIB = 2
                        OUTPUT = POWERMETER
                        SWFREQ = %f
                        VIRTUAL = 0
                        """ % (self.swfreq))
        swini = io.StringIO(swini)
        self.sw_instance.Init(swini)
        self.sw_instance.SetAtt(True)
        return stat

    def _check(self, obj):
        att = self.att20
        if (obj * self.pfac).get_expectation_value() <= self.plimit:  # save to remove the att
            self.sw_instance.SetAtt(False)
            att = self.att0
            self.error, obj = self.pm_instance.GetData()
        r = abs(obj / att)
        r = r.reduce_to(obj._unit)
        return r

    def GetData(self):
        self.sw_instance.SetAtt(True)
        self.error, obj = self.pm_instance.GetData()
        obj = self._check(obj)
        self.sw_instance.SetAtt(True)
        return self.error, obj

    def GetDataNB(self, retrigger):
        self.sw_instance.SetAtt(True)
        self.error, obj = self.pm_instance.GetDataNB(retrigger)
        if obj:
            obj = self._check(obj)
        self.sw_instance.SetAtt(True)
        return self.error, obj

    def SetFreq(self, freq):
        self.error, rfreq = self.pm_instance.SetFreq(freq)
        # print rfreq
        # assert rfreq==freq
        self.error, rfreq = self.sw_instance.SetFreq(freq)
        # print rfreq
        # assert rfreq==freq
        self.freq = freq
        if freq <= self.swfreq:
            ext = 'L'
        else:
            ext = 'H'
        for s in (0, 20):
            setattr(self, 'np%d' % s, getattr(self, 'np%d%s' % (s, ext)))
        self.np20.SetFreq(freq)
        self.np0.SetFreq(freq)
        err, self.att20 = self.np20.GetData(what='S21')
        err, self.att0 = self.np0.GetData(what='S21')
        self.pfac = abs(self.att0 / self.att20).get_expectation_value_as_float()
        # print freq, abs(self.att0), abs(self.att20), self.pfac
        return self.error, freq

    def GetDescription(self):
        self.error, pm_des = self.pm_instance.GetDescription()
        return self.error, str(self.conf['description']) + pm_des

    def Quit(self):
        # self.np20.Quit()
        # self.np0.Quit()
        self.np0L.Quit()
        self.np0H.Quit()
        self.np20L.Quit()
        self.np20H.Quit()

        self.pm_instance.Quit()
        self.sw_instance.Quit()
        return 0


def test_init(ch):
    import io
    from mpylab.tools.util import format_block
    inst = POWERMETER()
    ini = format_block("""
                    [DESCRIPTION]
                    description: add 20 dB to power meter
                    type:        POWERMETER
                    vendor:      TUDD
                    pmini: pmini.ini
                    driver: pm_rxatt.py

                    [Init_Value]
                    fstart: 100e3
                    fstop: 18e9
                    fstep: 1
                    virtual: 0
                    nr_of_channels: 1
                    
                    [Channel_1]
                    name: A
                    unit: dBm
                    """)
    ini = io.StringIO(ini)

    ini_pm = format_block("""
                    [DESCRIPTION]
                    description: 'GigaTronics 8542C Universal Power Meter'
                    type:        'POWERMETER'
                    vendor:      'GigaTronics'
                    serialnr:
                    deviceid:
                    driver: 'pm_gt_8540c.py'

                    [Init_Value]
                    fstart: 100e3
                    fstop: 18e9
                    fstep: 1
                    gpib: 13
                    virtual: 0
                    nr_of_channels: 2

                    [Channel_1]
                    name: A
                    unit: dBm
                    filter: -1
                    #resolution: 
                    rangemode: auto
                    #manrange: 
                    swr: 1.1
                    trg_threshold: 0.5

                    [Channel_2]
                    name: B
                    unit: 'W'
                    trg_threshold: 0.5
                    """)
    ini_pm = io.StringIO(ini_pm)
    inst.Init(ini, ch)
    return inst


def main():
    import io
    import sys
    from mpylab.tools.util import format_block
    from mpylab.device.powermeter_ui import UI as UI

    try:
        ini = sys.argv[1]
    except IndexError:
        ini = format_block("""
                        [DESCRIPTION]
                        description: 'GigaTronics 8542C Universal Power Meter'
                        type:        'POWERMETER'
                        vendor:      'GigaTronics'
                        serialnr:
                        deviceid:
                        driver:

                        [Init_Value]
                        fstart: 100e3
                        fstop: 18e9
                        fstep: 1
                        gpib: 13
                        virtual: 0
                        nr_of_channels: 2

                        [Channel_1]
                        name: A
                        unit: dBm
                        filter: -1
                        #resolution: 
                        rangemode: auto
                        #manrange: 
                        swr: 1.1
                        trg_threshold: 0.5

                        [Channel_2]
                        name: B
                        unit: 'W'
                        trg_threshold: 0.5
                        """)
        ini = io.StringIO(ini)

    pm = POWERMETER()
    ui = UI(pm, ini=ini)
    ui.configure_traits()


if __name__ == '__main__':
    #    main()
    pm1 = test_init(1)
    pm1.SetFreq(200e6)
    while True:
        pm1.Trigger()
        print((pm1.GetData()))
        time.sleep(1)
    pm1.Quit()
