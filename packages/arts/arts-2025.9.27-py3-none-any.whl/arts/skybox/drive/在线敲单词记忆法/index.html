<!DOCTYPE html>
<html class='ch_48 ch_49 ch_50 ch_51'><head>
<title>FreeWord</title><link rel='icon' href='icon.png' type='image/x-icon'>
<style>
            @keyframes tip_click1 {
                0% {background-color: rgb(102, 205, 170);}
                100% {background-color: rgb(102, 205, 170);}
            }
            @keyframes tip_click2 {
                0% {background-color: rgb(102, 205, 170);}
                100% {background-color: rgb(102, 205, 170);}
            }
            button[tip_click="1"] {animation: tip_click1 0.3s;}
            button[tip_click="2"] {animation: tip_click2 0.3s;}
            
</style><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1.0'><base target='_blank'>
<style>
    * {vertical-align:middle; text-decoration:none; position:relative; padding:0; overflow:auto; outline:none; margin:0; font-size:1rem; font-family:'Chinese Quote', 'Segoe UI', Roboto, RobotoNum, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif; box-sizing:border-box; border-width:0; border-style:solid;}
    .ch_54 {font-weight:bold; font-size:2rem;}
    .ch_49 {width:100%; padding:0.618rem; height:100vh; display:block; background-color:rgb(210, 210, 210);}
    .w10000[show_state="question"] .ch_55 {color:transparent;}
    .w10000[judgment="wrong"] .ch_56, .w10000[judgment="done_wrong"] .ch_56 {color:red;}
    .ch_52 {width:100%; height:100%; display:block; border-radius:1rem; background-size:cover; background-color:white;}
    .w10000[judgment="done_right"] .ch_58 {color:green;}
    .ch_72 {display:inline-block;}
    .ch_53 {display:inline-grid;}
    .ch_65 {width:100%; height:100%; grid-template-rows:auto 1fr; gap:1.5rem; display:inline-grid;}
    .ch_73 {padding:0.618em 1em 0.618em 1em; margin:0 0.25rem 0 0.25rem; font-size:0.8rem; border-radius:0.5em; background-color:rgb(239, 239, 239);}
    .ch_74:hover {background-color:rgb(249, 249, 249);}
    .ch_75:active {background-color:transparent;}
    .ch_62 {padding:0.1em 0.3em; font-size:0.8rem; color:gray; background-color:transparent;}
    .ch_77 {padding:0; font-size:1.0rem; color:black; background-color:transparent;}
    .ch_61 {vertical-align:baseline; display:inline-block;}
    .ch_68 {white-space:pre-wrap; vertical-align:baseline; scrollbar-width:none; padding:0; overflow-wrap:break-word; overflow:hidden; max-width:100%; line-height:1.1; justify-self:center; border-radius:0; -ms-overflow-style:none;}
    .ch_69 {width:min(50rem, 100%); white-space:pre-wrap; visibility:hidden; vertical-align:baseline; padding:1rem 1.2rem; overflow-wrap:break-word; line-height:1.75; justify-self:center; font-size:0.9rem; border-radius:0.75em; border:rgb(255, 174, 0) 0.1rem solid;}
    .ch_66 > * {vertical-align:baseline;}
    .ch_59 {width:min(50rem, 100%); text-align:center; padding:0.1em; font-weight:bold; font-size:2rem; display:inline-block; border-width:0 0 0.1rem 0; border-color:rgb(159, 159, 159); background-color:transparent;}
    .ch_60:hover {border-color:rgb(200, 200, 200);}
    .ch_57:focus {border-color:rgb(118, 118, 118);}
    * {scrollbar-width:none; -ms-overflow-style:none  /* 对 IE 和 Edge 隐藏滚动条 */;}
    *::-webkit-scrollbar {display:none;}
    .ch_63:hover {color:rgb(233, 156, 79);}
    .ch_64:active {color:rgb(233, 156, 79);}
    .ch_78:hover {color:rgb(233, 156, 79);}
    .ch_76:active {color:rgb(233, 156, 79);}
    .ch_70::before {font-weight:700; content:"AI释义：";}
    .w10000[show_state="answer"] .ch_71 {visibility:visible;}
    .ch_67::-webkit-scrollbar {display:none;}
</style></head>
<body class='ch_52 w10000' id=ch_19>
<script>
"use strict";
window.print = console.log
                    if (1 + 1 === 2) {
                        window.ch = new Proxy(
                            new Map(),
                            {get: (target, name) => target.get(name), set: (target, name, value) => target.set(name, value), has: (target, key) => target.has(key)}
                        )
                    }
                    else {   window.ch = {}   }
                    window.screen_type = window.innerWidth > window.innerHeight ? 'x' : 'y'
                    document.documentElement.setAttribute('screen_type', window.screen_type)
                    document.documentElement.setAttribute('is_x_screen', String(window.innerWidth > window.innerHeight))
</script><div class='ch_53' style="padding:1.5rem 0.618rem 0.618rem 0.618rem; align-content:flex-start; justify-items:center; row-gap:1.5rem; height:100%; width:100%; grid-template-rows:auto auto auto 1fr auto;"><h1 class='ch_54 ch_55' id=ch_31></h1><input class='ch_56 ch_57 ch_58 ch_59 ch_60' autocomplete='off' id=ch_29><span class='ch_61'><button class='ch_62 ch_63 ch_64' id=ch_23><audio type='audio/mpeg' id=ch_11></audio></button><button class='ch_62 ch_63 ch_64' id=ch_25><audio type='audio/mpeg' id=ch_13></audio></button></span><div class='ch_65'><pre class='ch_66 ch_67 ch_68' id=ch_27></pre><pre class='ch_69 ch_70 ch_66 ch_71' id=ch_21></pre></div><div class='ch_53' style="width:100%; justify-content:center; grid-template-columns:1fr auto 1fr; column-gap:0.5rem;"><div class='ch_72' style="width:100%; text-align:left;"></div><div class='ch_72' style="width:100%; text-align:center;"><button class='ch_73 ch_74 ch_75' style="visibility:hidden; width:1rem; padding:0;"></button><button class='ch_73 ch_74 ch_75' value='tobottom' id=ch_41>置底(2)</button><button class='ch_73 ch_74 ch_75' style="visibility:hidden; width:1rem; padding:0;"></button><button class='ch_73 ch_74 ch_75' value='master' id=ch_43>已掌握(4)</button><button class='ch_73 ch_74 ch_75' value='forget' id=ch_37>不记得(5)</button><button class='ch_73 ch_74 ch_75' value='remember' id=ch_35>记得(6)</button><button class='ch_73 ch_74 ch_75' style="visibility:hidden; width:1rem; padding:0;"></button><button class='ch_73 ch_74 ch_75' id=ch_39>显示答案(8)</button></div><div class='ch_53' style="width:100%; align-items:center; justify-content:end; grid-template-columns:auto auto auto;"><button class='ch_76 ch_77 ch_78' play_type='美' title='自动发音' id=ch_33>🔊[美]</button><button class='ch_73 ch_74 ch_75' style="visibility:hidden; width:1rem; padding:0;"></button></div></div></div>
<script>
"use strict";

document.documentElement.setAttribute('is_coarse_pointer', String(window.matchMedia("(pointer: coarse)").matches))
ch.ch_24 = document.getElementById("ch_23")
ch.ch_26 = document.getElementById("ch_25")
ch.ch_28 = document.getElementById("ch_27")
ch.ch_32 = document.getElementById("ch_31")
ch.ch_20 = document.getElementById("ch_19")
ch.ch_30 = document.getElementById("ch_29")
ch.ch_12 = document.getElementById("ch_11")
ch.ch_10 = new Map([])
ch.ch_15 = () => {
            let word = ch.ch_10.get('current_word')
            ch.ch_12.src = `https://word.freeing.wiki/groups/${word[0]}/${word}/AmE.mp3`
            ch.ch_12.load()
            ch.ch_12.play()
        }
ch.ch_14 = document.getElementById("ch_13")
ch.ch_16 = () => {
            let word = ch.ch_10.get('current_word')
            ch.ch_14.src = `https://word.freeing.wiki/groups/${word[0]}/${word}/BrE.mp3`
            ch.ch_14.load()
            ch.ch_14.play()
        }
ch.ch_17 = new Map([])
ch.ch_18 = async (word) => {
            // await 并不会中断 “整个主程序”，只会中断当前 async 函数的执行流程；而不加 await 时，未处理的错误确实只会在控制台警告，不影响任何执行流程。
            let encoded_prompt = encodeURIComponent(`单词\`${word}\`是什么意思？`)
            let api_url = `https://text.pollinations.ai/openai/${encoded_prompt}`
            let answer = await (await fetch(api_url)).text()
            ch.ch_17.set(word, answer) 
        }
ch.ch_22 = document.getElementById("ch_21")
ch.ch_47 = async (is_feedback=false) => {
            let previous_state = null
            if (is_feedback) {
                let target = event.target
                if (target.getAttribute('tip_click') === '1') {
                    target.setAttribute('tip_click', '2')
                }
                else {
                    target.setAttribute('tip_click', '1')
                }
                previous_state = target.value
            }
            let word = (await window.english.feedback_and_fetch(previous_state=previous_state)).word
            ch.ch_18(word)
            let url = `https://word.freeing.wiki/groups/${word[0]}/${word}/word.json`
            let res = await (await fetch(url)).json()
            res['meanings_text'] = Object.entries(res['meanings']).map(([k, v]) => `${k}. ${v.join('；')}`).join('\n\n')
            ch.ch_20.setAttribute('show_state', 'question')  // 单词先消失
            ch.ch_22.textContent = ''
            ch.ch_24.textContent = `美 ${res['AmE']} 🔊`  // 然后修改音标显示
            ch.ch_26.textContent = `英 ${res['BrE']} 🔊`
            ch.ch_28.textContent = res['meanings_text']  // 然后修改中文显示
            ch.ch_30.value = ''  // 然后清空输入字符
            ch.ch_20.setAttribute('judgment', '')  // 然后让打勾消失
            ch.ch_20.setAttribute('first_result', '')
            ch.ch_32.textContent = word
            ch.ch_10.set('current_word', word)
            if (ch.ch_34.getAttribute('play_type') === '美') {ch.ch_15()}
            else if (ch.ch_34.getAttribute('play_type') === '英') {ch.ch_16()}
            ch.ch_30.focus()
        }
window.show_first_word = async () => {
            await ch.ch_47()
        }
ch.ch_42 = document.getElementById("ch_41")
ch.ch_44 = document.getElementById("ch_43")
ch.ch_38 = document.getElementById("ch_37")
ch.ch_36 = document.getElementById("ch_35")
ch.ch_40 = document.getElementById("ch_39")
ch.ch_45 = () => {
            let value = ch.ch_30.value
            let last = value.slice(-1)
            if (last === ' ') {
                ch.ch_30.value = value.replace(' ', '')
                let first_result = ch.ch_20.getAttribute('first_result')
                if (first_result === 'right') {ch.ch_36.click()}
                else if (first_result === 'wrong') {ch.ch_38.click()}
                else {ch.ch_40.click(); ch.ch_20.setAttribute('first_result', 'wrong')}
            }
            else {
                ch.ch_30.value = value = value.replace(/\d/g, "")
                let length = value.length
                let j_word_value = ch.ch_32.textContent
                if (j_word_value.slice(0, length) === value) {
                    if (length === j_word_value.length) {
                        ch.ch_20.setAttribute('judgment', 'done_right')
                        if (! ch.ch_20.getAttribute('first_result')) {  // 由于输入可以删除某些字符再重新输入, 因此记录第一次答题结果
                            if (ch.ch_20.getAttribute('show_state') === 'answer') {  // 分析是否查看了答案
                                ch.ch_20.setAttribute('first_result', 'wrong')
                            }
                            else {
                                ch.ch_22.textContent = ch.ch_17.get(ch.ch_10.get('current_word') || '') || ''
                                ch.ch_20.setAttribute('show_state', 'answer')
                                ch.ch_20.setAttribute('first_result', 'right')
                            }
                        }
                    }
                    else {
                        ch.ch_20.setAttribute('judgment', 'inputting')
                    }
                }
                else {
                    if (length === j_word_value.length) {
                        ch.ch_20.setAttribute('judgment', 'done_wrong')
                    }
                    else {
                        ch.ch_20.setAttribute('judgment', 'wrong')
                    }
                }
                if ('0123456789'.includes(last))  {
                    switch (last) {
                        case '2':
                            ch.ch_42.click()
                            break
                        case '4':
                            ch.ch_44.click()
                            break
                        case '5':
                            ch.ch_38.click()
                            break
                        case '6':
                            ch.ch_36.click()
                            break
                        case '8':
                            ch.ch_40.click()
                            if (! ch.ch_20.getAttribute('first_result')) {ch.ch_20.setAttribute('first_result', 'wrong')}
                            break
                        case '9':
                            ch.ch_15()
                            break
                        case '0':
                            ch.ch_16()
                            break
                    }
                }
            }
        }
ch.ch_30.addEventListener('input', async () => {ch.ch_45()})
ch.ch_30.addEventListener('keydown', async () => {if (event.key === 'Enter') {
            let first_result = ch.ch_20.getAttribute('first_result')
            if (first_result === 'right') {ch.ch_36.click()}
            else if (first_result === 'wrong') {ch.ch_38.click()}
            else {ch.ch_40.click(); ch.ch_20.setAttribute('first_result', 'wrong')}
        }})
ch.ch_24.addEventListener('click', async () => {ch.ch_15()})
ch.ch_26.addEventListener('click', async () => {ch.ch_16()})
ch.ch_42.addEventListener('click', async () => {ch.ch_47(true)})
ch.ch_44.addEventListener('click', async () => {ch.ch_47(true)})
ch.ch_38.addEventListener('click', async () => {ch.ch_47(true)})
ch.ch_36.addEventListener('click', async () => {ch.ch_47(true)})
ch.ch_46 = () => {
            let target = ch.ch_40
            if (target.getAttribute('tip_click') === '1') {
                target.setAttribute('tip_click', '2')
            }
            else {
                target.setAttribute('tip_click', '1')
            }
            ch.ch_22.textContent = ch.ch_17.get(ch.ch_10.get('current_word') || '') || ''
            ch.ch_20.setAttribute('show_state', 'answer')
            ch.ch_30.focus()
        }
ch.ch_40.addEventListener('click', async () => {ch.ch_46()})
ch.ch_34 = document.getElementById("ch_33")
ch.ch_34.addEventListener('click', async () => {if (ch.ch_34.getAttribute('play_type') === '美') {
                ch.ch_34.setAttribute("play_type", '英')
                ch.ch_34.textContent = '🔊[英]'
            }
            else if (ch.ch_34.getAttribute('play_type') === '英') {
                ch.ch_34.setAttribute("play_type", 'False')
                ch.ch_34.textContent = '🔇'
            }
            else {
                ch.ch_34.setAttribute("play_type", '美')
                ch.ch_34.textContent = '🔊[美]'
            }})

</script>
</body>
<script src='memory.js'>
"use strict";

</script>
</html>