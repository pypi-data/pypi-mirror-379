from unittest import TestCase
from gchat_sdk.entities.chat import Chat
from gchat_sdk.factories.chat_factory import get_chat_instance


class ChatFactoryTestCase(TestCase):
    
    def test_get_chat_instance(self):
        received_data = {'attendanceId': '67fd3c50c144bfe670bfb429', 'protocol': '202541420', 'status': 2, 'type': 2, 'origen': 1, 'description': 'FABIO PESSOAL SAUDE PLANOS', 'secondaryDescription': 'Fabio', 'linkImage': 'https://axy7gbdyolcg.compat.objectstorage.eu-frankfurt-1.oraclecloud.com/media01/avatar-default-icon.png', 'countUnreadMessages': 0, 'hasTag': True, 'utcDhStartChat': '2025-04-14T13:48:16.407', 'contact': {'id': '67dc1463c3103cbc7f763c63', 'name': 'FABIO PESSOAL SAUDE PLANOS', 'secondaryName': 'Fabio', 'number': '5511991808572', 'linkImage': 'https://axy7gbdyolcg.compat.objectstorage.eu-frankfurt-1.oraclecloud.com/media01/avatar-default-icon.png', 'isMe': False, 'tags': [{'Id': '65c151ca204d5662863166c4', 'OrganizationId': '65677c3c9d0ce82dfdae2646', 'HexColor': '#04ac10', 'Description': 'Cliente Telefonia'}, {'Id': '65c151e44d2d9d2ec5935be9', 'OrganizationId': '65677c3c9d0ce82dfdae2646', 'HexColor': '#dae834', 'Description': 'Cliente Gchat'}]}, 'channel': {'id': '663642c06f4ed0c2657819fc', 'type': 4, 'description': 'Gnew 2381', 'identifier': '+55 (11) 3709-2381'}, 'lastMessage': {'id': '67fe45b6867b172be4c5b42a', 'text': 'ðŸ”¼ _*#Aldemir Caetano:*_\nTinha uma modulo do pabx que tinha travado. JÃ¡ corrigi. ', 'sender': {'id': '6636f3c2d91e22f215ad31a5', 'name': 'VocÃª', 'secondaryName': 'VocÃª', 'number': '320215144505975', 'linkImage': 'https://axy7gbdyolcg.compat.objectstorage.eu-frankfurt-1.oraclecloud.com/media01/avatar-default-icon.png', 'isMe': True}, 'user': {}, 'utcDhMessage': '2025-04-15T08:40:38.545', 'utcDhMessageUnixTime': 1744717238, 'isPrivate': False}, 'lastReceivedMessageDate': '2025-04-15T11:23:20', 'lastSentMessageDate': '2025-04-15T08:40:38', 'currentSector': {'id': '65677e08860a2cc3433d15ad', 'description': 'Suporte Telefonia '}, 'currentOrganization': {'id': '65677c3c9d0ce82dfdae2646', 'description': 'Gnew'}, 'currentUser': {'id': '66311b97433799e85b3b29e4', 'name': 'Aldemir Caetano'}, 'timeInAutomatic': 0.0, 'timeInOutOfHour': 0.0, 'timeInWaiting': 25.8083698, 'timeInManual': 30956.9947464}
        chat = get_chat_instance(received_data)
        self.assertIsInstance(chat, Chat)