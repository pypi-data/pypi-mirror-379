import"../chunks/CWj6FrbW.js";import{p as M,f as _,n as Ae,a as Z,ax as xe,g as a,d as p,s as l,c as u,r,t as J,J as j,a7 as $e,$ as be,l as aa}from"../chunks/DcGCxgpH.js";import{c as E,a as n,t as x,d as Se,n as Be}from"../chunks/Crk-jcvV.js";import{i as D,a as F,s as He}from"../chunks/DqUGznj_.js";import{s as ae}from"../chunks/C0JiMuYn.js";import{p as le}from"../chunks/Df3aMO5B.js";import{I as Ne,j as Te,f as ta,n as we,C as De,w as Le,S as sa,h as ce,x as na,y as Ie,z as oa,k as ze,v as ra,B as Pe,D as la,e as da,i as ye,E as ia}from"../chunks/BRnH9v23.js";import{u as Ue}from"../chunks/BBoGk9hq.js";import{a as ca,g as ma}from"../chunks/2O287xak.js";import"../chunks/gLNdjSzu.js";import"../chunks/Cpy-nab_.js";import"../chunks/69_IOA4Y.js";import{e as Ce}from"../chunks/C98Hk3r5.js";import{s as Ee,r as Me,a as ke}from"../chunks/D8GZDMNN.js";import{S as Ze}from"../chunks/M1Q1F7bw.js";import{r as ee}from"../chunks/H7C68rOM.js";import{S as va}from"../chunks/CzgC3GFB.js";import{s as me}from"../chunks/KpAtIldw.js";import{B as ua,a as fa,b as Y,c as de,H as pa,d as ie,D as ga,e as _a,u as ha,Z as xa,g as $a,S as ba}from"../chunks/DFRh-Spp.js";import{T as Sa}from"../chunks/CG0dMCJi.js";function wa($,e){M(e,!0);let c=Me(e,["$$slots","$$events","$$legacy"]);Ne($,Ee({name:"file-image"},()=>c,{iconNode:[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["circle",{cx:"10",cy:"12",r:"2"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22"}]],children:(t,h)=>{var f=E(),k=_(f);ae(k,()=>e.children??Ae),n(t,f)},$$slots:{default:!0}})),Z()}function Ia($,e){M(e,!0);let c=Me(e,["$$slots","$$events","$$legacy"]);Ne($,Ee({name:"images"},()=>c,{iconNode:[["path",{d:"M18 22H4a2 2 0 0 1-2-2V6"}],["path",{d:"m22 13-1.296-1.296a2.41 2.41 0 0 0-3.408 0L11 18"}],["circle",{cx:"12",cy:"8",r:"2"}],["rect",{width:"16",height:"16",x:"6",y:"2",rx:"2"}]],children:(t,h)=>{var f=E(),k=_(f);ae(k,()=>e.children??Ae),n(t,f)},$$slots:{default:!0}})),Z()}var Pa=x('<!> <span class="hidden sm:inline">Home</span>',1),ya=x('<!> <span class="max-w-[150px] truncate"> </span>',1),Ca=x('<!> <span class="hidden sm:inline">Samples</span>',1),ka=x('<!> <span class="max-w-[200px] truncate"><!></span>',1),Aa=x("<!> <!> <!> <!> <!> <!> <!>",1);function Ba($,e){M(e,!0);const[c,S]=He(),t=()=>F(h,"$samplesTotalCount",c),{samplesTotalCount:h}=Ue();ua($,{class:"mb-2","data-testid":"sample-details-breadcrumb",children:(f,k)=>{fa(f,{children:(H,N)=>{var w=Aa(),A=_(w);Y(A,{children:(g,L)=>{const d=p(()=>ee.toHome());de(g,{get href(){return a(d)},class:"flex items-center gap-2",children:(i,m)=>{var s=Pa(),v=_(s);pa(v,{class:"h-4 w-4"}),xe(2),n(i,s)},$$slots:{default:!0}})},$$slots:{default:!0}});var I=l(A,2);ie(I,{});var P=l(I,2);Y(P,{children:(g,L)=>{const d=p(()=>ee.toSamples(e.dataset.dataset_id));de(g,{get href(){return a(d)},class:"flex items-center gap-2",get title(){return e.dataset.directory},children:(i,m)=>{var s=ya(),v=_(s);ga(v,{class:"h-4 w-4"});var C=l(v,2),G=u(C,!0);r(C),J(()=>{Te(C,"title",e.dataset.directory),me(G,e.dataset.name)}),n(i,s)},$$slots:{default:!0}})},$$slots:{default:!0}});var y=l(P,2);ie(y,{});var B=l(y,2);Y(B,{children:(g,L)=>{const d=p(()=>ee.toSamples(e.dataset.dataset_id));de(g,{get href(){return a(d)},class:"flex items-center gap-2",children:(i,m)=>{var s=Ca(),v=_(s);Ia(v,{class:"h-4 w-4"}),xe(2),n(i,s)},$$slots:{default:!0}})},$$slots:{default:!0}});var z=l(B,2);ie(z,{});var b=l(z,2);Y(b,{children:(g,L)=>{_a(g,{class:"flex items-center gap-2",children:(d,i)=>{var m=ka(),s=_(m);wa(s,{class:"h-4 w-4"});var v=l(s,2),C=u(v);{var G=T=>{var o=Se();J(()=>me(o,`Sample ${e.sampleIndex+1} of ${t()??""}`)),n(T,o)},te=T=>{var o=Se("Sample");n(T,o)};D(C,T=>{e.sampleIndex!==void 0?T(G):T(te,!1)})}r(v),n(d,m)},$$slots:{default:!0}})},$$slots:{default:!0}}),n(H,w)},$$slots:{default:!0}})},$$slots:{default:!0}}),Z(),S()}var Ha=Be("<g></g>"),Na=Be("<image></image><!>",1),Ta=x('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!> <!></div></div>'),Da=x('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center"><!></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function La($,e){M(e,!0);const[c,S]=He(),t=()=>F(a(z),"$sample",c),h=()=>F(H,"$selectedSampleIds",c),f=()=>F(A,"$isHidden",c),k=()=>F(d,"$showAnnotationTextLabelsStore",c),{selectedSampleIds:H,toggleSampleSelection:N}=Ue(),w=e.dataset.dataset_id,{isHidden:A,handleKeyEvent:I}=ta(),{settingsStore:P}=we(),y=()=>{ma(ee.toSamples(w))},B=p(()=>ha({sampleId:e.sampleId,datasetId:w})),z=p(()=>a(B).sample),b=p(()=>a(B).refetch),g=o=>{switch(o.key){case aa(P).key_go_back:y();break;case" ":o.preventDefault(),N(e.sampleId);break}I(o)};let L=p(()=>$a(e.sampleId));const{showAnnotationTextLabelsStore:d}=we();let i=$e(void 0);ca(()=>{j(i,void 0),j(s,void 0)});const m=o=>{a(i)===o?j(i,void 0):j(i,ke(o))};let s=$e(void 0);const v=o=>{if(t().data.annotations){const U=t().data.annotations.find(K=>K.annotation_id===o);U&&j(s,ke(Ie(U)))}};var C=E();Ce("keydown",be,g),Ce("keyup",be,I);var G=_(C);{var te=o=>{var U=Da(),K=u(U),Ge=u(K);Ba(Ge,{get dataset(){return e.dataset},get sampleIndex(){return e.sampleIndex}}),r(K);var ve=l(K,2);Ze(ve,{class:"mb-4 bg-border-hard"});var ue=l(ve,2),se=u(ue),Ke=u(se);De(Ke,{className:"h-full",children:(R,Ka)=>{Le(R,{className:"h-full",children:(je,Ra)=>{var ne=Ta(),pe=u(ne),oe=u(pe),Fe=u(oe);const Je=p(()=>h().has(e.sampleId));sa(Fe,{onSelect:()=>N(e.sampleId),get isSelected(){return a(Je)}}),r(oe);var ge=l(oe,2);{var We=W=>{var q=E(),O=_(q);ae(O,()=>e.children),n(W,q)};D(ge,W=>{e.children&&W(We)})}var qe=l(ge,2);xa(qe,{get width(){return t().data.width},get height(){return t().data.height},get boundingBox(){return a(s)},zoomableContent:q=>{var O=Na(),_e=_(O),Oe=l(_e);{var Qe=re=>{var Q=Ha();let he;ce(Q,5,()=>oa(t().data),V=>V.annotation_id,(V,X)=>{const Xe=p(()=>Ie(a(X))),Ye=p(()=>a(X).annotation_id===a(i));na(V,{get groupId(){return a(X).annotation_id},onSelect:m,get box(){return a(Xe)},get isSelected(){return a(Ye)},children:(ea,Va)=>{va(ea,{get annotation(){return a(X)},get showLabel(){return k()},get imageWidth(){return t().data.width}})},$$slots:{default:!0}})}),r(Q),J(V=>he=ze(Q,0,"",null,he,V),[()=>({invisible:f()})]),n(re,Q)};D(Oe,re=>{t().data&&re(Qe)})}J(()=>Te(_e,"href",a(L))),n(q,O)},$$slots:{zoomableContent:!0}}),r(pe),r(ne),n(je,ne)},$$slots:{default:!0}})},$$slots:{default:!0}}),r(se);var fe=l(se,2),Re=u(fe);{var Ve=R=>{Za(R,{get sample(){return t().data},get selectedAnnotationId(){return a(i)},onAnnotationClick:m,onClickCenterIcon:v,get onUpdate(){return a(b)}})};D(Re,R=>{t().data&&R(Ve)})}r(fe),r(ue),r(U),n(o,U)},T=o=>{ra(o,{})};D(G,o=>{t().data?o(te):o(T,!1)})}n($,C),Z(),S()}var za=x("<div> </div>"),Ua=x('<div class="flex gap-1"></div>'),Ea=x('<div class="flex flex-col gap-2"></div>'),Ma=x('<div class="flex-none"><div class="mb-2.5 text-lg font-semibold">Sample details</div> <!></div> <div class="flex h-full min-h-0 flex-col space-y-4 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!></div>',1);function Za($,e){M(e,!0);const c=e.sample.tags,S=p(()=>e.sample.annotations?[...e.sample.annotations].sort((t,h)=>t.annotation_label.annotation_label_name.localeCompare(h.annotation_label.annotation_label_name)):[]);De($,{className:"h-full",children:(t,h)=>{Le(t,{className:"h-full flex flex-col",children:(f,k)=>{var H=Ma(),N=_(H),w=l(u(N),2);Ze(w,{class:"mb-4 bg-border-hard"}),r(N);var A=l(N,2),I=u(A);{var P=b=>{Pe(b,{title:"Tags",icon:Sa,children:(g,L)=>{var d=Ua();ce(d,21,()=>c,ye,(i,m)=>{var s=za(),v=u(s,!0);r(s),J(C=>{ze(s,1,C),me(v,a(m).name)},[()=>la(da("inline rounded-lg bg-card px-2 py-2 text-xs"))]),n(i,s)}),r(d),n(g,d)}})};D(I,b=>{c&&c.length>0&&b(P)})}var y=l(I,2);{var B=b=>{Pe(b,{title:"Annotations",children:(g,L)=>{var d=Ea();ce(d,21,()=>a(S),ye,(i,m)=>{const s=p(()=>e.selectedAnnotationId===a(m).annotation_id);ia(i,{get annotation(){return a(m)},get isSelected(){return a(s)},onClick:()=>e.onAnnotationClick(a(m).annotation_id),onClickCenterIcon:v=>{v.stopPropagation(),e.onClickCenterIcon(a(m).annotation_id)},get onUpdate(){return e.onUpdate}})}),r(d),n(g,d)}})};D(y,b=>{a(S).length>0&&b(B)})}var z=l(y,2);ba(z,{get sample(){return e.sample}}),r(A),n(f,H)},$$slots:{default:!0}})},$$slots:{default:!0}}),Z()}var Ga=x('<div class="flex h-full w-full space-x-4 px-4 pb-4" data-testid="sample-details"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function mt($,e){M(e,!0);const c=p(()=>le.params.sampleId),S=le.data.dataset,t=p(()=>Number(le.params.sampleIndex));var h=Ga(),f=u(h),k=u(f);La(k,{get sampleId(){return a(c)},dataset:S,get sampleIndex(){return a(t)},children:(H,N)=>{var w=E(),A=_(w);{var I=P=>{var y=E(),B=_(y);ae(B,()=>e.children),n(P,y)};D(A,P=>{e.children&&P(I)})}n(H,w)},$$slots:{default:!0}}),r(f),r(h),n($,h),Z()}export{mt as component};
