import{a as E}from"./Cpy-nab_.js";import{w as n,l as g}from"./DcGCxgpH.js";function d(s,o){const i=n((()=>{if(typeof sessionStorage>"u")return o;try{const a=sessionStorage.getItem(s);if(a)return JSON.parse(a)}catch(a){console.warn(`Failed to read ${s} from sessionStorage`,a)}return o})());return i.subscribe(a=>{if(!(typeof sessionStorage>"u"))try{sessionStorage.setItem(s,JSON.stringify(a))}catch(h){console.warn(`Failed to write ${s} to sessionStorage`,h)}}),i}const r=n([]),I=()=>({reversibleActions:r,addReversibleAction:s=>{r.update(o=>[s,...o].slice(0,50))},executeReversibleAction:async s=>{const o=g(r),l=o.find(i=>i.id===s);if(l){await l.execute();const i=o.findIndex(a=>a.id===s);r.update(a=>a.slice(i+1))}},clearReversibleActions:()=>{r.set([])},clearReversibleActionsByGroupId:s=>{r.update(o=>o.filter(l=>l.groupId!==s))},hasReversibleActions:()=>g(r).length>0}),b=n("samples"),u=n(new Set),p=n(new Set),S=n(new Set),v=n(0),w=n(0),y=n(!1),C=n(void 0),f=n(null),_=d("lightlyStudio_sampleSize",{width:200,height:200}),T=d("lightlyStudio_metadata_bounds",{}),x=d("lightlyStudio_metadata_values",{}),M=d("lightlyStudio_metadata_info",[]),B=n(void 0),G=n([]),m=n({}),R=n(!1),V=s=>{R.set(s)},J=()=>{const s=I();return{tags:B,textEmbedding:C,setTextEmbedding:e=>{C.set(e)},selectedSampleIds:u,selectedSampleAnnotationCropIds:p,selectedAnnotationFilterIds:S,annotationsTotalCount:v,samplesTotalCount:w,datasetVersions:m,hideAnnotations:y,classifiers:G,classifierSamples:f,setClassifierSamples:e=>{f.set(e)},clearClassifierSamples:()=>{f.set(null)},metadataBounds:T,metadataValues:x,metadataInfo:M,updateMetadataValues:e=>{x.set(e)},updateMetadataBounds:e=>{T.set(e)},updateMetadataInfo:e=>{M.set(e)},setHideAnnotations:e=>{y.set(e)},getDatasetVersion:async e=>{const t=g(m);if(t[e])return t[e];const{data:c}=await E({path:{dataset_id:e}});if(c!=null&&c.created_at){const A=new Date(c.created_at).getTime().toString();return m.update(z=>({...z,[e]:A})),A}return""},toggleSampleSelection:e=>{u.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSamples:()=>{u.update(e=>(e.clear(),e))},toggleSampleAnnotationCropSelection:e=>{p.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedSampleAnnotationCrops:()=>{p.update(e=>(e.clear(),e))},lastGridType:b,setLastGridType:e=>{b.set(e)},setSelectedAnnotationFilterIds:e=>{S.update(t=>(t.has(e)?t.delete(e):t.add(e),t))},clearSelectedAnnotationFilterIds:()=>{S.update(e=>(e.clear(),e))},setAnnotationsTotalCount:e=>{v.set(e)},setSamplesTotalCount:e=>{w.set(e)},sampleSize:_,updateSampleSize:e=>{_.set({width:e,height:e})},isEditingMode:R,setIsEditingMode:V,...s}};export{d as a,J as u};
