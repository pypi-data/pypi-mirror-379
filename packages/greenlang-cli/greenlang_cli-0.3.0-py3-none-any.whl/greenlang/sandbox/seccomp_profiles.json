{
  "profiles": {
    "default": {
      "description": "Default restrictive seccomp profile for GreenLang",
      "defaultAction": "SCMP_ACT_ERRNO",
      "architectures": [
        "SCMP_ARCH_X86_64",
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": [
            "read",
            "write",
            "open",
            "close",
            "stat",
            "fstat",
            "lstat",
            "poll",
            "lseek",
            "mmap",
            "mprotect",
            "munmap",
            "brk",
            "rt_sigaction",
            "rt_sigprocmask",
            "rt_sigreturn",
            "ioctl",
            "pread64",
            "pwrite64",
            "readv",
            "writev",
            "access",
            "pipe",
            "select",
            "sched_yield",
            "mremap",
            "msync",
            "mincore",
            "madvise",
            "shmget",
            "shmat",
            "shmctl",
            "dup",
            "dup2",
            "pause",
            "nanosleep",
            "getitimer",
            "alarm",
            "setitimer",
            "getpid",
            "sendfile",
            "socket",
            "connect",
            "accept",
            "sendto",
            "recvfrom",
            "sendmsg",
            "recvmsg",
            "shutdown",
            "bind",
            "listen",
            "getsockname",
            "getpeername",
            "socketpair",
            "setsockopt",
            "getsockopt",
            "clone",
            "fork",
            "vfork",
            "execve",
            "exit",
            "wait4",
            "kill",
            "uname",
            "semget",
            "semop",
            "semctl",
            "shmdt",
            "msgget",
            "msgsnd",
            "msgrcv",
            "msgctl",
            "fcntl",
            "flock",
            "fsync",
            "fdatasync",
            "truncate",
            "ftruncate",
            "getdents",
            "getcwd",
            "chdir",
            "fchdir",
            "rename",
            "mkdir",
            "rmdir",
            "creat",
            "link",
            "unlink",
            "symlink",
            "readlink",
            "chmod",
            "fchmod",
            "chown",
            "fchown",
            "lchown",
            "umask",
            "gettimeofday",
            "getrlimit",
            "getrusage",
            "sysinfo",
            "times",
            "ptrace",
            "getuid",
            "syslog",
            "getgid",
            "setuid",
            "setgid",
            "geteuid",
            "getegid",
            "setpgid",
            "getppid",
            "getpgrp",
            "setsid",
            "setreuid",
            "setregid",
            "getgroups",
            "setgroups",
            "setresuid",
            "getresuid",
            "setresgid",
            "getresgid",
            "getpgid",
            "setfsuid",
            "setfsgid",
            "getsid",
            "capget",
            "capset",
            "rt_sigpending",
            "rt_sigtimedwait",
            "rt_sigqueueinfo",
            "rt_sigsuspend",
            "sigaltstack",
            "utime",
            "mknod",
            "uselib",
            "personality",
            "ustat",
            "statfs",
            "fstatfs",
            "sysfs",
            "getpriority",
            "setpriority",
            "sched_setparam",
            "sched_getparam",
            "sched_setscheduler",
            "sched_getscheduler",
            "sched_get_priority_max",
            "sched_get_priority_min",
            "sched_rr_get_interval",
            "mlock",
            "munlock",
            "mlockall",
            "munlockall",
            "vhangup",
            "modify_ldt",
            "pivot_root",
            "_sysctl",
            "prctl",
            "arch_prctl",
            "adjtimex",
            "setrlimit",
            "chroot",
            "sync",
            "acct",
            "settimeofday",
            "mount",
            "umount2",
            "swapon",
            "swapoff",
            "reboot",
            "sethostname",
            "setdomainname",
            "iopl",
            "ioperm",
            "create_module",
            "init_module",
            "delete_module",
            "get_kernel_syms",
            "query_module",
            "quotactl",
            "nfsservctl",
            "getpmsg",
            "putpmsg",
            "afs_syscall",
            "tuxcall",
            "security",
            "gettid",
            "readahead",
            "setxattr",
            "lsetxattr",
            "fsetxattr",
            "getxattr",
            "lgetxattr",
            "fgetxattr",
            "listxattr",
            "llistxattr",
            "flistxattr",
            "removexattr",
            "lremovexattr",
            "fremovexattr",
            "tkill",
            "time",
            "futex",
            "sched_setaffinity",
            "sched_getaffinity",
            "set_thread_area",
            "io_setup",
            "io_destroy",
            "io_getevents",
            "io_submit",
            "io_cancel",
            "get_thread_area",
            "lookup_dcookie",
            "epoll_create",
            "epoll_ctl_old",
            "epoll_wait_old",
            "remap_file_pages",
            "getdents64",
            "set_tid_address",
            "restart_syscall",
            "semtimedop",
            "fadvise64",
            "timer_create",
            "timer_settime",
            "timer_gettime",
            "timer_getoverrun",
            "timer_delete",
            "clock_settime",
            "clock_gettime",
            "clock_getres",
            "clock_nanosleep",
            "exit_group",
            "epoll_wait",
            "epoll_ctl",
            "tgkill",
            "utimes",
            "vserver",
            "mbind",
            "set_mempolicy",
            "get_mempolicy",
            "mq_open",
            "mq_unlink",
            "mq_timedsend",
            "mq_timedreceive",
            "mq_notify",
            "mq_getsetattr",
            "kexec_load",
            "waitid",
            "add_key",
            "request_key",
            "keyctl",
            "ioprio_set",
            "ioprio_get",
            "inotify_init",
            "inotify_add_watch",
            "inotify_rm_watch",
            "migrate_pages",
            "openat",
            "mkdirat",
            "mknodat",
            "fchownat",
            "futimesat",
            "newfstatat",
            "unlinkat",
            "renameat",
            "linkat",
            "symlinkat",
            "readlinkat",
            "fchmodat",
            "faccessat",
            "pselect6",
            "ppoll",
            "unshare",
            "set_robust_list",
            "get_robust_list",
            "splice",
            "tee",
            "sync_file_range",
            "vmsplice",
            "move_pages",
            "utimensat",
            "epoll_pwait",
            "signalfd",
            "timerfd_create",
            "eventfd",
            "fallocate",
            "timerfd_settime",
            "timerfd_gettime",
            "accept4",
            "signalfd4",
            "eventfd2",
            "epoll_create1",
            "dup3",
            "pipe2",
            "inotify_init1",
            "preadv",
            "pwritev",
            "rt_tgsigqueueinfo",
            "perf_event_open",
            "recvmmsg",
            "fanotify_init",
            "fanotify_mark",
            "prlimit64"
          ],
          "action": "SCMP_ACT_ALLOW"
        }
      ]
    },
    "compute_only": {
      "description": "Restrictive profile for compute-only operations (no network, limited filesystem)",
      "defaultAction": "SCMP_ACT_ERRNO",
      "architectures": [
        "SCMP_ARCH_X86_64",
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": [
            "read",
            "write",
            "close",
            "stat",
            "fstat",
            "lstat",
            "lseek",
            "mmap",
            "mprotect",
            "munmap",
            "brk",
            "rt_sigaction",
            "rt_sigprocmask",
            "rt_sigreturn",
            "pread64",
            "pwrite64",
            "readv",
            "writev",
            "sched_yield",
            "mremap",
            "msync",
            "mincore",
            "madvise",
            "dup",
            "dup2",
            "pause",
            "nanosleep",
            "getitimer",
            "setitimer",
            "getpid",
            "clone",
            "exit",
            "wait4",
            "uname",
            "fcntl",
            "fsync",
            "fdatasync",
            "getcwd",
            "gettimeofday",
            "getrlimit",
            "getrusage",
            "sysinfo",
            "times",
            "getuid",
            "getgid",
            "geteuid",
            "getegid",
            "getpgrp",
            "getppid",
            "getresuid",
            "getresgid",
            "getpgid",
            "getsid",
            "rt_sigpending",
            "rt_sigtimedwait",
            "rt_sigqueueinfo",
            "rt_sigsuspend",
            "sigaltstack",
            "getpriority",
            "setpriority",
            "sched_setparam",
            "sched_getparam",
            "sched_setscheduler",
            "sched_getscheduler",
            "sched_get_priority_max",
            "sched_get_priority_min",
            "sched_rr_get_interval",
            "prctl",
            "arch_prctl",
            "setrlimit",
            "gettid",
            "futex",
            "sched_setaffinity",
            "sched_getaffinity",
            "set_thread_area",
            "get_thread_area",
            "set_tid_address",
            "restart_syscall",
            "clock_gettime",
            "clock_getres",
            "clock_nanosleep",
            "exit_group",
            "tgkill",
            "set_robust_list",
            "get_robust_list",
            "eventfd",
            "eventfd2",
            "prlimit64"
          ],
          "action": "SCMP_ACT_ALLOW"
        }
      ]
    },
    "data_processing": {
      "description": "Profile for data processing with limited file system access",
      "defaultAction": "SCMP_ACT_ERRNO",
      "architectures": [
        "SCMP_ARCH_X86_64",
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": [
            "read",
            "write",
            "open",
            "close",
            "stat",
            "fstat",
            "lstat",
            "poll",
            "lseek",
            "mmap",
            "mprotect",
            "munmap",
            "brk",
            "rt_sigaction",
            "rt_sigprocmask",
            "rt_sigreturn",
            "ioctl",
            "pread64",
            "pwrite64",
            "readv",
            "writev",
            "access",
            "pipe",
            "select",
            "sched_yield",
            "mremap",
            "msync",
            "mincore",
            "madvise",
            "dup",
            "dup2",
            "pause",
            "nanosleep",
            "getitimer",
            "setitimer",
            "getpid",
            "clone",
            "fork",
            "vfork",
            "execve",
            "exit",
            "wait4",
            "kill",
            "uname",
            "fcntl",
            "flock",
            "fsync",
            "fdatasync",
            "truncate",
            "ftruncate",
            "getdents",
            "getcwd",
            "chdir",
            "fchdir",
            "rename",
            "mkdir",
            "rmdir",
            "creat",
            "link",
            "unlink",
            "symlink",
            "readlink",
            "chmod",
            "fchmod",
            "umask",
            "gettimeofday",
            "getrlimit",
            "getrusage",
            "sysinfo",
            "times",
            "getuid",
            "getgid",
            "geteuid",
            "getegid",
            "setpgid",
            "getppid",
            "getpgrp",
            "setsid",
            "getresuid",
            "getresgid",
            "getpgid",
            "getsid",
            "rt_sigpending",
            "rt_sigtimedwait",
            "rt_sigqueueinfo",
            "rt_sigsuspend",
            "sigaltstack",
            "utime",
            "getpriority",
            "setpriority",
            "sched_setparam",
            "sched_getparam",
            "sched_setscheduler",
            "sched_getscheduler",
            "sched_get_priority_max",
            "sched_get_priority_min",
            "sched_rr_get_interval",
            "prctl",
            "arch_prctl",
            "setrlimit",
            "gettid",
            "readahead",
            "setxattr",
            "lsetxattr",
            "fsetxattr",
            "getxattr",
            "lgetxattr",
            "fgetxattr",
            "listxattr",
            "llistxattr",
            "flistxattr",
            "removexattr",
            "lremovexattr",
            "fremovexattr",
            "tkill",
            "time",
            "futex",
            "sched_setaffinity",
            "sched_getaffinity",
            "set_thread_area",
            "get_thread_area",
            "getdents64",
            "set_tid_address",
            "restart_syscall",
            "fadvise64",
            "clock_gettime",
            "clock_getres",
            "clock_nanosleep",
            "exit_group",
            "tgkill",
            "utimes",
            "openat",
            "mkdirat",
            "mknodat",
            "futimesat",
            "newfstatat",
            "unlinkat",
            "renameat",
            "linkat",
            "symlinkat",
            "readlinkat",
            "fchmodat",
            "faccessat",
            "pselect6",
            "ppoll",
            "set_robust_list",
            "get_robust_list",
            "splice",
            "tee",
            "sync_file_range",
            "vmsplice",
            "utimensat",
            "fallocate",
            "dup3",
            "pipe2",
            "preadv",
            "pwritev",
            "prlimit64"
          ],
          "action": "SCMP_ACT_ALLOW"
        }
      ]
    },
    "network_client": {
      "description": "Profile for network client operations with filesystem access",
      "defaultAction": "SCMP_ACT_ERRNO",
      "architectures": [
        "SCMP_ARCH_X86_64",
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": [
            "read",
            "write",
            "open",
            "close",
            "stat",
            "fstat",
            "lstat",
            "poll",
            "lseek",
            "mmap",
            "mprotect",
            "munmap",
            "brk",
            "rt_sigaction",
            "rt_sigprocmask",
            "rt_sigreturn",
            "ioctl",
            "pread64",
            "pwrite64",
            "readv",
            "writev",
            "access",
            "pipe",
            "select",
            "sched_yield",
            "mremap",
            "msync",
            "mincore",
            "madvise",
            "dup",
            "dup2",
            "pause",
            "nanosleep",
            "getitimer",
            "setitimer",
            "getpid",
            "sendfile",
            "socket",
            "connect",
            "accept",
            "sendto",
            "recvfrom",
            "sendmsg",
            "recvmsg",
            "shutdown",
            "bind",
            "listen",
            "getsockname",
            "getpeername",
            "socketpair",
            "setsockopt",
            "getsockopt",
            "clone",
            "fork",
            "vfork",
            "execve",
            "exit",
            "wait4",
            "kill",
            "uname",
            "fcntl",
            "flock",
            "fsync",
            "fdatasync",
            "truncate",
            "ftruncate",
            "getdents",
            "getcwd",
            "chdir",
            "fchdir",
            "rename",
            "mkdir",
            "rmdir",
            "creat",
            "link",
            "unlink",
            "symlink",
            "readlink",
            "chmod",
            "fchmod",
            "umask",
            "gettimeofday",
            "getrlimit",
            "getrusage",
            "sysinfo",
            "times",
            "getuid",
            "getgid",
            "geteuid",
            "getegid",
            "setpgid",
            "getppid",
            "getpgrp",
            "setsid",
            "getresuid",
            "getresgid",
            "getpgid",
            "getsid",
            "rt_sigpending",
            "rt_sigtimedwait",
            "rt_sigqueueinfo",
            "rt_sigsuspend",
            "sigaltstack",
            "utime",
            "getpriority",
            "setpriority",
            "sched_setparam",
            "sched_getparam",
            "sched_setscheduler",
            "sched_getscheduler",
            "sched_get_priority_max",
            "sched_get_priority_min",
            "sched_rr_get_interval",
            "prctl",
            "arch_prctl",
            "setrlimit",
            "gettid",
            "readahead",
            "setxattr",
            "lsetxattr",
            "fsetxattr",
            "getxattr",
            "lgetxattr",
            "fgetxattr",
            "listxattr",
            "llistxattr",
            "flistxattr",
            "removexattr",
            "lremovexattr",
            "fremovexattr",
            "tkill",
            "time",
            "futex",
            "sched_setaffinity",
            "sched_getaffinity",
            "set_thread_area",
            "get_thread_area",
            "epoll_create",
            "epoll_ctl_old",
            "epoll_wait_old",
            "getdents64",
            "set_tid_address",
            "restart_syscall",
            "fadvise64",
            "clock_gettime",
            "clock_getres",
            "clock_nanosleep",
            "exit_group",
            "epoll_wait",
            "epoll_ctl",
            "tgkill",
            "utimes",
            "openat",
            "mkdirat",
            "mknodat",
            "futimesat",
            "newfstatat",
            "unlinkat",
            "renameat",
            "linkat",
            "symlinkat",
            "readlinkat",
            "fchmodat",
            "faccessat",
            "pselect6",
            "ppoll",
            "set_robust_list",
            "get_robust_list",
            "splice",
            "tee",
            "sync_file_range",
            "vmsplice",
            "utimensat",
            "epoll_pwait",
            "eventfd",
            "fallocate",
            "accept4",
            "eventfd2",
            "epoll_create1",
            "dup3",
            "pipe2",
            "preadv",
            "pwritev",
            "rt_tgsigqueueinfo",
            "recvmmsg",
            "prlimit64"
          ],
          "action": "SCMP_ACT_ALLOW"
        }
      ]
    },
    "blocked_dangerous": {
      "description": "Profile that explicitly blocks dangerous system calls",
      "defaultAction": "SCMP_ACT_ALLOW",
      "architectures": [
        "SCMP_ARCH_X86_64",
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ],
      "syscalls": [
        {
          "names": [
            "ptrace",
            "reboot",
            "mount",
            "umount",
            "umount2",
            "swapon",
            "swapoff",
            "sethostname",
            "setdomainname",
            "iopl",
            "ioperm",
            "create_module",
            "init_module",
            "delete_module",
            "get_kernel_syms",
            "query_module",
            "quotactl",
            "nfsservctl",
            "acct",
            "settimeofday",
            "clock_settime",
            "kexec_load",
            "add_key",
            "request_key",
            "keyctl",
            "migrate_pages",
            "move_pages",
            "perf_event_open",
            "fanotify_init",
            "fanotify_mark",
            "process_vm_readv",
            "process_vm_writev",
            "kcmp",
            "finit_module",
            "kexec_file_load",
            "bpf",
            "execveat",
            "userfaultfd",
            "membarrier",
            "mlock2",
            "copy_file_range",
            "preadv2",
            "pwritev2",
            "pkey_mprotect",
            "pkey_alloc",
            "pkey_free",
            "statx",
            "io_pgetevents",
            "rseq"
          ],
          "action": "SCMP_ACT_ERRNO",
          "errno": 1
        },
        {
          "names": [
            "chmod",
            "fchmod",
            "fchmodat",
            "chown",
            "fchown",
            "fchownat",
            "lchown"
          ],
          "action": "SCMP_ACT_ERRNO",
          "errno": 1,
          "comment": "Block permission changes"
        },
        {
          "names": [
            "setuid",
            "setgid",
            "setreuid",
            "setregid",
            "setresuid",
            "setresgid",
            "setfsuid",
            "setfsgid"
          ],
          "action": "SCMP_ACT_ERRNO",
          "errno": 1,
          "comment": "Block user/group ID changes"
        }
      ]
    }
  },
  "metadata": {
    "version": "1.0.0",
    "description": "Seccomp-BPF profiles for GreenLang OS-level sandbox",
    "author": "GreenLang Security Team",
    "created": "2024-09-24",
    "last_modified": "2024-09-24",
    "documentation": {
      "profiles": {
        "default": "Standard restrictive profile suitable for most GreenLang operations",
        "compute_only": "Highly restrictive profile for pure computation tasks without I/O",
        "data_processing": "Profile allowing filesystem operations for data processing tasks",
        "network_client": "Profile allowing network operations for client applications",
        "blocked_dangerous": "Whitelist profile that blocks specifically dangerous system calls"
      },
      "actions": {
        "SCMP_ACT_ALLOW": "Allow the system call to proceed",
        "SCMP_ACT_ERRNO": "Return specified errno value (default: EPERM)",
        "SCMP_ACT_KILL": "Kill the process immediately",
        "SCMP_ACT_TRAP": "Send SIGSYS signal to process",
        "SCMP_ACT_TRACE": "Trace the system call"
      },
      "usage": "These profiles are loaded by the OS sandbox implementation to create seccomp-bpf filters that restrict system calls available to sandboxed processes"
    }
  }
}