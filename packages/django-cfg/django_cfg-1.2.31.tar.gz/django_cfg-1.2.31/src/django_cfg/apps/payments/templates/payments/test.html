{% extends 'payments/base.html' %}
{% load static %}
{% load payments_tags %}

{% block header_title %}Payment Testing{% endblock %}
{% block header_subtitle %}Test payment integrations and webhooks{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Test Environment Status -->
    <div class="bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-default shadow-xs">
        <div class="p-6 border-b border-base-200 dark:border-base-700">
            <h2 class="text-lg font-semibold text-font-important-light dark:text-font-important-dark">Test Environment Status</h2>
            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mt-1">Current configuration and provider status</p>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-green-600 dark:text-green-400 text-xl mr-3">check_circle</span>
                        <div>
                            <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">Test Mode</h3>
                            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark">Enabled</p>
                        </div>
                    </div>
                </div>
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-blue-600 dark:text-blue-400 text-xl mr-3">webhook</span>
                        <div>
                            <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">Webhooks</h3>
                            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark">Active</p>
                        </div>
                    </div>
                </div>
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-orange-600 dark:text-orange-400 text-xl mr-3">security</span>
                        <div>
                            <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">Security</h3>
                            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark">Validated</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Provider Testing -->
    <div class="bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-default shadow-xs">
        <div class="p-6 border-b border-base-200 dark:border-base-700">
            <h2 class="text-lg font-semibold text-font-important-light dark:text-font-important-dark">Provider Testing</h2>
            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mt-1">Test individual payment providers</p>
        </div>
        <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- CryptAPI Test -->
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">CryptAPI</h3>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                            Active
                        </span>
                    </div>
                    <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mb-4">Test Bitcoin payments</p>
                    <button class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                        Test CryptAPI
                    </button>
                </div>

                <!-- Cryptomus Test -->
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">Cryptomus</h3>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                            Active
                        </span>
                    </div>
                    <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mb-4">Test multi-crypto payments</p>
                    <button class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                        Test Cryptomus
                    </button>
                </div>

                <!-- Stripe Test -->
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-semibold text-font-important-light dark:text-font-important-dark">Stripe</h3>
                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                            Configured
                        </span>
                    </div>
                    <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mb-4">Test card payments</p>
                    <button class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                        Test Stripe
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Webhook Testing -->
    <div class="bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-default shadow-xs">
        <div class="p-6 border-b border-base-200 dark:border-base-700">
            <h2 class="text-lg font-semibold text-font-important-light dark:text-font-important-dark">Webhook Testing</h2>
            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mt-1">Test webhook endpoints and processing</p>
        </div>
        <div class="p-6">
            <div class="space-y-4">
                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <h3 class="font-semibold text-font-important-light dark:text-font-important-dark mb-2">Ngrok Integration</h3>
                    <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mb-3">
                        Automatic tunnel creation for webhook testing
                    </p>
                    <div class="flex items-center space-x-3">
                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                            Start Ngrok
                        </button>
                        <button class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                            View Logs
                        </button>
                        <span class="text-sm text-font-subtle-light dark:text-font-subtle-dark">
                            Status: <span class="text-green-600 dark:text-green-400 font-medium">Ready</span>
                        </span>
                    </div>
                </div>

                <div class="bg-base-50 dark:bg-base-800 p-4 rounded-default border border-base-200 dark:border-base-700">
                    <h3 class="font-semibold text-font-important-light dark:text-font-important-dark mb-2">Webhook Simulation</h3>
                    <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mb-3">
                        Send test webhooks to validate processing
                    </p>
                    <div class="flex items-center space-x-3">
                        <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                            Send Test Payment
                        </button>
                        <button class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                            Send Test Failure
                        </button>
                        <button class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-default text-sm font-medium transition-colors duration-200">
                            Send Test Confirmation
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Results -->
    <div class="bg-white dark:bg-base-900 border border-base-200 dark:border-base-700 rounded-default shadow-xs">
        <div class="p-6 border-b border-base-200 dark:border-base-700">
            <h2 class="text-lg font-semibold text-font-important-light dark:text-font-important-dark">Recent Test Results</h2>
            <p class="text-sm text-font-subtle-light dark:text-font-subtle-dark mt-1">Latest testing activity</p>
        </div>
        <div class="p-6">
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 bg-base-50 dark:bg-base-800 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-green-600 dark:text-green-400 text-sm mr-3">check_circle</span>
                        <div>
                            <p class="text-sm font-medium text-font-important-light dark:text-font-important-dark">CryptAPI Payment Test</p>
                            <p class="text-xs text-font-subtle-light dark:text-font-subtle-dark">Webhook received successfully</p>
                        </div>
                    </div>
                    <span class="text-xs text-font-subtle-light dark:text-font-subtle-dark">2 minutes ago</span>
                </div>

                <div class="flex items-center justify-between p-3 bg-base-50 dark:bg-base-800 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-blue-600 dark:text-blue-400 text-sm mr-3">info</span>
                        <div>
                            <p class="text-sm font-medium text-font-important-light dark:text-font-important-dark">Ngrok Tunnel</p>
                            <p class="text-xs text-font-subtle-light dark:text-font-subtle-dark">Started on https://abc123.ngrok.io</p>
                        </div>
                    </div>
                    <span class="text-xs text-font-subtle-light dark:text-font-subtle-dark">5 minutes ago</span>
                </div>

                <div class="flex items-center justify-between p-3 bg-base-50 dark:bg-base-800 rounded-default border border-base-200 dark:border-base-700">
                    <div class="flex items-center">
                        <span class="material-icons text-orange-600 dark:text-orange-400 text-sm mr-3">warning</span>
                        <div>
                            <p class="text-sm font-medium text-font-important-light dark:text-font-important-dark">Cryptomus Configuration</p>
                            <p class="text-xs text-font-subtle-light dark:text-font-subtle-dark">API key validation required</p>
                        </div>
                    </div>
                    <span class="text-xs text-font-subtle-light dark:text-font-subtle-dark">10 minutes ago</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
// Testing functionality would be implemented here
document.addEventListener('DOMContentLoaded', function() {
    console.log('Payment testing interface loaded');
    
    // Add click handlers for test buttons
    document.querySelectorAll('button').forEach(button => {
        button.addEventListener('click', function() {
            if (this.textContent.includes('Test')) {
                console.log('Test initiated:', this.textContent);
                // Actual testing logic would go here
            }
        });
    });
});
</script>
{% endblock %}
