stages:
  - compilation
  - simulation

wishlist_compilation:
  stage: compilation
  script:
    - conda activate wishlist
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - python3 edawishlist/wishlist.py examples/L1CaloGfex.yaml
    - python3 edawishlist/wishlist.py examples/example.yaml
  tags:
    - wishlist
    - cocotb
  artifacts:
    paths:
      - firmware
      - software

l1calogfex_uhal_simulation:
  stage: simulation
  script:
    - source /cvmfs/atlas.cern.ch/repo/sw/tdaq/tdaq/tdaq-10-01-00/installed/setup.sh
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - python3 edawishlist/uhal_dummy_connection.py software/l1calogfex_uhal.xml
  tags:
    - uhal

example_uhal_simulation:
  stage: simulation
  script:
    - source /cvmfs/atlas.cern.ch/repo/sw/tdaq/tdaq/tdaq-10-01-00/installed/setup.sh
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - python3 edawishlist/uhal_dummy_connection.py software/example_uhal.xml
  tags:
    - uhal

example_addr_decoder_simulation:
  stage: simulation
  script:
    - source /eda/set_siemens.sh
    - conda activate wishlist
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - cd simulation/address_decoder
    - GUI=0 DESIGN=example make
  tags:
    - cocotb

l1calogfex_addr_decoder_simulation:
  stage: simulation
  script:
    - source /eda/set_siemens.sh
    - conda activate wishlist
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - cd simulation/address_decoder
    - GUI=0 DESIGN=l1calogfex make
  tags:
    - cocotb

example_axilite_simulation:
  stage: simulation
  script:
    - source /eda/set_siemens.sh
    - conda activate wishlist
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - cd simulation/axilite
    - GUI=0 DESIGN=example make
  tags:
    - cocotb

l1calogfex_axilite_simulation:
  stage: simulation
  script:
    - source /eda/set_siemens.sh
    - conda activate wishlist
    - export PYTHONPATH=$PWD:$PYTHONPATH
    - cd simulation/axilite
    - GUI=0 DESIGN=l1calogfex make
  tags:
    - cocotb

