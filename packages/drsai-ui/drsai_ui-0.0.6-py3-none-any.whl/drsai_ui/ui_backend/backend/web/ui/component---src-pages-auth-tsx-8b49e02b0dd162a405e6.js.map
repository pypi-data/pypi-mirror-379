{"version":3,"file":"component---src-pages-auth-tsx-8b49e02b0dd162a405e6.js","mappings":"kJAsCA,UA/BiBA,KACf,MAAM,QAAEC,GAAYC,EAAAA,WAAiBC,EAAAA,GA2BrC,OA1BAD,EAAAA,WAAgB,KACd,MAAME,EAAS,IAAIC,gBAAgBC,OAAOC,SAASC,QAC7CC,EAAQL,EAAOM,IAAI,SACnBC,EAAWP,EAAOM,IAAI,YACxBD,GAASE,GACXC,aAAaC,QAAQ,QAASJ,GAC9BG,aAAaC,QAAQ,WAAYF,GACjCC,aAAaC,QAAQ,aAAcF,GACnCC,aAAaC,QAAQ,YAAaF,GAGlCC,aAAaE,WAAW,qBAGxBb,EAAQ,CACNc,KAAMJ,EACNK,MAAOL,EACPA,SAAUA,KAGZM,EAAAA,EAAAA,UAAS,OAGTA,EAAAA,EAAAA,UAAS,aACX,GACC,IACIf,EAAAA,cAAA,WAAK,cAAiB,C","sources":["webpack://Dr.Sai/./src/pages/auth.tsx"],"sourcesContent":["// 接收sso登录的回调，负责保存token和username到本地存储，并跳转到主页\n\nimport * as React from \"react\";\nimport { navigate } from \"gatsby\";\nimport { appContext } from \"../hooks/provider\";\n\n\nconst AuthPage = () => {\n  const { setUser } = React.useContext(appContext);\n  React.useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const token = params.get(\"token\");\n    const username = params.get(\"username\");\n    if (token && username) {\n      localStorage.setItem(\"token\", token);\n      localStorage.setItem(\"username\", username);\n      localStorage.setItem(\"user_email\", username); // 假设username就是email\n      localStorage.setItem(\"user_name\", username);\n\n      // 清除之前的agent选择，确保新用户登录后使用默认agent\n      localStorage.removeItem(\"drsai-mode-config\");\n\n      // 更新用户状态\n      setUser({\n        name: username,\n        email: username,\n        username: username,\n      });\n      // 跳转到主页\n      navigate(\"/\");\n    } else {\n      // 没有参数，跳转到登录\n      navigate(\"/sso-login\");\n    }\n  }, []);\n  return <div>正在登录，请稍候...</div>;\n};\n\nexport default AuthPage;\n"],"names":["AuthPage","setUser","React","appContext","params","URLSearchParams","window","location","search","token","get","username","localStorage","setItem","removeItem","name","email","navigate"],"sourceRoot":""}