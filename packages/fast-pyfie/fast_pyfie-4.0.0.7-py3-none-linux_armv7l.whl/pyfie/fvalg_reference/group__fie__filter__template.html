<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
<title>FIEライブラリ: フィルターテンプレート</title>
<link href="fvalg-prod.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- 作成： Doxygen 1.5.6-FASTSP-p2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">
<h1>フィルターテンプレート<br>
<small>
[<a class="el" href="group__fie__low__level__func.html">低レベル処理関数</a>]</small>
</h1>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>型定義</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g9fd6ac97c318cc805684e88a10027c9c"></a><!-- doxytag: member="fie_filter_template::F_TEMPLATE_FUNC_1x1" ref="g9fd6ac97c318cc805684e88a10027c9c" args=")(VOID *src_pixel, VOID *src_opt_pixel, VOID *dst_pixel, VOID *param)" -->
typedef VOID(FVALGAPI *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g9fd6ac97c318cc805684e88a10027c9c">F_TEMPLATE_FUNC_1x1</a> )(VOID *src_pixel, VOID *src_opt_pixel, VOID *dst_pixel, VOID *param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">コールバック関数のポインタ型（1画素単位フィルターテンプレート） <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g631e7544aa8055d0ab9fe6720ef75bdb"></a><!-- doxytag: member="fie_filter_template::F_TEMPLATE_FUNC_MxN" ref="g631e7544aa8055d0ab9fe6720ef75bdb" args=")(VOID *src_pixel, INT_PTR src_step, VOID *dst_pixel, VOID *param)" -->
typedef VOID(FVALGAPI *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g631e7544aa8055d0ab9fe6720ef75bdb">F_TEMPLATE_FUNC_MxN</a> )(VOID *src_pixel, INT_PTR src_step, VOID *dst_pixel, VOID *param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">コールバック関数のポインタ型（カーネルフィルターテンプレート） <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g56ed106692202c7fdae11d255588db12"></a><!-- doxytag: member="fie_filter_template::F_TEMPLATE_FUNC_P" ref="g56ed106692202c7fdae11d255588db12" args=")(FHANDLE src, FHANDLE src_opt1, FHANDLE src_opt2, FHANDLE dst, VOID *param)" -->
typedef INT(FVALGAPI *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g56ed106692202c7fdae11d255588db12">F_TEMPLATE_FUNC_P</a> )(FHANDLE src, FHANDLE src_opt1, FHANDLE src_opt2, FHANDLE dst, VOID *param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">コールバック関数のポインタ型（既存画像処理関数並列化テンプレート） <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g15f07ecfe2849424a9cf210f9857bdff"></a><!-- doxytag: member="fie_filter_template::F_TEMPLATE_FUNC_CHANNELS" ref="g15f07ecfe2849424a9cf210f9857bdff" args=")(VOID **src_pixels, VOID **dst_pixels, VOID *param)" -->
typedef VOID(FVALGAPI *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g15f07ecfe2849424a9cf210f9857bdff">F_TEMPLATE_FUNC_CHANNELS</a> )(VOID **src_pixels, VOID **dst_pixels, VOID *param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">コールバック関数のポインタ型（複数チャネル対応　1画素単位フィルターテンプレート） <br></td></tr>
<tr><td colspan="2"><br><h2>関数</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g723f384552151d715e3c4adc3360a741">fnFIE_img_filter_template_1x1</a> (FHANDLE hsrc, FHANDLE hsrc_optional, FHANDLE hdst, <a class="el" href="group__fie__filter__template.html#g9fd6ac97c318cc805684e88a10027c9c">F_TEMPLATE_FUNC_1x1</a> pixel_func, VOID *func_param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">1画素単位フィルターテンプレート  <a href="#g723f384552151d715e3c4adc3360a741"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g1536c6809e94b5135ea528269eba0b20">fnFIE_img_filter_template_mxn</a> (FHANDLE hsrc, FHANDLE hdst, <a class="el" href="group__fie__filter__template.html#g631e7544aa8055d0ab9fe6720ef75bdb">F_TEMPLATE_FUNC_MxN</a> pixel_func, VOID *func_param, INT border_left, INT border_top, INT border_right, INT border_bottom, INT border_mode, DOUBLE border_value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">カーネルフィルターテンプレート  <a href="#g1536c6809e94b5135ea528269eba0b20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#gdbb927d0e0479d13b017867733a469f6">fnFIE_img_filter_template_parallel</a> (FHANDLE hsrc, FHANDLE hsrc_optional1, FHANDLE hsrc_optional2, FHANDLE hdst, <a class="el" href="group__fie__filter__template.html#g56ed106692202c7fdae11d255588db12">F_TEMPLATE_FUNC_P</a> block_func, VOID *func_param, INT block_width, INT block_height, INT border_left, INT border_top, INT border_right, INT border_bottom, INT border_mode, DOUBLE border_value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">既存画像処理関数並列化テンプレート  <a href="#gdbb927d0e0479d13b017867733a469f6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__filter__template.html#g6ae4bde3fbc1e7dd447444e940fcd536">fnFIE_filter_template_channels</a> (FHANDLE hsrc, FHANDLE hdst, <a class="el" href="group__fie__filter__template.html#g15f07ecfe2849424a9cf210f9857bdff">F_TEMPLATE_FUNC_CHANNELS</a> pixels_func, VOID *func_param)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">複数チャネル対応　1画素単位フィルターテンプレート  <a href="#g6ae4bde3fbc1e7dd447444e940fcd536"></a><br></td></tr>
</table>
<hr><h2>関数</h2>
<a class="anchor" name="g723f384552151d715e3c4adc3360a741"></a><!-- doxytag: member="fie_filter_template.c::fnFIE_img_filter_template_1x1" ref="g723f384552151d715e3c4adc3360a741" args="(FHANDLE hsrc, FHANDLE hsrc_optional, FHANDLE hdst, F_TEMPLATE_FUNC_1x1 pixel_func, VOID *func_param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_img_filter_template_1x1           </td>
          <td>(</td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc_optional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hdst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__fie__filter__template.html#g9fd6ac97c318cc805684e88a10027c9c">F_TEMPLATE_FUNC_1x1</a>&nbsp;</td>
          <td class="paramname"> <em>pixel_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VOID *&nbsp;</td>
          <td class="paramname"> <em>func_param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
1画素単位フィルターテンプレート 
<p>
入出力画像の同じ座標の画素だけを参照した1画素単位の空間フィルタを実施します。 フィルタの内容はユーザーが引数 <em>pixel_func</em> で自由に指定できます。<p>
入出力画像は下記の条件を満たしていなければなりません。 <ul>
<li>幅、高さ、チャネル数が等しい </li>
<li>いずれの画像も二値画像ではない</li>
</ul>
<dl class="user" compact><dt><b>単一ピクセル処理関数 <em>pixel_func</em> </b></dt><dd>単一ピクセル処理関数 <em>pixel_func</em> は、出力画像の各画素で呼び出されて処理をする関数で、ユーザーが指定します。 <br>
 この関数 <em>pixel_func</em> は次の型で定義します。 <div class="fragment"><pre class="fragment">     VOID (FVALGAPI *pixel_func)( VOID *src_pixel, VOID *src_opt_pixel, VOID *dst_pixel, VOID *param );
</pre></div> 本関数は出力画像の全てのピクセルにおいて、入力画像で対応する座標にあるピクセルのポインタを <em>pixel_func</em> に渡して呼び出します。 <em>hsrc</em> の画素は src_pixel, <em>hsrc_optional</em> の画素は src_opt_pixel, <em>hdst</em> の画素は dst_pixel に渡されます。 また <em>func_param</em> は param にそのまま渡されます。</dd></dl>
<dl class="user" compact><dt><b>引数 <em>pixel_func</em> に与える単一ピクセル処理関数の実装例</b></dt><dd><div class="fragment"><pre class="fragment">     VOID myfunc( VOID *src, VOID *src_opt, VOID *dst, VOID *param ){
         UCHAR *ps = (UCHAR*)src;
         INT *ps_opt = (INT*)src_opt;
         DOUBLE *pd = (DOUBLE*)dst;
         MYSTRUCT *pstruct = (MYSTRUCT*)param;
         *pd = ( *ps_opt - *ps / pstruct-&gt;alpha ) + pstruct-&gt;beta;
     }
</pre></div></dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc</em>&nbsp;</td><td>入力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc_optional</em>&nbsp;</td><td>入力画像ハンドル　必要なければNULLを渡してください。その際は <em>pixel_func</em> の第2引数にアクセスしないでください。 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>hdst</em>&nbsp;</td><td>出力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pixel_func</em>&nbsp;</td><td>1ピクセルだけ処理する内容を記述した関数の関数ポインタ </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>func_param</em>&nbsp;</td><td>オプションパラメータ 各画素で <em>pixel_func</em> が実行される際に参照できます。必要がなければNULLを渡してください</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>入力画像異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>パラメータ異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>覚え書き:</b></dt><dd><ul>
<li><em>pixel_func</em> の記述内容によっては入力画像への書き込みや画像外へのメモリアクセスが可能なので注意してください。</li><li><em>pixel_func</em> で想定した画像型と与えた画像型が異なる場合でも検知してエラー終了することができずに実行してしまい、 異常な結果出力や領域外アクセスが発生しますので注意してください。</li><li><em>param</em> 内に値を書き込む場合、スレッドセーフになるような <em>pixel_func</em> でなければ正しい値になりませんので注意してください。 </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="g1536c6809e94b5135ea528269eba0b20"></a><!-- doxytag: member="fie_filter_template.c::fnFIE_img_filter_template_mxn" ref="g1536c6809e94b5135ea528269eba0b20" args="(FHANDLE hsrc, FHANDLE hdst, F_TEMPLATE_FUNC_MxN pixel_func, VOID *func_param, INT border_left, INT border_top, INT border_right, INT border_bottom, INT border_mode, DOUBLE border_value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_img_filter_template_mxn           </td>
          <td>(</td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hdst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__fie__filter__template.html#g631e7544aa8055d0ab9fe6720ef75bdb">F_TEMPLATE_FUNC_MxN</a>&nbsp;</td>
          <td class="paramname"> <em>pixel_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VOID *&nbsp;</td>
          <td class="paramname"> <em>func_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DOUBLE&nbsp;</td>
          <td class="paramname"> <em>border_value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
カーネルフィルターテンプレート 
<p>
出力画像の各ピクセルに対し、入力画像で上下左右に範囲を持ったアクセスを行うカーネルフィルタに類似した空間フィルタを実施します。 フィルタの内容はユーザーが引数 <em>pixel_func</em> で自由に指定できます。<p>
入出力画像は下記の条件を満たしていなければなりません。 <ul>
<li>幅、高さ、チャネル数が等しい </li>
<li>いずれの画像も二値画像ではない </li>
<li><em>hsrc</em> が <a class="el" href="group__fie__std__operation.html#g0b20a28445e52bb01ae893baff7c3b94" title="画像のボーダーを拡張する">fnFIE_copy_border()</a> で処理可能な画像型である</li>
</ul>
<em>pixel_func</em> は出力画像の各画素と同一座標を持つ入力画像の画素から上下左右へアクセスするため、ボーダー処理モードが F_BORDER_NONE の時、出力画像の周囲における該当範囲は処理されず元の値を維持します。 それ以外のボーダー処理モードの時、入力画像を指定のモードでボーダー拡張しフィルタ処理を施します。 この時、出力画像の領域全面でフィルタ処理結果が得られます。 ボーダー拡張の詳細な仕様は <a class="el" href="group__fie__std__operation.html#g0b20a28445e52bb01ae893baff7c3b94" title="画像のボーダーを拡張する">fnFIE_copy_border()</a> を参照して下さい。<p>
<dl class="user" compact><dt><b>フィルタカーネル関数 <em>pixel_func</em> </b></dt><dd>フィルタカーネル関数 <em>pixel_func</em> は、出力画像の各画素で呼び出されて処理をする関数で、ユーザーが指定します。 <br>
 この関数 <em>pixel_func</em> は次の型で定義します。 <div class="fragment"><pre class="fragment">    VOID (FVALGAPI *pixel_func)( VOID *src_pixel, INT_PTR step, VOID *dst_pixel, VOID *param );
</pre></div> 本関数は出力画像の全てのピクセルにおいて、入力画像で対応する座標にあるピクセルのポインタを <em>pixel_func</em> に渡して呼び出します。 <em>hsrc</em> の画素は src_pixel, <em>hdst</em> の画素は dst_pixel に渡されます。 入力画像のステップサイズは画素単位で引数 step に渡されます。 また、 <em>func_param</em> は param にそのまま渡されます。 </dd></dl>
<dl class="user" compact><dt><b>引数 <em>pixel_func</em> に与えるフィルタカーネル関数の例</b></dt><dd><div class="fragment"><pre class="fragment">    VOID myfunc( VOID *src, INT_PTR step_src, VOID *dst, VOID *param ){
        INT x, y;
        DOUBLE sum = 0;
        UCHAR *ps = (UCHAR*)src;
        DOUBLE *pd = (DOUBLE*)dst;
        MYSTRUCT *pstruct = (MYSTRUCT*)param;

        <span class="keywordflow">for</span>( y = -1; y &lt;= 1; y++ ){
            <span class="keywordflow">for</span>( x = -2; x &lt;= 2; x++ ){
                sum += *( ps + y * step_src + x );
            }
        }
        *pd = ( sum * pstruct-&gt;alpha ) + pstruct-&gt;beta;
    }
</pre></div> フィルタカーネル関数内で上下左右にアクセスした範囲によって、実質的なフィルタのアンカー位置が決まります。 またアクセス範囲を <em>border_left</em> などに反映することで、領域外アクセスすることなく上記フィルタカーネル関数を適用できます。</dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc</em>&nbsp;</td><td>入力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>hdst</em>&nbsp;</td><td>出力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pixel_func</em>&nbsp;</td><td>1ピクセルだけ処理する内容を記述した関数の関数ポインタ </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>func_param</em>&nbsp;</td><td>オプションパラメータ 各画素で <em>pixel_func</em> が実行される際に参照できます。必要がなければNULLを渡してください </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_left</em>&nbsp;</td><td><em>pixel_func</em> が左方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_top</em>&nbsp;</td><td><em>pixel_func</em> が上方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_right</em>&nbsp;</td><td><em>pixel_func</em> が右方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_bottom</em>&nbsp;</td><td><em>pixel_func</em> が下方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_mode</em>&nbsp;</td><td>ボーダー処理モード<ul>
<li>F_BORDER_NONE ボーダー拡張しない</li><li>F_BORDER_ZERO ０埋めモード</li><li>F_BORDER_VALUE 一定値モード</li><li>F_BORDER_CONTINUOUS 端延長モード</li><li>F_BORDER_REPEAT 繰り返しモード</li><li>F_BORDER_MIRROR1 反転モード１</li><li>F_BORDER_MIRROR2 反転モード２ </li></ul>
</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_value</em>&nbsp;</td><td>ボーダー濃度値。 <em>border_mode</em> が F_BORDER_VALUE の場合のみ使用されます。 その他のモードの場合は、この値は無視されます。</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>入力画像異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>パラメータ異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NOMEMORY</em>&nbsp;</td><td>メモリ不足 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>覚え書き:</b></dt><dd><ul>
<li><em>pixel_func</em> の記述内容によっては入力画像への書き込みや画像外へのメモリアクセスが可能なので注意してください。</li><li><em>pixel_func</em> で想定した画像型と与えた画像型が異なる場合でも検知してエラー終了することができずに実行してしまい、 異常な結果出力や領域外アクセスが発生しますので注意してください。</li><li><em>param</em> 内に値を書き込む場合、スレッドセーフになるような <em>pixel_func</em> でなければ正しい値になりませんので注意してください。 </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="gdbb927d0e0479d13b017867733a469f6"></a><!-- doxytag: member="fie_filter_template.c::fnFIE_img_filter_template_parallel" ref="gdbb927d0e0479d13b017867733a469f6" args="(FHANDLE hsrc, FHANDLE hsrc_optional1, FHANDLE hsrc_optional2, FHANDLE hdst, F_TEMPLATE_FUNC_P block_func, VOID *func_param, INT block_width, INT block_height, INT border_left, INT border_top, INT border_right, INT border_bottom, INT border_mode, DOUBLE border_value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_img_filter_template_parallel           </td>
          <td>(</td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc_optional1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc_optional2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hdst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__fie__filter__template.html#g56ed106692202c7fdae11d255588db12">F_TEMPLATE_FUNC_P</a>&nbsp;</td>
          <td class="paramname"> <em>block_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VOID *&nbsp;</td>
          <td class="paramname"> <em>func_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>block_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>block_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>border_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DOUBLE&nbsp;</td>
          <td class="paramname"> <em>border_value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
既存画像処理関数並列化テンプレート 
<p>
既存のFIE画像オブジェクトを扱うシングルスレッドの空間フィルタを利用して並列処理するテンプレートです。 入出力画像を指定したサイズのブロックに分割し、フィルタを各ブロックごとに並列に適応します。 フィルタの内容はユーザーが引数 <em>block_func</em> で自由に指定できます。<p>
入出力画像は下記の条件を満たしていなければなりません。 <ul>
<li><em>block_func</em> で処理できる組み合わせである </li>
<li>入力画像が <a class="el" href="group__fie__std__operation.html#g0b20a28445e52bb01ae893baff7c3b94" title="画像のボーダーを拡張する">fnFIE_copy_border()</a> で処理可能な画像型である </li>
<li>全ての画像で縦横サイズが同じ </li>
<li>入力画像と出力画像は重なっていない</li>
</ul>
当関数に与えるボーダー処理モードが F_BORDER_NONE の時、出力画像の周囲(上側 <em>border_top</em>, 下側 <em>border_bottom</em>, 左側 <em>border_left</em>, 右側 <em>border_right</em> の範囲)は処理されず元の値を維持します。 それ以外のボーダー処理モードの時、入力画像を指定のモードでボーダー拡張しフィルタ処理を施します。 この時、出力画像の領域全面でフィルタ処理結果が得られます。 ボーダー拡張の詳細な仕様は <a class="el" href="group__fie__std__operation.html#g0b20a28445e52bb01ae893baff7c3b94" title="画像のボーダーを拡張する">fnFIE_copy_border()</a> を参照して下さい。<p>
<dl class="user" compact><dt><b>ユーザー定義フィルタ関数 <em>block_func</em> </b></dt><dd><em>block_func</em> は、出力画像を <em>block_width</em> × <em>block_height</em> のサイズに区切った少さな画像領域ごとに呼び出されて処理をする関数で、ユーザーが指定します。 <br>
 この関数 <em>block_func</em> は次の型で定義します。 <div class="fragment"><pre class="fragment">    INT (FVALGAPI *block_func)( FHANDLE src_image, FHANDLE src_image_optional_1, FHANDLE src_image_optional_2, FHANDLE dst_image, VOID *param );
</pre></div> 全てのブロックが F_ERR_NONE を回答した場合にのみ当関数は F_ERR_NONE を返し、ひとつでも F_ERR_NONE でなければその戻り値を返します。複数のブロックがそれぞれ異なる値を返した場合でも、いずれかひとつだけを返します。</dd></dl>
<dl class="user" compact><dt><b><em>block_func</em> の注意点</b></dt><dd><ul>
<li><em>block_func</em> は当関数を通さず直接入出力画像を渡した際に正常に処理できる必要があります。</li><li><em>block_func</em> の記述内容によっては入力画像への書き込みや画像外へのメモリアクセスが可能なので注意してください。</li><li><em>block_func</em> がスレッドセーフでないと、正常な結果が得られず出力画像が異常になるなどの可能性があります。</li><li><em>block_func</em> 内部で並列化を行っていると、当関数で並列化した場合パフォーマンスが充分に向上しなかったり悪化したりします。</li><li><em>block_func</em> の画像出力範囲が当関数のborder関連引数と異なる場合、出力画像が異常になったり画像外へメモリアクセスしたりするので注意してください。 <em>block_func</em> 内部が F_BORDER_NONE 相当の処理でなければ出力画像が異常になる可能性があります。 つまり、出力画像の周囲(上側 <em>border_top</em>, 下側 <em>border_bottom</em>, 左側 <em>border_left</em>, 右側 <em>border_right</em> の範囲)は処理せず元の値を維持しなければなりません。 また、入出力画像で全て同じ位置の画素のみ参照するならborder関連引数は全てゼロでなければなりません。</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>引数 <em>block_func</em> に与えるフィルタ関数の例</b></dt><dd><div class="fragment"><pre class="fragment">    INT FVALGAPI myfunc( FHANDLE src, FHANDLE opt1, FHANDLE opt2, FHANDLE dst, VOID *param ){
        INT *p  = (INT*)param;
        <span class="keywordflow">return</span> <a class="code" href="group__fie__filter.html#g946bc69fe30c2c51d730bf1a2ddcc86c" title="平均化フィルタ(M×N)">fnFIE_averageMxN</a>( src, dst, p[0], p[1], <a class="code" href="group__fie__std__operation.html#gg5d19240b9c8e02c83b5d8b40540ecd4f485fa63ed437a605b6fd5ed01bf68b9b" title="ボーダー処理無し">F_BORDER_NONE</a>, 0 );
    }
</pre></div> <div class="fragment"><pre class="fragment">    INT FVALGAPI myfunc2( FHANDLE src, FHANDLE opt1, FHANDLE opt2, FHANDLE dst, VOID *param ){
        <span class="keywordflow">return</span>  <a class="code" href="group__fie__filter__arithm.html#g2255a4f4f70182fff285f8d912dd74ab" title="画像間逆正接演算">fnFIE_img_atan2</a>( src, opt1, dst );
    }
</pre></div></dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc</em>&nbsp;</td><td>入力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc_optional1</em>&nbsp;</td><td>入力画像ハンドル 必要なければNULLを渡してください </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc_optional2</em>&nbsp;</td><td>入力画像ハンドル 必要なければNULLを渡してください </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>hdst</em>&nbsp;</td><td>出力画像ハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>block_func</em>&nbsp;</td><td>並列化したい画像フィルタを記述したユーザー定義フィルタ関数の関数ポインタ </td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>func_param</em>&nbsp;</td><td>オプションパラメータ 各画素で <em>block_func</em> が実行される際に参照できます。必要がなければNULLを渡してください </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>block_width</em>&nbsp;</td><td>並列化する際、各々のスレッドが処理する幅(pixel) 1以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>block_height</em>&nbsp;</td><td>並列化する際、各々のスレッドが処理する高さ(pixel) 1以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_left</em>&nbsp;</td><td><em>block_func</em> が左方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_top</em>&nbsp;</td><td><em>block_func</em> が上方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_right</em>&nbsp;</td><td><em>block_func</em> が右方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_bottom</em>&nbsp;</td><td><em>block_func</em> が下方向にアクセスするサイズ。ゼロ以上を指定してください。 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_mode</em>&nbsp;</td><td>ボーダー処理モード<ul>
<li>F_BORDER_NONE ボーダー拡張しない</li><li>F_BORDER_ZERO ０埋めモード</li><li>F_BORDER_VALUE 一定値モード</li><li>F_BORDER_CONTINUOUS 端延長モード</li><li>F_BORDER_REPEAT 繰り返しモード</li><li>F_BORDER_MIRROR1 反転モード１</li><li>F_BORDER_MIRROR2 反転モード２ </li></ul>
</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>border_value</em>&nbsp;</td><td>ボーダー濃度値。 <em>border_mode</em> が F_BORDER_VALUE の場合のみ使用されます。 その他のモードの場合は、この値は無視されます。</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>入力画像異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>パラメータ異常 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NOMEMORY</em>&nbsp;</td><td>メモリ不足 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g6ae4bde3fbc1e7dd447444e940fcd536"></a><!-- doxytag: member="fie_filter_template_channels.c::fnFIE_filter_template_channels" ref="g6ae4bde3fbc1e7dd447444e940fcd536" args="(FHANDLE hsrc, FHANDLE hdst, F_TEMPLATE_FUNC_CHANNELS pixels_func, VOID *func_param)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_filter_template_channels           </td>
          <td>(</td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hdst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__fie__filter__template.html#g15f07ecfe2849424a9cf210f9857bdff">F_TEMPLATE_FUNC_CHANNELS</a>&nbsp;</td>
          <td class="paramname"> <em>pixels_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VOID *&nbsp;</td>
          <td class="paramname"> <em>func_param</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
複数チャネル対応　1画素単位フィルターテンプレート 
<p>
入出力画像の同じ座標で各チャネル1画素を参照した、1座標単位の画像変換を行います。<br>
 変換内容はユーザーが引数<em>pixels_func</em> で自由に指定できます。<p>
入力画像と出力画像は下記の条件を満たしている必要があります。 <ul>
<li>幅、高さが等しい (※チャネル数は異なっても可) </li>
<li>いずれの画像も二値画像ではない</li>
</ul>
<dl class="user" compact><dt><b>1座標処理関数 <em>pixels_func</em> </b></dt><dd>1座標処理関数 <em>pixels_func</em> は、入出力画像の各画素で呼び出されて処理をする関数で、ユーザーが指定します。 <br>
 この関数 <em>pixels_func</em> は次の型で定義します。 <div class="fragment"><pre class="fragment">    VOID( FVALGAPI * pixels_func )(VOID **src_pixels, VOID **dst_pixels, VOID *param);
</pre></div> 本関数は出力画像の画素において、入力画像で対応する画素のポインタを <em>pixels_func</em> に渡して呼び出します。<br>
 <em>hsrc</em> の画素は src_pixels, <em>hdst</em> の画素は dst_pixels に渡され、 <em>func_param</em> は param に渡されます。 また、src_pixelsとdst_pixelsに渡されるポインタは、入出力画像それぞれ、チャネル0のポインタから順にリストされています。(チャネル：0,1,2...)</dd></dl>
<dl class="user" compact><dt><b>引数 <em>pixels_func</em> に与える処理関数の実装例</b></dt><dd><div class="fragment"><pre class="fragment">    VOID FVALGAPI myfunc( VOID **src, VOID **dst, VOID *param )
    {
        UCHAR **ps = (UCHAR**)src;
        DOUBLE **pd = (DOUBLE**)dst;
        MYSTRUCT *pstruct = (MYSTRUCT*)param;
        *pd[0] = *ps[0] * pstruct-&gt;a  + *ps[1] * pstruct-&gt;b   + *ps[2] * pstruct-&gt;c;
        *pd[1] = *ps[0] * pstruct-&gt;a*2+ *ps[1] * pstruct-&gt;b*2 + *ps[2] * pstruct-&gt;c*2;
        *pd[2] = *ps[0] * pstruct-&gt;a*3+ *ps[1] * pstruct-&gt;b*3 + *ps[2] * pstruct-&gt;c*3;
    }
</pre></div></dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc</em>&nbsp;</td><td>入力画像のハンドル </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>hdst</em>&nbsp;</td><td>出力画像のハンドル </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pixels_func</em>&nbsp;</td><td>1ピクセルだけ処理する内容を記述した関数の関数ポインタ </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>func_param</em>&nbsp;</td><td>オプションパラメータ 各画素で <em>pixels_func</em> が実行される際に参照できます。必要がなければNULLを渡してください</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>不正な画像オブジェクトが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>不正なパラメータが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>覚え書き:</b></dt><dd><ul>
<li><em>pixels_func</em> の記述内容によっては入力画像への書き込みや画像外へのメモリアクセスが可能なので注意してください。</li><li><em>pixels_func</em> で想定した画像型と与えた画像型が異なる場合でも検知してエラー終了することができずに実行してしまい、 異常な結果出力や領域外アクセスが発生しますので注意してください。</li><li><em>param</em> 内に値を書き込む場合、スレッドセーフになるような <em>pixels_func</em> でなければ正しい値になりませんので注意してください。 </li></ul>
</dd></dl>

</div>
</div><p>
</div>
<hr size="1">
<address style="align: right; color: #cccccc;">
	<small>
	Documentation copyright &copy; 2009-2025 TOKYO ELECTRON DEVICE LIMITED. <br>
	Generated on Tue Sep 16 09:08:53 2025 for FIEライブラリ by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.5.6-FASTSP-p2
	</small>
</address>
</body>
</html>
