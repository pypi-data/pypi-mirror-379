<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
<title>FIEライブラリ: コーナー抽出</title>
<link href="fvalg-prod.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- 作成： Doxygen 1.5.6-FASTSP-p2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">
<h1>コーナー抽出<br>
<small>
[<a class="el" href="group__fie__vtool.html">ビジョンツール</a>]</small>
</h1>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>関数</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__corner__extraction.html#g7526698c39e87ef553a24319a185b8ae">fnFIE_aligned_corner_extraction</a> (const FHANDLE fim, <a class="el" href="structBOX__T.html">BOX_T</a> roi_horz, <a class="el" href="structBOX__T.html">BOX_T</a> roi_vert, DOUBLE delta_angle, INT filter_size, <a class="el" href="structDLINE__T.html">DLINE_T</a> *line_horz_out, <a class="el" href="structDLINE__T.html">DLINE_T</a> *line_vert_out, <a class="el" href="structDPNT__T.html">DPNT_T</a> *pnt_out)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">指定された画像領域から縦・横線を検出し交点を抽出します  <a href="#g7526698c39e87ef553a24319a185b8ae"></a><br></td></tr>
</table>
<hr><h2>関数</h2>
<a class="anchor" name="g7526698c39e87ef553a24319a185b8ae"></a><!-- doxytag: member="fie_corner_extraction.c::fnFIE_aligned_corner_extraction" ref="g7526698c39e87ef553a24319a185b8ae" args="(const FHANDLE fim, BOX_T roi_horz, BOX_T roi_vert, DOUBLE delta_angle, INT filter_size, DLINE_T *line_horz_out, DLINE_T *line_vert_out, DPNT_T *pnt_out)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_aligned_corner_extraction           </td>
          <td>(</td>
          <td class="paramtype">const FHANDLE&nbsp;</td>
          <td class="paramname"> <em>fim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBOX__T.html">BOX_T</a>&nbsp;</td>
          <td class="paramname"> <em>roi_horz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structBOX__T.html">BOX_T</a>&nbsp;</td>
          <td class="paramname"> <em>roi_vert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DOUBLE&nbsp;</td>
          <td class="paramname"> <em>delta_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>filter_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDLINE__T.html">DLINE_T</a> *&nbsp;</td>
          <td class="paramname"> <em>line_horz_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDLINE__T.html">DLINE_T</a> *&nbsp;</td>
          <td class="paramname"> <em>line_vert_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDPNT__T.html">DPNT_T</a> *&nbsp;</td>
          <td class="paramname"> <em>pnt_out</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
指定された画像領域から縦・横線を検出し交点を抽出します 
<p>
画像 <em>fim</em> から　<em>roi_horz</em> で指定された領域内の横線を抽出し、 <em>roi_vert</em> で指定された領域内の縦線を抽出し、線の交点を <em>pnt_out</em> で出力します。 横線の直線係数が <em>line_horz_out</em>, 縦線の直線係数が <em>line_vert_out</em> で出力されます。 横線と縦線の直線係数は, <a class="el" href="structDLINE__T.html#843627b1c9487f5c0c4d8e9d4b4967f9">DLINE_T::a</a> ^2 + <a class="el" href="structDLINE__T.html#3ec969ff611b0a432765918c7600c292">DLINE_T::b</a> ^2 = 1　を満たします。<p>
抽出される横・縦線の間の角度を　<em>delta_angle</em> でラジアン単位で指定します。 縦線の角度は、横線の角度に <em>delta_angle</em> を足した角度となります。<p>
各領域内の線抽出に使われるフィルタサイズ（３以上の奇数、推奨値：１１以上）を　<em>filter_size</em> で渡します。<p>
各領域のＸ座標が [ 0, 画像横サイズ-1 ], Ｙ座標が [ 0, 画像縦サイズ-1 ] 以内でなければなりません。<p>
本関数は、エッジの極性を無視します。そのため： <ul>
<li>出力される直線係数は (a,b,c) か (-a,-b,-c) かは不定です。 但し、直線係数の正負が不定でも、表された線と線の交点は変わりません。 </li>
<li>入力画像のコントラストを逆転しても、抽出される交点が変わりません。 </li>
<li><em>delta_angle</em> に <img class="formulaInl" alt="$ \alpha $" src="form_569.png"> を指定する事と PI - <img class="formulaInl" alt="$ \alpha $" src="form_569.png"> を指定する事が同じ意味です。 </li>
<li>一つの四角の一つのコーナーの抽出が可能です。更に、 チェスボードの様に二つの四角が一つのコーナーで接しているコーナーの抽出も可能です。</li>
</ul>
<dl class="warning" compact><dt><b>警告:</b></dt><dd>各領域内に抽出したい線以外にノイズや他の線や他の特徴が入っている場合は、本関数が正常終了しても 返ってくる結果が想定される結果と異なる場合があります。横線抽出ROIに横線以外出来るだけ他に何も 含まれていない様に、そして縦線抽出ROIに縦線以外に出来るだけ他に何も含まれていない様に、 各ROIを設定してください。<br>
 出来るだけ横線の抽出ROIと縦線の抽出ROIが重ならない様に、または重なる面積が出来るだけ小さい様に、 ROIを設定してください。</dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fim</em>&nbsp;</td><td>入力画像( 1 channel, UC8 ) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>roi_horz</em>&nbsp;</td><td>横線を検出する画像領域 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>roi_vert</em>&nbsp;</td><td>縦線を検出する画像領域 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>delta_angle</em>&nbsp;</td><td>横線と縦線の間の角度（単位：ラジアン）。<br>
 縦線の角度＝横線の角度＋<em>delta_angle</em> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>filter_size</em>&nbsp;</td><td>エッジ抽出フィルターのサイズ。３以上の奇数でなければなりません。 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>line_horz_out</em>&nbsp;</td><td>抽出された横線<br>
 不要な場合は NULL を指定可能です。 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>line_vert_out</em>&nbsp;</td><td>抽出された縦線<br>
 不要な場合は NULL を指定可能です。 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pnt_out</em>&nbsp;</td><td>抽出された交点<br>
 不要な場合は NULL を指定可能です。</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NOMEMORY</em>&nbsp;</td><td>メモリ不足エラー </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>パラメータ不正エラー </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>画像オブジェクトエラー </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_CALC_IMPOSSIBLE</em>&nbsp;</td><td>計算不能エラー </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー</td></tr>
  </table>
</dl>
<dl class="user" compact><dt><b>処理例:</b></dt><dd><table class="layoutTable">
<tr>
<td><div align="center">
<img src="fie_aligned_corner_extraction1.png" alt="fie_aligned_corner_extraction1.png">
<p><strong><em>delta_angle</em> = 90度の例。赤：横線ROI. 青：縦線ROI. 緑：コーナー</strong></p></div>
   </td></tr>
<tr>
<td><div align="center">
<img src="fie_aligned_corner_extraction2.png" alt="fie_aligned_corner_extraction2.png">
<p><strong><em>delta_angle</em> = 170度の例。赤：横線ROI. 青：縦線ROI. 緑：コーナー</strong></p></div>
   </td></tr>
<tr>
<td><div align="center">
<img src="fie_aligned_corner_extraction3.png" alt="fie_aligned_corner_extraction3.png">
<p><strong>チェスボードコーナー抽出の例。赤：横線ROI. 青：縦線ROI. 緑：コーナー</strong></p></div>
   </td></tr>
</table>
</dd></dl>

</div>
</div><p>
</div>
<hr size="1">
<address style="align: right; color: #cccccc;">
	<small>
	Documentation copyright &copy; 2009-2025 TOKYO ELECTRON DEVICE LIMITED. <br>
	Generated on Tue Sep 16 09:08:52 2025 for FIEライブラリ by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.5.6-FASTSP-p2
	</small>
</address>
</body>
</html>
