<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=Shift_JIS">
<title>FIEライブラリ: 色票計算</title>
<link href="fvalg-prod.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- 作成： Doxygen 1.5.6-FASTSP-p2 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">
<h1>色票計算<br>
<small>
[<a class="el" href="group__fie__color__inspection.html">色彩検査</a>]</small>
</h1>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>関数</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__color__chart.html#g0ef2472d9f928879056ddfb4ac03dd3c">fnFIE_colorchart_calc_image</a> (const FHANDLE hsrc, const FHANDLE hmask, <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *chart)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">色票の計算（画像指定）  <a href="#g0ef2472d9f928879056ddfb4ac03dd3c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__color__chart.html#g7b350049a3dcf5a9e525c557557ba088">fnFIE_colorchart_set_color</a> (const DOUBLE *color, <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *chart)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">色票の計算（色指定）  <a href="#g7b350049a3dcf5a9e525c557557ba088"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">INT FVALGAPI&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fie__color__chart.html#gced9ea056206b2c20dca0211873c85dd">fnFIE_colorchart_calc_norm</a> (const <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *right, const <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *target, DOUBLE *norm, enum <a class="el" href="group__fie__color__inspection__doc.html#gd5a3cc17e83ecb6e72dd1bb70c67c371">f_colorcheck_norm_type</a> norm_type, const DOUBLE *weight)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">色票間のノルム計算  <a href="#gced9ea056206b2c20dca0211873c85dd"></a><br></td></tr>
</table>
<hr><h2>関数</h2>
<a class="anchor" name="g0ef2472d9f928879056ddfb4ac03dd3c"></a><!-- doxytag: member="fie_colorchart.c::fnFIE_colorchart_calc_image" ref="g0ef2472d9f928879056ddfb4ac03dd3c" args="(const FHANDLE hsrc, const FHANDLE hmask, F_COLOR_CHART *chart)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_colorchart_calc_image           </td>
          <td>(</td>
          <td class="paramtype">const FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const FHANDLE&nbsp;</td>
          <td class="paramname"> <em>hmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *&nbsp;</td>
          <td class="paramname"> <em>chart</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
色票の計算（画像指定） 
<p>
入力画像の処理対象領域より、色票を計算します。 色票とは、処理対象領域の特徴量をまとめたものです。<p>
<dl class="user" compact><dt><b>処理対象領域</b></dt><dd>処理対象領域は、入力画像全体となります。 矩形の処理対象領域を設定したい場合は、FIE画像のチャイルド画像を利用します。 自由形状の処理対象領域を設定したい場合、マスクを設定してください。マスクが必要ない場合は、NULLを指定します。 なお、処理対象領域は２画素以上の領域が必要となります。 例えば、マスク処理により処理対象領域が２画素未満の場合は、 F_ERR_CALC_IMPOSSIBLE が返されます。</dd></dl>
<dl class="user" compact><dt><b>処理対象領域の定義</b></dt><dd>処理対象領域の例を、下図に示します。 処理対象領域は、同一考えられる領域を設定する必要があります。 下図の１〜３の領域が正しく設定された処理対象領域です。 ４〜６の領域のように、複数の色が設定されている場合は、色票間のノルム計算や色抽出の正しい結果を得ることができません。 ただしユーザーが、処理対象領域が同一色かどうかなどの検査等の場合は、その限りではありません。</dd></dl>
<div align="center">
<img src="colorchart_roi.png" alt="colorchart_roi.png">
</div>
<p>
<dl class="user" compact><dt><b>マスク</b></dt><dd>マスクは、画素タイプが F_IMG_BIN 、チャネル数が１のFIE画像、またはリージョンで指定します。 マスクがFIE画像の場合、入力画像とサイズが同じ必要があります。 マスクがリージョンの場合、座標の最大値、最小値は入力画像の範囲内に含まれている必要があります。 マスクが必要ない場合は、NULLを指定してください。</dd></dl>
<dl class="user" compact><dt><b>フラグ</b></dt><dd>すべてのチャネルの３σが１以上の場合、F_COLOR_CHART_VALID_MAHALANOBIS フラグが有効になります。 それ以外では、本色票を基準としてマハラノビスノルムを計算することができません。 なお、分散共分散行列が計算されるため、 F_COLOR_CHART_CALCULATED_VARIANCE フラグは有効になります。</dd></dl>
<dl class="user" compact><dt><b>使用例</b></dt><dd><a class="el" href="group__fie__color__chart.html#gced9ea056206b2c20dca0211873c85dd" title="色票間のノルム計算">fnFIE_colorchart_calc_norm()</a> を参照してください。</dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hsrc</em>&nbsp;</td><td>入力画像（type:uc8,us16,double, ch:3） </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hmask</em>&nbsp;</td><td>マスクオブジェクト（type:bin, ch:1の画像、またはリージョン） </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>chart</em>&nbsp;</td><td>色票</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>不正な画像オブジェクトが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_OBJECT</em>&nbsp;</td><td>不正なオブジェクトが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>不正なパラメータが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_CALC_IMPOSSIBLE</em>&nbsp;</td><td>処理領域不足のため計算不能 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g7b350049a3dcf5a9e525c557557ba088"></a><!-- doxytag: member="fie_colorchart.c::fnFIE_colorchart_set_color" ref="g7b350049a3dcf5a9e525c557557ba088" args="(const DOUBLE *color, F_COLOR_CHART *chart)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_colorchart_set_color           </td>
          <td>(</td>
          <td class="paramtype">const DOUBLE *&nbsp;</td>
          <td class="paramname"> <em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *&nbsp;</td>
          <td class="paramname"> <em>chart</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
色票の計算（色指定） 
<p>
指定した色情報が保持されます。 本関数は、ユーザーが指定した任意の色情報を色票に設定します。 分散共分散行列は計算されません。<p>
<dl class="user" compact><dt><b>色情報</b></dt><dd>色情報は、要素数３の配列で指定します。 ３未満の配列を指定した場合の動作は保証しません。 以下に、具体的にいくつかのパラメータについて説明します。</dd></dl>
<dl class="user" compact><dt><b>フラグ</b></dt><dd>分散共分散行列は計算されません。 F_CC_CALCULATED_VARIANCE 、 F_CC_VALID_MAHALANOBIS 共に無効となります。</dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>color</em>&nbsp;</td><td>色情報 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>chart</em>&nbsp;</td><td>色票</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>不正なパラメータが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="gced9ea056206b2c20dca0211873c85dd"></a><!-- doxytag: member="fie_colorchart.c::fnFIE_colorchart_calc_norm" ref="gced9ea056206b2c20dca0211873c85dd" args="(const F_COLOR_CHART *right, const F_COLOR_CHART *target, DOUBLE *norm, enum f_colorcheck_norm_type norm_type, const DOUBLE *weight)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT FVALGAPI fnFIE_colorchart_calc_norm           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *&nbsp;</td>
          <td class="paramname"> <em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structF__COLOR__CHART.html">F_COLOR_CHART</a> *&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DOUBLE *&nbsp;</td>
          <td class="paramname"> <em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__fie__color__inspection__doc.html#gd5a3cc17e83ecb6e72dd1bb70c67c371">f_colorcheck_norm_type</a>&nbsp;</td>
          <td class="paramname"> <em>norm_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DOUBLE *&nbsp;</td>
          <td class="paramname"> <em>weight</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
色票間のノルム計算 
<p>
色票間のノルムを計算します。 ノルムの詳細は、 <a class="el" href="group__fie__color__inspection__doc.html#gd5a3cc17e83ecb6e72dd1bb70c67c371">f_colorcheck_norm_type</a> を参照ください。<p>
<dl class="user" compact><dt><b>ノルムタイプ</b></dt><dd>マハラノビスノルムの計算は、基準色票の F_CC_VALID_MAHALANOBIS フラグが有効である必要があります。 マハラノビスノルムが計算できない場合は <em>norm</em> に−１が代入されます。 それ以外のノルムの計算で−１が代入される場合はありません。</dd></dl>
<dl class="user" compact><dt><b>重み付きユークリッドノルムの重み係数 <em>weight</em> は、重み付きユークリッドノルムの計算に使用されます。</b></dt><dd>それ以外のノルムでは指定しても使用されません。重みによっては計算不能となることがあります。 通常はNULLを指定します。 ただし、NULL以外を指定してもエラーにはなりません。 要素数３の配列を指定します。 ３未満の配列を指定した場合の動作は保証しません。</dd></dl>
<dl compact><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>right</em>&nbsp;</td><td>基準色票 </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>target</em>&nbsp;</td><td>対象色票 </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>norm</em>&nbsp;</td><td>ノルム </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>norm_type</em>&nbsp;</td><td>ノルムタイプ <ul>
<li>F_CC_EUCLIDEAN（ユークリッドノルム） </li>
<li>F_CC_WEIGHTED_EUCLIDEAN（重み付きユークリッドノルム） </li>
<li>F_CC_MAHALANOBIS（マハラノビスノルム） </li>
<li>F_CC_MANHATTAN（マンハッタンノルム） </li>
<li>F_CC_CHEBYSHEV（チェビシェフノルム） </li>
</ul>
</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>weight</em>&nbsp;</td><td>重み付きユークリッドノルムの重み係数</td></tr>
  </table>
</dl>
<dl compact><dt><b>戻り値:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NONE</em>&nbsp;</td><td>正常終了 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_IMAGE</em>&nbsp;</td><td>不正な画像オブジェクトが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_OBJECT</em>&nbsp;</td><td>不正なオブジェクトが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_INVALID_PARAM</em>&nbsp;</td><td>不正なパラメータが渡された </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_CALC_IMPOSSIBLE</em>&nbsp;</td><td>計算不能エラー </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>F_ERR_NO_LICENCE</em>&nbsp;</td><td>ライセンスエラー、または未初期化エラー</td></tr>
  </table>
</dl>
<dl class="user" compact><dt><b>使用例</b></dt><dd><div class="fragment"><pre class="fragment"><span class="comment">// エラー処理は省略しているので注意して下さい。</span>
<span class="preprocessor">#include "fie.h"</span>

VOID color_chart()
{
    <a class="code" href="structF__COLOR__CHART.html" title="色票構造体">F_COLOR_CHART</a> chart1, chart2;
    FHANDLE       hsrc = NULL;
    FHANDLE       hchild = NULL;
    DOUBLE        norm, weight[3];

    <span class="comment">// 画像ファイルを読み込む</span>
    <a class="code" href="group__fie__file__image.html#g03238db068bd08078fb1e29c1c31d8ac" title=" &amp;lt;img class= inline-img src=&amp;quot;oss.png&amp;quot; alt=&amp;quot;[[OSS]]&amp;quot;&amp;gt;  PNGファイル読...">fnFIE_load_png</a>( <span class="stringliteral">"fie_colorcheck1.png"</span>, &amp;hsrc, <a class="code" href="group__fie__file__image.html#gge1ca4e0484c0d907a215a44931bbcc9adb9994a1f48569964f60a6dd2eb91234" title="F_IMG_UC8, 3chで読込">F_COLOR_IMG_TYPE_UC8</a> );

    <span class="comment">// 色票を作成</span>
    hchild = <a class="code" href="group__fie__image.html#g167af7bb9b6ab179a806542d68b8b924" title="チャイルド画像の確保">fnFIE_img_child_alloc</a>( hsrc, 165, 350, 25, 25 );
    <a class="code" href="group__fie__color__chart.html#g0ef2472d9f928879056ddfb4ac03dd3c" title="色票の計算（画像指定）">fnFIE_colorchart_calc_image</a>( hchild, NULL, &amp;chart1 );
    <a class="code" href="group__fie__object.html#g5255bfc98226503d087b8614fcbb240c" title="オブジェクトを解放">fnFIE_free_object</a>( hchild );
    hchild = NULL;

    hchild = <a class="code" href="group__fie__image.html#g167af7bb9b6ab179a806542d68b8b924" title="チャイルド画像の確保">fnFIE_img_child_alloc</a>( hsrc, 320, 215, 25, 25 );
    <a class="code" href="group__fie__color__chart.html#g0ef2472d9f928879056ddfb4ac03dd3c" title="色票の計算（画像指定）">fnFIE_colorchart_calc_image</a>( hchild, NULL, &amp;chart2 );
    <a class="code" href="group__fie__object.html#g5255bfc98226503d087b8614fcbb240c" title="オブジェクトを解放">fnFIE_free_object</a>( hchild );
    hchild = NULL;

    weight[0] = 0.5;
    weight[1] = 1.0;
    weight[2] = 1.5;

    <span class="comment">// 重み付きユークリッドノルムの計算</span>
    <a class="code" href="group__fie__color__chart.html#gced9ea056206b2c20dca0211873c85dd" title="色票間のノルム計算">fnFIE_colorchart_calc_norm</a>( &amp;chart1, &amp;chart2, &amp;norm, <a class="code" href="group__fie__color__inspection__doc.html#ggd5a3cc17e83ecb6e72dd1bb70c67c37109c930da0e9bb2ae40d87c37d6cc630a" title="重み付けユークリッドノルム： ">F_CC_WEIGHTED_EUCLIDEAN</a>, weight );

    <span class="comment">// マハラノビスノルムの計算（weightは必要ない）</span>
    <a class="code" href="group__fie__color__chart.html#gced9ea056206b2c20dca0211873c85dd" title="色票間のノルム計算">fnFIE_colorchart_calc_norm</a>( &amp;chart1, &amp;chart2, &amp;norm, <a class="code" href="group__fie__color__inspection__doc.html#ggd5a3cc17e83ecb6e72dd1bb70c67c3716114847643708ef04ca85a9f1e0d43d3" title="マハラノビスノルム： ">F_CC_MAHALANOBIS</a>, NULL );

    <a class="code" href="group__fie__object.html#g5255bfc98226503d087b8614fcbb240c" title="オブジェクトを解放">fnFIE_free_object</a>( hsrc );

    <a class="code" href="group__fie__object.html#g5255bfc98226503d087b8614fcbb240c" title="オブジェクトを解放">fnFIE_free_object</a>( hchild );

    <span class="keywordflow">return</span>;
}

INT main()
{
    <span class="comment">// FIEライブラリの使用前に必ずコールする必要があります。</span>
    <a class="code" href="group__fie__libinit.html#g12250eabf0163ce206c4caa007b33a80" title="FIEライブラリの初期化">fnFIE_setup</a>();

    color_chart();

    <span class="comment">// 終了処理</span>
    <a class="code" href="group__fie__libinit.html#gcf71693a1b50ed7ce9947ac8179cbfc3" title="FIEライブラリの終了処理">fnFIE_teardown</a>();

    <span class="keywordflow">return</span> 0;
}
</pre></div> </dd></dl>

</div>
</div><p>
</div>
<hr size="1">
<address style="align: right; color: #cccccc;">
	<small>
	Documentation copyright &copy; 2009-2025 TOKYO ELECTRON DEVICE LIMITED. <br>
	Generated on Tue Sep 16 09:08:52 2025 for FIEライブラリ by&nbsp;<a href="http://www.doxygen.org/index.html">doxygen</a> 1.5.6-FASTSP-p2
	</small>
</address>
</body>
</html>
