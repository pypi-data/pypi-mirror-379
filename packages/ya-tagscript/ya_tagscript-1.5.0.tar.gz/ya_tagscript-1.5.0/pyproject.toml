[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "ya_tagscript"
version = "1.5.0"
description = "Yet Another TagScript fork. An easy drop in user-provided Templating system."
readme = "README.md"
license = "CC-BY-4.0"
license-files = ["LICENSE.md"]
authors = [
    { name = "MajorTanya", email = "tanya@majortanya.eu" }
]
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Operating System :: OS Independent",
]
requires-python = ">=3.11"
dependencies = [
    "discord-py>=2.5.0",
    "pyparsing>=3.2.0",
    "python-dateutil>=2.9.0",
]
keywords = ["tagscript"]

[project.urls]
Changelog = "https://ya-tagscript.readthedocs.io/en/latest/changelog.html"
Documentation = "https://ya-tagscript.readthedocs.io"
GitHub = "https://github.com/MajorTanya/ya_tagscript"
Issues = "https://github.com/MajorTanya/ya_tagscript/issues"

[dependency-groups]
dev = [
    "black>=25.9.0",
    "coverage>=7.10.7",
    "docutils-stubs>=0.0.22",
    "enum-tools[sphinx]>=0.13.0",
    "hatchling>=1.27.0",
    "isort>=6.0.1",
    "jinja2>=3.1.6",
    "mypy>=1.18.2",
    "myst-parser>=4.0.1",
    "pre-commit>=4.3.0",
    "pyright>=1.1.405",
    "pytest>=8.4.2",
    "sphinx>=8.2.3",
    "sphinx-autobuild>=2025.8.25",
    "sphinx-rtd-theme>=3.0.2",
    "types-python-dateutil>=2.9.0.20250822",
]

[tool.black]
target-version = ["py311", "py312", "py313"]

[tool.coverage.report]
fail_under = 98
show_missing = true
exclude_also = [
    '@(abc\.)?abstractmethod',
    'def __repr__',
    '(?:case _|else):\n\s*assert_never',
]

[tool.coverage.run]
branch = true
source = ['src/']
omit = ["make_release"]

[tool.isort]
profile = "black"
py_version = 311
reverse_relative = true

[tool.pyright]
deprecateTypingAliases = true
reportUnnecessaryTypeIgnoreComment = true
reportIncompatibleMethodOverride = true

[tool.pytest.ini_options]
filterwarnings = [
    "error",
    'ignore:.audioop. is deprecated and slated for removal in Python 3.13:DeprecationWarning',
]

[tool.tox]
requires = ["tox>=4"]
env_list = ["3.14", "3.13", "3.12", "3.11", "mypy_check", "pyright_check"]

[tool.tox.env_run_base]
description = "Run tests under {base_python}"
deps = ["pytest>=8"]
commands = [["pytest", { replace = "posargs", default = ["tests"], extend = true }]]

[tool.tox.env.mypy_check]
description = "Type check the codebase with mypy"
deps = [
    "mypy>=1.18.2",
    "types-python-dateutil>=2.9.0.20250822"
]
commands = [["mypy", "src", { replace = "posargs", extend = true }]]

[tool.tox.env.pyright_check]
description = "Type check the codebase with pyright"
deps = [
    "pyright>=1.1.405",
    "pytest>=8"
]
commands = [["pyright", "src", "tests", { replace = "posargs", extend = true }]]

[tool.tox.gh.python]
"3.14" = ["3.14"]
"3.13" = ["3.13", "mypy_check", "pyright_check"]
"3.12" = ["3.12"]
"3.11" = ["3.11"]
