package_testpypi:
  stage: package_testpypi
  script:
    - export UV_LINK_MODE=copy
    - export UV_PROJECT_ENVIRONMENT=.venv
    - uv build --no-cache
    - uv publish --publish-url https://test.pypi.org/legacy/ --token "${neptoon_pypi_test_api_key}"
  rules:
    - if: $CI_COMMIT_TAG =~ /^v/

package_pypi:
  stage: package_pypi
  script:
    - export UV_LINK_MODE=copy
    - export UV_PROJECT_ENVIRONMENT=.venv
    - uv build --no-cache
    - uv publish --token "${neptoon_pypi_api_key_ACTUAL}"
  rules:
    - if: $CI_COMMIT_TAG =~ /^v/
      when: manual
