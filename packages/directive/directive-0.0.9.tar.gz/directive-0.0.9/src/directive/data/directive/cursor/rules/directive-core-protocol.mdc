---
description: Directive Core Protocol (Gates before code)
alwaysApply: true
---

Scope: Applies to all implementation work in this repo. Treat the following as hard gates.

Authoritative sources (read first):
- Technical best practices → @directive/reference/agent_context.md
- Your workflow & gates (how to code the Directive way) → @directive/reference/agent_operating_procedure.md

Pre‑implementation gates (must exist and be approved before any code):
1) Spec → `/directive/specs/<feature>/spec.md`
2) Impact Analysis → `/directive/specs/<feature>/impact.md`
3) TDR (high‑level, decisive about interfaces) → `/directive/specs/<feature>/tdr.md`

Location for new feature docs:
- Create all new Spec, Impact, and TDR files under `/directive/specs/<feature>/` (one subfolder per feature).

Collaboration and approval:
- Draft each document (Spec, Impact, TDR) collaboratively with the engineer.
- Work on one document at a time; do not start the next until the engineer explicitly accepts the current deliverable.

Post‑approval implementation rules:
- Follow strict TDD: write a failing test → minimal implementation → refactor.
- Map each Spec acceptance criterion to at least one test ID.
- Keep PRs small; use conventional commits; keep CI green.
- Update the TDR if key decisions change.

Templates:
@directive/reference/templates/spec_template.md
@directive/reference/templates/impact_template.md
@directive/reference/templates/tdr_template.md