{
  "issue_title": "密码管理：硬编码加密密钥",
  "issue_level": "High",
  "issue_count": "2",
  "issue_desc": "当程序中使用硬编码加密密钥时，所有项目开发人员都可以查看该密钥，甚至如果攻击者可以获取到程序class文件，可以通过反编译得到密钥，硬编码加密密钥会大大降低系统安全性。\n\n**例如**：下列代码使用硬编码加密密钥执行AES加密。\n```java\nprivate static String encryptionKey = \"dfashsdsdfsdgagascv\";\n...\nbyte[] keyBytes = encryptionKey.getBytes();\nSecretKeySpec key = new SecretKeySpec(keyBytes, \"AES\");\nCipher encryptCipher = Cipher.getInstance(\"AES\");\nencryptCipher.init(Cipher.ENCRYPT_MODE, key);\n...\n```",
  "fix_advice": "程序应采用不小于8个字节的随机生成的字符串作为密钥。\n\n**例如**：以下代码使用KeyGenerator来生成密钥。\n```java\n...\nKeyGenerator keyGen = KeyGenerator.getInstance(\"AES\");\nkeyGen.init(128, new SecureRandom(password.getBytes()));\nSecretKey secretKey = kgen.generateKey();\nbyte[] keyBytes = secretKey.getEncoded();\nSecretKeySpec key = new SecretKeySpec(keyBytes, \"AES\");\nCipher encryptCipher = Cipher.getInstance(\"AES\");\nencryptCipher.init(Cipher.ENCRYPT_MODE, key);\n...\n```",
  "code_sample": "",
  "code_list": [
    {
      "code_location": "src/test/java/org/owasp/webgoat/lessons/jwt/claimmisuse/JWTHeaderKIDEndpointTest.java",
      "code_line_num": "35",
      "code_details": "跟踪路径:跟踪路径1:\n\n1 src/test/java/org/owasp/webgoat/lessons/jwt/claimmisuse/JWTHeaderKIDEndpointTest.java;35行key"
    },
    {
      "code_location": "src/test/java/org/owasp/webgoat/lessons/jwt/TokenTest.java",
      "code_line_num": "26",
      "code_details": "跟踪路径:跟踪路径1:\n\n1 src/test/java/org/owasp/webgoat/lessons/jwt/TokenTest.java;26行key"
    }
  ],
  "next_block_start": 14
}