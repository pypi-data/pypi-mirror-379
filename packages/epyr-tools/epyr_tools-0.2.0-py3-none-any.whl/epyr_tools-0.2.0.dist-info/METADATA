Metadata-Version: 2.4
Name: epyr-tools
Version: 0.2.0
Summary: Electron Paramagnetic Resonance (EPR) Tools in Python
Home-page: https://github.com/BertainaS/epyrtools
Author: Sylvain Bertaina
Author-email: Sylvain Bertaina <sylvain.bertaina@cnrs.fr>
Maintainer: Sylvain Bertaina
Maintainer-email: Sylvain Bertaina <sylvain.bertaina@cnrs.fr>
License: BSD-3-Clause
Project-URL: Homepage, https://github.com/BertainaS/epyrtools
Project-URL: Repository, https://github.com/BertainaS/epyrtools.git
Project-URL: Issues, https://github.com/BertainaS/epyrtools/issues
Keywords: EPR,electron paramagnetic resonance,spectroscopy,Bruker,data analysis
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: BSD License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Scientific/Engineering :: Chemistry
Classifier: Topic :: Scientific/Engineering :: Physics
Classifier: Topic :: Scientific/Engineering
Classifier: Environment :: Console
Classifier: Natural Language :: English
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=1.20.0
Requires-Dist: scipy>=1.7.0
Requires-Dist: matplotlib>=3.3.0
Requires-Dist: h5py>=3.1.0
Requires-Dist: pandas>=1.3.0
Provides-Extra: dev
Requires-Dist: pytest>=6.0.0; extra == "dev"
Requires-Dist: pytest-cov>=2.10.0; extra == "dev"
Requires-Dist: pytest-benchmark>=4.0.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: flake8-docstrings>=1.7.0; extra == "dev"
Requires-Dist: flake8-import-order>=0.18.0; extra == "dev"
Requires-Dist: flake8-bugbear>=23.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Requires-Dist: types-requests>=2.28.0; extra == "dev"
Requires-Dist: pre-commit>=3.0.0; extra == "dev"
Requires-Dist: isort>=5.12.0; extra == "dev"
Requires-Dist: bandit>=1.7.5; extra == "dev"
Requires-Dist: pydocstyle>=6.3.0; extra == "dev"
Requires-Dist: pipdeptree>=2.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=6.0.0; extra == "docs"
Requires-Dist: sphinx-rtd-theme>=1.3.0; extra == "docs"
Requires-Dist: myst-parser>=2.0.0; extra == "docs"
Requires-Dist: scipy>=1.7.0; extra == "docs"
Provides-Extra: all
Requires-Dist: epyr-tools[dev,docs]; extra == "all"
Dynamic: author
Dynamic: home-page
Dynamic: license-file
Dynamic: maintainer
Dynamic: requires-python

# EPyR Tools: Electron Paramagnetic Resonance (EPR) Tools in Python

| License | Tests | Documentation | Version |
|---------|-------|---------------|---------|
| [![License](https://img.shields.io/badge/License-BSD%203--Clause-blue.svg)](https://opensource.org/licenses/BSD-3-Clause) | ![Tests Passing](https://img.shields.io/badge/tests-100%2B%20passed-brightgreen) | [![Documentation](https://img.shields.io/badge/docs-comprehensive-blue)](docs/) | ![Version](https://img.shields.io/badge/version-0.2.0-blue) |

**EPyR Tools** is a comprehensive Python package for Electron Paramagnetic Resonance (EPR) spectroscopy data analysis. It provides a complete toolkit for loading, processing, analyzing, and visualizing EPR data from Bruker spectrometers, with a focus on FAIR (Findable, Accessible, Interoperable, and Reusable) data principles.

From basic data loading to advanced quantitative analysis, EPyR Tools offers professional-grade capabilities for EPR researchers, with comprehensive documentation and interactive tutorials.

## Key Features

### **Data Loading & Formats**
- **Bruker File Support:** Load BES3T (.dta/.dsc) and ESP/WinEPR (.par/.spc) files seamlessly
- **Automatic Format Detection:** Smart file format recognition and parameter extraction
- **FAIR Data Conversion:** Export to CSV, JSON, and HDF5 formats with complete metadata
- **Batch Processing:** Handle multiple files efficiently with parallel processing
- **Plugin Architecture:** Extensible system for custom file formats and processing

### **Advanced Analysis**
- **Modern Baseline Correction:** Streamlined polynomial correction with interactive region selection
- **Peak Detection:** Automatic identification of EPR spectral features
- **g-Factor Calculations:** Precise electronic g-factor determination with field calibration
- **Hyperfine Analysis:** Pattern recognition and coupling constant extraction
- **Quantitative Integration:** Single and double integration for spin quantification
- **Lineshape Analysis:** Comprehensive suite of EPR lineshape functions (Gaussian, Lorentzian, Voigt, pseudo-Voigt)

### **Command Line Interface**
- **Complete CLI Suite:** 9 professional commands for all EPR workflows
- **Interactive Plotting:** `epyr-plot` with measurement tools for precise delta x/y analysis
- **Batch Processing:** `epyr-batch-convert` for high-throughput data processing  
- **Data Validation:** `epyr-validate` with FAIR compliance checking
- **Configuration Management:** `epyr-config` for system-wide settings
- **Interactive Tools:** `epyr-isotopes` GUI and system information display

### **Performance & Quality**
- **Memory Optimization:** Intelligent caching and memory management for large datasets
- **Parallel Processing:** Multi-core support for batch operations
- **Quality Assurance:** Comprehensive testing suite with 90+ tests
- **Code Standards:** Professional development workflow with pre-commit hooks
- **Security:** Automated vulnerability scanning and safe defaults

### **Visualization & Plotting**
- **Interactive Measurement Tools:** Click-to-measure delta x/y distances with real-time feedback
- **2D Spectral Maps:** Professional publication-quality EPR plots  
- **macOS Optimized:** Smooth interactive plotting with TkAgg backend
- **Customizable Styling:** Flexible plot configuration for different EPR experiments
- **Export Options:** High-resolution outputs for publications

### **Learning & Documentation**
- **Interactive Tutorials:** 4 comprehensive Jupyter notebooks (beginner â†’ advanced)
- **Complete API Documentation:** Professional Sphinx-generated docs
- **Example Scripts:** Ready-to-use Python automation scripts including lineshape analysis
- **Best Practices Guide:** EPR analysis workflows and quality assessment

### **EPR-Specific Tools**
- **Physical Constants:** Comprehensive EPR-relevant constants library
- **Isotope Database:** Nuclear properties and magnetic parameters
- **Field-Frequency Conversion:** Precise EPR measurement calculations
- **Spectrometer Support:** Optimized for modern Bruker EPR systems

### **Professional Documentation**
- **[Complete Documentation](docs/)**: Comprehensive guides and API reference
- **[User Guide](docs/user_guide.md)**: Step-by-step tutorials and workflows
- **[CLI Reference](docs/cli_reference.md)**: Command-line interface documentation
- **[System Architecture](docs/README.md)**: Core modules and plugin system

## Installation

### Prerequisites
- Python 3.8 or higher
- NumPy, matplotlib, pandas, h5py (automatically installed)

### Quick Install
```bash
pip install epyr-tools
```

### Development Installation
```bash
# Clone the repository
git clone https://github.com/BertainaS/epyrtools.git
cd epyrtools

# Install with development dependencies
pip install -e ".[dev,docs]"

# Set up pre-commit hooks
pre-commit install
```

### Verification
```bash
# Test installation
epyr --help
epyr-info

# Run test suite
make test
```

### Alternative: Manual Dependencies
```bash
# Clone the repository
git clone https://github.com/BertainaS/epyrtools.git
cd epyrtools

# Install dependencies manually
pip install -r requirements.txt

# Optional: Install development tools
pip install -r requirements-dev.txt
```

### Quick Test
```bash
# Verify installation
python -c "import epyr; print('EPyR Tools successfully installed!')"
```

## Getting Started

### Quick Demo: Loading EPR Data

![EPyR Tools eprload demo](eprload_simple_demo.gif)

### 1. Loading Data

The primary function for loading data is `epyr.eprload()`. It can be called with a file path or without arguments to open a file dialog.

```python
import epyr.eprload as eprload

# Open a file dialog to select a .dta, .dsc, .spc, or .par file
# The script will automatically plot the data.
x, y, params, file_path = eprload.eprload()

# Or, specify a file path directly:
# x, y, params, file_path = eprload.eprload('path/to/your/data.dsc')
```

### 2. Converting to FAIR Formats

Use the `epyr.fair` module to convert your Bruker files into more accessible formats (`.csv`, `.json`, `.h5`).

```python
from epyr.fair import convert_bruker_to_fair

# Opens a file dialog to select an input file and saves the converted
# files in the same directory.
convert_bruker_to_fair()

# You can also specify input and output paths:
# convert_bruker_to_fair('path/to/data.dsc', output_dir='path/to/output')
```

### 3. Modern Baseline Correction

The `epyr.baseline` module provides streamlined functions for correcting EPR baselines with interactive region selection. Compatible with `eprload()` data format.

```python
import epyr
import numpy as np

# Load EPR data using eprload
x, y, params, filepath = epyr.eprload("data.dsc")

# Simple automatic correction
corrected, baseline = epyr.baseline.baseline_polynomial_1d(x, y, params)

# With manual region exclusion (e.g., exclude signal regions)
signal_regions = [(3340, 3360), (3380, 3400)]  # mT
corrected, baseline = epyr.baseline.baseline_polynomial_1d(
    x, y, params, 
    manual_regions=signal_regions,
    region_mode='exclude',
    order=2
)

# Interactive region selection for complex spectra
corrected, baseline = epyr.baseline.baseline_polynomial_1d(
    x, y, params,
    interactive=True
)
```

### 4. Lineshape Analysis

The `epyr.lineshapes` module provides comprehensive EPR lineshape functions with advanced capabilities including derivatives, phase rotation, and convolution.

```python
from epyr.lineshapes import Lineshape, gaussian, lorentzian, voigtian
import numpy as np
import matplotlib.pyplot as plt

# Create magnetic field range
B = np.linspace(-10, 10, 1000)  # mT

# Method 1: Direct functions with advanced options
gauss = gaussian(B, center=0, width=4.0, derivative=0)  # Absorption
gauss_1st = gaussian(B, center=0, width=4.0, derivative=1)  # 1st derivative
lorentz = lorentzian(B, center=0, width=4.0, phase=0.0)  # Pure absorption

# True Voigt profiles (convolution of Gaussian and Lorentzian)
voigt = voigtian(B, center=0, sigma=2.0, gamma=2.0)

# Method 2: Unified Lineshape class for consistent API
shape = Lineshape('pseudo_voigt', width=4.0, alpha=0.5)  # 50/50 mix
mixed = shape(B, center=0)

# Plot comparison
plt.plot(B, gauss, label='Gaussian')
plt.plot(B, lorentz, label='Lorentzian')  
plt.plot(B, voigt, label='True Voigt')
plt.plot(B, mixed, label='Pseudo-Voigt')
plt.legend()
plt.show()
```

### 5. Simple EPR Plotting

The `epyr.eprplot` module provides simple, direct plotting functions for EPR data from `eprload()`.

```python
import epyr
import matplotlib.pyplot as plt

# Load EPR data
x, y, params, filepath = epyr.eprload("data.dsc")

# Plot 1D spectrum
epyr.eprplot.plot_1d(x, y, params, title="EPR Spectrum")

# Plot 2D data as color map
epyr.eprplot.plot_2d_map(x, y, params, title="2D EPR Map")

# Plot 2D data as waterfall plot
epyr.eprplot.plot_2d_waterfall(x, y, params, title="2D Waterfall", max_traces=30)

plt.show()
```

### 6. Interactive Command-Line Plotting

Experience the new interactive plotting with measurement tools:

```bash
# Interactive plotting with measurement tools
epyr-plot --interactive --measure

# Load specific file with measurements
epyr-plot spectrum.dsc --interactive --measure

# Quick analysis with scaling and save
epyr-plot data.dta --interactive --measure -s nG --save
```

**Measurement Features:**
- Click two points to measure Î”x, Î”y, and distance
- Real-time visual feedback with annotations
- macOS optimized for smooth performance
- Right-click to clear, 'c' key for quick clear

### 7. Isotope GUI

Run the interactive isotope GUI to explore nuclear data. Note that this requires the `pandas` library.

```python
from epyr.isotope_gui import run_gui

# This will launch the Tkinter GUI
run_gui()
```

## Interactive Tutorials

EPyR Tools includes comprehensive Jupyter notebook tutorials for hands-on learning:

### **Getting Started (Beginner)**
```bash
cd examples/notebooks
jupyter notebook 01_Getting_Started.ipynb
```
Learn EPR data loading, visualization, and FAIR data conversion.

### **Baseline Correction (Intermediate)**
```bash
jupyter notebook 06_Baseline_Correction_Functions_Complete.ipynb
```
Master modern polynomial baseline correction with interactive region selection.

### **Advanced Analysis (Expert)**
```bash
jupyter notebook 03_Advanced_Analysis.ipynb
```
Complete EPR analysis: g-factors, hyperfine structure, quantitative integration.

### **EPR Lineshape Analysis (Professional)**
```bash
jupyter notebook 04_EPR_Lineshape_Analysis.ipynb
```
Comprehensive lineshape analysis: Gaussian, Lorentzian, Voigt profiles, derivatives, and convolution techniques.

### **Example Scripts**
Ready-to-use automation scripts in `examples/scripts/`:
```bash
python examples/scripts/01_basic_loading.py
python examples/scripts/02_baseline_correction.py
python examples/scripts/04_lineshape_analysis.py
```

## Project Structure

```
epyrtools/
â”œâ”€â”€ epyr/                           # Main package
â”‚   â”œâ”€â”€ eprload.py                 # Core data loading (BES3T, ESP formats)
â”‚   â”œâ”€â”€ eprplot.py                 # Simple EPR plotting functions
â”‚   â”œâ”€â”€ baseline_correction.py     # Modern streamlined baseline correction
â”‚   â”œâ”€â”€ baseline/                  # Compatibility layer for baseline functions
â”‚   â”‚   â””â”€â”€ __init__.py           # Imports from baseline_correction
â”‚   â”œâ”€â”€ fair/                     # FAIR data conversion
â”‚   â”‚   â”œâ”€â”€ conversion.py         # Format conversion tools
â”‚   â”‚   â”œâ”€â”€ exporters.py          # CSV, JSON, HDF5 export
â”‚   â”‚   â””â”€â”€ parameter_mapping.py  # Metadata standardization
â”‚   â”œâ”€â”€ lineshapes/               # EPR lineshape analysis
â”‚   â”‚   â”œâ”€â”€ gaussian.py           # Gaussian profiles with derivatives
â”‚   â”‚   â”œâ”€â”€ lorentzian.py         # Lorentzian profiles with phase rotation
â”‚   â”‚   â”œâ”€â”€ voigtian.py           # True Voigt convolution profiles
â”‚   â”‚   â”œâ”€â”€ lshape.py             # General lineshape functions
â”‚   â”‚   â”œâ”€â”€ convspec.py           # Spectrum convolution tools
â”‚   â”‚   â””â”€â”€ lineshape_class.py    # Unified lineshape interface
â”‚   â”œâ”€â”€ constants.py              # EPR physical constants
â”‚   â”œâ”€â”€ plot.py                   # Advanced EPR plotting
â”‚   â”œâ”€â”€ isotope_gui/             # Interactive isotope database
â”‚   â””â”€â”€ sub/                     # Utility modules
â”‚       â”œâ”€â”€ loadBES3T.py         # BES3T format loader
â”‚       â”œâ”€â”€ loadESP.py           # ESP format loader
â”‚       â””â”€â”€ utils.py             # File handling utilities
â”œâ”€â”€ docs/                        # Sphinx API documentation
â”œâ”€â”€ examples/                    # Comprehensive tutorial system
â”‚   â”œâ”€â”€ notebooks/               # Interactive Jupyter tutorials
â”‚   â”‚   â””â”€â”€ Getting_Started.ipynb    # Complete beginner tutorial
â”‚   â”œâ”€â”€ scripts/                 # Python automation examples
â”‚   â””â”€â”€ data/                    # EPR measurement files
â”‚       â”œâ”€â”€ *.DSC, *.DTA        # BES3T format files
â”‚       â”œâ”€â”€ *.par, *.spc        # ESP format files
â”‚       â””â”€â”€ processed/          # Analysis results examples
â”œâ”€â”€ tests/                       # Comprehensive test suite (44 tests)
â”œâ”€â”€ requirements.txt             # Core dependencies
â”œâ”€â”€ requirements-dev.txt         # Development tools
â””â”€â”€ pyproject.toml              # Modern Python packaging
```

## Contributing & Support

### **Documentation**
- **API Reference:** [docs/](docs/) - Complete function documentation
- **Tutorials:** [examples/notebooks/](examples/notebooks/) - Interactive learning
- **Examples:** [examples/scripts/](examples/scripts/) - Ready-to-use code

### **Community**
- **Issues:** [GitHub Issues](https://github.com/BertainaS/epyrtools/issues)
- **Discussions:** Share EPR analysis workflows and tips
- **Contributing:** See contribution guidelines for code contributions

### **Quality Assurance**
- **44 passing tests** with pytest
- **Pre-commit hooks** for code quality
- **Type hints** and comprehensive docstrings
- **Professional packaging** with modern Python standards

## License

This project is licensed under the **BSD 3-Clause License** - see the [LICENSE](LICENSE) file for details.

---

**EPyR Tools** - *Professional EPR analysis for the Python ecosystem*
