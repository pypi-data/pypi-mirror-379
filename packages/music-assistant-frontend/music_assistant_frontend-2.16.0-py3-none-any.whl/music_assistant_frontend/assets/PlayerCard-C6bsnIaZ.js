import{i as q,N as T,e as b,o as i,aQ as j,r as H,w as p,aR as X,aA as J,b0 as C,d as Y,h as K,q as _,c as y,V as M,D as P,u as r,bg as g,b as f,g as w,a as z,t as v,b8 as I,b4 as E,m as d,be as $,p as Z,F as Q,bd as x,aU as R,aV as B,aT as V,s as S,$ as ee,b9 as N,b1 as O,b2 as ae,aZ as D,bf as le,ad as oe,n as te,E as se,J as U,M as ie,bc as re,b6 as ne,bk as ue,aF as de,aY as pe,k as me,bh as F,bi as W}from"./index-CuEbufVv.js";import{B as A}from"./Button-CmRGpbWL.js";import{M as ye}from"./MediaItemThumb-aVuotDrK.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ve}from"./VSlider-DBfJ_-mI.js";import{V as ce}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-CEnaDovA.js";const _e={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(s,o){const u=q(!0),l=T(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:u.value?0:10,step:2,elevation:0,style:`width: ${s.width}; height:${s.height}; display: inline-grid; ${s.style}`})),h=T(()=>({...l.value,...o}));return{isThumbHidden:u,playerVolumeProps:h,onWheel:({deltaY:m})=>{if(!s.allowWheel)return;const k=h.value.step,e=o.attrs["model-value"],n=m<0?k:-k;o.emit("update:model-value",e+n)}}}};function be(s,o,u,l,h,t){return i(),b(ve,J(l.playerVolumeProps,{onTouchstart:o[0]||(o[0]=m=>l.isThumbHidden=!1),onTouchend:o[1]||(o[1]=m=>l.isThumbHidden=!0),onMouseenter:o[2]||(o[2]=m=>l.isThumbHidden=!1),onMouseleave:o[3]||(o[3]=m=>l.isThumbHidden=!0),onWheel:C(l.onWheel,["prevent"]),onEnd:o[4]||(o[4]=m=>s.$emit("update:model-value",m))}),j({_:2},[H(s.$slots,(m,k)=>({name:k,fn:p(()=>[X(s.$slots,k,{},void 0,!0)])}))]),1040,["onWheel"])}const G=L(_e,[["render",be],["__scopeId","data-v-af51e13c"]]),fe={key:1,class:"text-caption volumecaption"},he={key:0,class:"text-caption volumecaption"},ge=Y({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(s){const o=s,u=q([]),l=q([]),h=q(void 0),t=T(()=>o.player.group_members.length>0),m=function(e){const n=[];for(const a of e.group_members){const c=d?.players[a];c&&c.volume_control!=g&&c&&c.available&&!n.includes(c)&&n.push(c)}if(o.showSyncControls&&e.supported_features.includes(R.SET_MEMBERS))for(const a of Object.values(d?.players))a.player_id!=e.player_id&&(!e.can_group_with.includes(a.player_id)&&!e.can_group_with.includes(a.provider)||a.available&&a.type!=$.GROUP&&(a.active_group&&a.active_group!=e.player_id||a.active_source&&a.playback_state==B.PLAYING&&![e.player_id,a.player_id].includes(a.active_source)||n.includes(a)||n.push(a)));return n.sort((a,c)=>a.name.toUpperCase()>c.name.toUpperCase()?1:-1),n},k=async function(e,n){const a=o.player.player_id;n?(l.value.includes(e)&&(l.value=l.value.filter(c=>c!=e)),u.value.includes(e)||u.value.push(e),d.players[a].group_members.push(e)):(u.value.includes(e)&&(u.value=u.value.filter(c=>c!=e)),l.value.includes(e)||l.value.push(e),d.players[a].group_members=d.players[a].group_members.filter(c=>c!=e)),h.value!=null&&clearTimeout(h.value),!(u.value.length==0&&l.value.length==0)&&(h.value=setTimeout(async()=>{d.playerCommandSetMembers(a,u.value.length?u.value:void 0,l.value.length?l.value:void 0).catch(async()=>{d.players[a]=await d.getPlayer(a)}).finally(()=>{u.value=[],l.value=[]})},1e3))};return(e,n)=>(i(),b(K,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:p(()=>[e.showHeadingRow?(i(),b(M,{key:0,class:"volumesliderrow heading",link:!1,style:P(e.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:p(()=>[f(w,{size:25,icon:e.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[z("h5",null,v(r(I)(e.player,27)),1)]),append:p(()=>[e.player.power_control!=r(g)?(i(),b(A,{key:0,class:"powerbtn",variant:"icon",onClick:n[0]||(n[0]=C(a=>r(d).playerCommandPowerToggle(e.player.player_id),["stop"]))},{default:p(()=>[f(w,{size:25,icon:"mdi-power"})]),_:1})):_("",!0)]),_:1},8,["style"])):_("",!0),e.showVolumeControl&&(e.player.volume_control!=r(g)||e.player.group_members.length)?(i(),b(M,{key:1,class:"volumesliderrow",link:!1,style:P(e.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:p(()=>[f(A,{icon:"",style:{height:"25px"},disabled:e.player.type==r($).GROUP||e.player.group_members.length>0||e.player.mute_control==r(g),onClick:n[1]||(n[1]=C(a=>r(d).playerCommandMuteToggle(e.player.player_id),["stop"]))},{default:p(()=>[f(w,{size:25,icon:e.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:p(()=>[e.player.volume_control!=r(g)||e.player.group_members.length?(i(),b(G,{key:0,color:"secondary",width:"100%","is-powered":e.player.powered!=!1,disabled:!e.player.available,"model-value":Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0),onClick:n[2]||(n[2]=C(()=>{},["stop"])),"onUpdate:modelValue":n[3]||(n[3]=a=>e.player.group_members.length>0?r(d).playerCommandGroupVolume(e.player.player_id,a):r(d).playerCommandVolumeSet(e.player.player_id,a))},null,8,["is-powered","disabled","model-value"])):_("",!0)]),append:p(()=>[t.value&&!e.showSubPlayers?(i(),b(w,{key:0,class:"expandbtn"},{default:p(()=>[...n[7]||(n[7]=[E(" mdi-chevron-down ",-1)])]),_:1})):(i(),y("div",fe,v(Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0)),1))]),_:1},8,["style"])):_("",!0),e.showSubPlayers&&(e.player.group_members.length>0||e.showSyncControls)&&m(e.player).length>0?(i(),y("div",{key:2,onClick:n[6]||(n[6]=C(()=>{},["stop"]))},[f(Z,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(i(!0),y(Q,null,H(m(e.player),a=>(i(),y("div",{key:a.player_id},[f(M,{class:"volumesliderrow",link:!1,style:P(a.powered!=!1||e.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:n[4]||(n[4]=C(()=>{},["stop"]))},{prepend:p(()=>[f(w,{size:30,icon:a.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[z("h6",null,v(r(x)(a.name,27)),1)]),append:p(()=>[e.showSyncControls?(i(),b(ce,{key:0,ripple:!1,disabled:a.player_id==e.player.player_id,"model-value":e.player.group_members.includes(a.player_id)||a.player_id==e.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":c=>k(a.player_id,c)},null,8,["disabled","model-value","onUpdate:modelValue"])):_("",!0)]),_:2},1032,["style"]),a.volume_control!=r(g)?(i(),b(M,{key:0,class:"volumesliderrow",link:!1,style:P(a.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:n[5]||(n[5]=C(()=>{},["stop"]))},{prepend:p(()=>[f(A,{icon:"",disabled:!a.available||a.mute_control==r(g),style:{height:"25px"},onClick:c=>r(d).playerCommandMuteToggle(a.player_id)},{default:p(()=>[f(w,{size:25,icon:a.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:p(()=>[a.volume_control!=r(g)?(i(),b(G,{key:0,color:"secondary",width:"100%","is-powered":a.powered!=!1,disabled:!a.available,"allow-wheel":e.allowWheel,"model-value":Math.round(a.volume_level||0),"onUpdate:modelValue":c=>r(d).playerCommandVolumeSet(a.player_id,c)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):_("",!0)]),append:p(()=>[a.volume_control!=r(g)?(i(),y("div",he,v(a.volume_level),1)):_("",!0)]),_:2},1032,["style"])):_("",!0),n[8]||(n[8]=z("div",{style:{height:"14px"}},null,-1))]))),128))])):_("",!0)]),_:1}))}}),we=L(ge,[["__scopeId","data-v-44b520e8"]]),Ce=(s,o)=>{const u=[];s?.power_control!=g&&u.push({label:s.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{d.playerCommandPowerToggle(s.player_id)},icon:"mdi-power"}),(s?.playback_state=="playing"||s?.playback_state=="paused")&&u.push({label:"stop_playback",labelArgs:[],action:()=>{d.playerCommandStop(s.player_id)},icon:"mdi-stop"});const l=Object.values(d.players).filter(t=>t.player_id!=s.player_id&&t.available&&t.enabled&&(t.can_group_with.includes(s.provider)||t.can_group_with.includes(s.player_id))&&t.supported_features.includes(R.SET_MEMBERS)&&!t.synced_to);s.supported_features.includes(R.SET_MEMBERS)&&!s.synced_to&&s.type==$.PLAYER&&s.group_members.length==0&&l.length>0&&u.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:l.map(t=>({label:t.name,labelArgs:[],action:()=>{d.playerCommandGroup(s.player_id,t.player_id)}})).sort((t,m)=>t.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),o&&u.push({label:o.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{d.queueCommandShuffleToggle(o.queue_id)},icon:o.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),o&&u.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{d.queueCommandRepeat(o.queue_id,V.OFF)},selected:o.repeat_mode==V.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{d.queueCommandRepeat(o.queue_id,V.ALL)},selected:o.repeat_mode==V.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{d.queueCommandRepeat(o.queue_id,V.ONE)},selected:o.repeat_mode==V.ONE}],icon:"mdi-repeat"}),o?.items&&u.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(d.players).filter(t=>t.player_id!=o.queue_id&&t.player_id!=s.player_id&&t.available&&t.enabled&&!t.synced_to).map(t=>({label:t.name,labelArgs:[],action:()=>{d.queueCommandTransfer(o.queue_id,t.player_id),S.activePlayerId=t.player_id}})).sort((t,m)=>t.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),o?.items&&u.push({label:"queue_clear",labelArgs:[],action:()=>{d.queueCommandClear(o.queue_id)},icon:"mdi-cancel"});const h=s.source_list.filter(t=>!t.passive||t.id==s.active_source);return s.active_source!=s.player_id&&h.push({id:s.player_id,name:ee("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!s.synced_to&&h.length>0&&u.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:h.map(t=>({label:t.name,labelArgs:[],disabled:t.id==s.active_source,selected:t.id==s.active_source,action:()=>{d.playerCommandGroupSelectSource(s.player_id,t.id)}})).sort((t,m)=>t.label.toUpperCase()>m.label?.toUpperCase()?1:-1)}),o&&"dont_stop_the_music_enabled"in o&&u.push({label:o.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{d.queueCommandDontStopTheMusicToggle(o.queue_id)},icon:"mdi-all-inclusive"}),u.push({label:"open_player_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${s.player_id}`)},icon:"mdi-cog-outline"}),s.type!==$.GROUP&&u.push({label:"open_dsp_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,N.push(`/settings/editplayer/${s.player_id}/dsp`)},icon:"mdi-equalizer"}),u},ke={class:"player-media-thumb"},Se={key:1},Ve={key:2,class:"icon-thumb"},Te={key:0,style:{"margin-bottom":"3px"}},Ae={key:0},Me={key:1},Be={key:1},qe={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},ze={key:0},$e={key:0},Pe={key:1},Ee={key:2},Ue={class:"v-list-item-subtitle",style:{"font-size":"0.85rem","white-space":"nowrap"}},Ie={key:0},Re={key:1},Le={key:2},Ne={key:3},Oe={key:4},De={key:5},Fe={key:6},We={key:7},Ge=Y({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},setup(s){pe(e=>({"1830801d":k.value}));const o=s,u=T(()=>{if(o.player&&o.player.active_source&&o.player.active_source in d.queues)return d.queues[o.player.active_source];if(o.player&&!o.player.active_source&&o.player.player_id in d.queues)return d.queues[o.player.player_id]}),l=T(()=>{if(u.value&&u.value.active)return u.value.current_item}),h=function(e){me.emit("contextmenu",{items:Ce(o.player,u.value),posX:e.clientX,posY:e.clientY})},t=q({0:"",1:"",2:"",3:"",4:"",5:"",lightColor:"",darkColor:""}),m=new Image;m.src=D.theme.current.value.dark?O:ae,m.crossOrigin="Anonymous",m.addEventListener("load",function(){t.value=le(m)});const k=T(()=>D.theme.current.value.dark?t.value&&t.value.darkColor?t.value.darkColor:"#CCCCCC26":t.value&&t.value.lightColor?t.value.lightColor:"#CCCCCC26");return oe(l,e=>{e?.media_item?m.src=F(e.media_item,W.THUMB)||"":e?m.src=F(e,W.THUMB)||"":m.src=""},{immediate:!0}),(e,n)=>(i(),b(te,{flat:"",class:se(["panel-item",{"panel-item-selected":e.player.player_id==r(S).activePlayerId,"panel-item-idle":e.player.playback_state==r(B).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available},{default:p(()=>[f(M,{class:"panel-item-details",flat:"",ripple:!1},{prepend:p(()=>[z("div",ke,[e.player.powered!=!1&&l.value?(i(),b(ye,{key:0,class:"media-thumb",size:"60",item:l.value,fallback:r(O)},null,8,["item","fallback"])):e.player.powered!=!1&&!u.value&&e.player.current_media?.image_url?(i(),y("div",Se,[f(de,{class:"media-thumb",size:"60",src:e.player.current_media.image_url},null,8,["src"])])):(i(),y("div",Ve,[f(w,{size:"24",icon:e.player.type==r($).PLAYER&&e.player.group_members.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]),title:p(()=>[r(ue).player_id===e.player.player_id?(i(),y("div",Te,[e.player.name=="This Device"?(i(),y("span",Ae,v(e.$t("this_device")),1)):(i(),y("span",Me,v(r(I)(e.player,27)),1)),f(w,{size:"20",class:"ml-2",icon:r(S).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(i(),y("div",Be,v(r(I)(e.player,27)),1))]),subtitle:p(()=>[e.player.powered!=!1?(i(),y("div",qe,[l.value?.media_item?(i(),y("div",ze,[E(v(l.value?.media_item.name)+" ",1),"version"in l.value?.media_item&&l.value?.media_item.version?(i(),y("span",$e,"("+v(l.value?.media_item.version)+")",1)):_("",!0)])):l.value?(i(),y("div",Pe,v(l.value?.name),1)):!u.value&&e.player.current_media?.title?(i(),y("div",Ee,v(e.player.current_media.title),1)):_("",!0)])):_("",!0)]),default:p(()=>[z("div",Ue,[e.player.powered==!1?(i(),y("div",Ie,v(e.$t("off")),1)):l.value?.media_item&&l.value?.media_item?.media_type==r(ie).TRACK&&"album"in l.value?.media_item&&l.value?.media_item.album?(i(),y("div",Re,v(r(re)(l.value?.media_item.artists))+" • "+v(l.value?.media_item.album.name),1)):l.value?.media_item&&"artists"in l.value?.media_item&&l.value?.media_item.artists.length>0?(i(),y("div",Le,v(l.value?.media_item.artists[0].name),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title&&l.value?.streamdetails?.stream_metadata.artist?(i(),y("div",Ne,v(l.value?.streamdetails?.stream_metadata.artist)+" - "+v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title?(i(),y("div",Oe,v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.media_item?.metadata.description?(i(),y("div",De,v(l.value?.media_item.metadata.description),1)):!u.value&&e.player.active_source?(i(),y("div",Fe,v(e.$t("external_source_active",[r(ne)(e.player)])),1)):u.value?.items==0?(i(),y("div",We,v(e.$t("queue_empty")),1)):_("",!0)])]),append:p(()=>[e.player.playback_state==r(B).PAUSED||e.player.playback_state==r(B).PLAYING||u.value?.items?(i(),b(A,{key:0,variant:"icon",class:"player-command-btn",onClick:n[0]||(n[0]=C(a=>{r(d).playerCommandPlayPause(e.player.player_id),r(S).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32",icon:e.player.playback_state==r(B).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):_("",!0),e.player.power_control!=r(g)&&e.allowPowerControl?(i(),b(A,{key:1,variant:"icon",class:"player-command-btn",onClick:n[1]||(n[1]=C(a=>{r(d).playerCommandPowerToggle(e.player.player_id),r(S).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32"},{default:p(()=>[...n[2]||(n[2]=[E("mdi-power",-1)])]),_:1},8,["size"])]),_:1})):_("",!0),e.showMenuButton?(i(),b(A,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:C(h,["stop"])},{default:p(()=>[f(w,{size:r(U)({breakpoint:"phone"})?"30":"32"},{default:p(()=>[...n[3]||(n[3]=[E("mdi-dots-vertical",-1)])]),_:1},8,["size"])]),_:1})):_("",!0)]),_:1}),e.showVolumeControl?(i(),b(we,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):_("",!0)]),_:1},8,["class","disabled"]))}}),Ze=L(Ge,[["__scopeId","data-v-b9df4915"]]);export{G as P,we as V,Ze as a,Ce as g};
