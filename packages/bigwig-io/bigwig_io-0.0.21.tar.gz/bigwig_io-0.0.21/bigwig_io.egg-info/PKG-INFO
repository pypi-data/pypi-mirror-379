Metadata-Version: 2.4
Name: bigwig_io
Version: 0.0.21
Summary: Process bigwig and bigbed files
Author-email: Arthur Gouhier <ajgouhier@gmail.com>
License-Expression: MIT
Project-URL: Repository, https://github.com/ajgouhier/bigwig_io
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy
Requires-Dist: pybind11>=2.6.0
Dynamic: license-file

## Installation

```
pip install bigwig-io
```

Requires numpy and pybind11.

## Usage

### Read signal

```python
reader = bigwig_io.Reader(path)
values = reader.read_signal(chr_ids, start, span)
```

Parameters:
- `chr_ids` `starts` Chromosomes ids and starts of locations.
- `span` Reading window in bp from locations starts. 1 by default.
- `bin_size` Output bin size in bp. 1 by default.
- `bin_mode` Method to aggregate bin values. Either "mean", "sum" or "single" (one randomly selected value per bin). "mean" by default.
- `def_value` Default value to use when no data overlap a bin. 0 by default.
- `zoom` BigWig zoom level to use. Use full data if -1. Auto-detect the best level if 0 by selecting the larger level whose bin size is lower that the third of `bin_size` (may be the full data). 0 by default.
- `progress` Function called during data extraction. Takes the extracted coverage and the total coverage in bp as parameters. None by default.

Outputs a numpy float32 array of shape (locations, span//bin_size).

### Quantify signal

```python
reader = bigwig_io.Reader(path)
values = reader.quantify(chr_ids, start, ends/span)
```

Parameters:
- `chr_ids` `starts` `span` `bin_size` `def_value` `zoom` `progress` Identical to `read_values` method.
- `ends` Ends of locations. Takes precedence over `span` is specified. None by default.
- `reduce` Method to aggregate values over span. Either "mean", "sd", "sem", "sum", "min" or "max". "mean" by default.

Outputs a numpy float32 array of shape (locations).

### Profile signal

```python
reader = bigwig_io.Reader(path)
values = reader.profile(chr_ids, start, span)
```

Parameters:
- `chr_ids` `starts` `span` `bin_size` `bin_mode` `def_value` `zoom` `progress` Identical to `read_values` method.
- `reduce` Method to aggregate values over span. Either "mean", "sd", "sem", "sum", "min" or "max". "mean" by default.

Outputs a numpy float32 array of shape (span//bin_size).

### Read BigBed entries

```python
reader = bigwig_io.Reader(path)
values = reader.read_entries(chr_ids, start, ends/span)
```

Parameters:
- `chr_ids` `starts` Chromosomes ids and starts of locations.
- `span` Reading window in bp from locations starts. 1 by default.
- `ends` Ends of locations. Takes precedence over `span` is specified. None by default.
- `progress` Function called during data extraction. Takes the extracted coverage and the total coverage in bp as parameters. None by default.

Outputs a list (locations) of list of entries (dict with at least "chr", "start" and "end" keys).

### Convert BigWig to bedGraph or WIG

```python
reader = bigwig_io.Reader(path)
reader.to_bedgraph(output_path)
reader.to_wig(output_path)
```

Parameters:
- `output_path` Path to output file.
- `chr_ids` Only extract data from these chromomes. All by default.
- `zoom` Zoom level to use. Full data by default.
- `progress` Function called during data extraction. Takes the extracted coverage and the total coverage in bp as parameters. None by default.

### Convert BigBed to BED

```python
reader = bigwig_io.Reader(path)
reader.to_bed(output_path)
```

Parameters:
- `output_path` `chr_ids` `progress` Identical to `to_bedgraph` and `to_wig` methods.
- `col_count` Only write this number of columns (eg, 3 for chr, start, end). All by default.
