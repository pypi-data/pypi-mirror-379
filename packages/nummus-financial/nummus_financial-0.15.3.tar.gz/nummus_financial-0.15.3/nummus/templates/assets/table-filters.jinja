{% if not only_inner %}
  <form
    id="valuation-filters"
    class="not-open:hidden bg-surface-container {{ 'open' if ctx.any_filters }} mx-auto mb-2 grid max-w-2xl grid-cols-2 gap-2 rounded-xl p-2 md:grid-cols-3"
    hx-indicator="#valuation-table,#valuation-indicator"
    hx-target="#valuation-table"
    {# innerHTML to preserve open state #}
    hx-swap-oob="{{ 'innerHTML' if oob }}"
    hx-include="#valuation-filters"
  >
    {% block inner %}
      <label class="input-outlined input-bg-surface-container">
        <select
          name="period"
          autocomplete="off"
          onchange="assets.changeTablePeriod()"
        >
          {% for label, value in ctx.options_period %}
            <option
              value="{{ value }}"
              {% if value == ctx.selected_period %}selected{% endif %}
            >
              {{ label }}
            </option>
          {% endfor %}
        </select>
        <div>
          <div>Date range</div>
        </div>
      </label>
      <label class="input-outlined input-bg-surface-container">
        <input
          id="valuation-filter-start"
          name="start"
          type="date"
          value="{{ ctx.start or '' }}"
          autocomplete="off"
          {% if ctx.selected_period != "custom" %}disabled{% endif %}
        />
        <div>
          <div>Start date</div>
        </div>
      </label>
      <label class="input-outlined input-bg-surface-container">
        <input
          id="valuation-filter-end"
          name="end"
          type="date"
          value="{{ ctx.end or '' }}"
          autocomplete="off"
          {% if ctx.selected_period != "custom" %}disabled{% endif %}
        />
        <div>
          <div>End date</div>
        </div>
      </label>
      <div class="col-span-full flex justify-around">
        <button
          class="btn-filled"
          hx-get="{{ url_for('assets.table', uri=ctx.uri) }}"
          hx-disabled-elt="this"
        >
          Apply filter
        </button>
        <button
          class="btn-text"
          type="button"
          hx-get="{{ url_for('assets.table', uri=ctx.uri) }}"
          hx-disabled-elt="this"
          hx-include="unset"
        >
          Clear all filters
        </button>
      </div>
    {% endblock inner %}
  </form>
{% else %}
  {{ self.inner() }}
{% endif %}
