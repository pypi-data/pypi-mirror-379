{% if not only_inner %}
  <form
    id="txn-filters"
    class="not-open:hidden bg-surface-container {{ 'open' if ctx.any_filters }} mx-auto mb-2 grid max-w-2xl grid-cols-2 gap-2 rounded-xl p-2 md:grid-cols-3"
    hx-indicator="#txn-table,#txn-indicator"
    {# innerHTML to preserve open state #}
    hx-swap-oob="{{ 'innerHTML' if oob }}"
    hx-include="#txn-filters,#txn-search"
  >
    {% block inner %}
      <label class="input-outlined input-bg-surface-container">
        <select
          name="period"
          autocomplete="off"
          hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
          hx-disabled-elt="this"
          hx-indicator="unset"
          hx-target="#txn-filters"
          onchange="txn.changePeriod()"
        >
          {% for item in ctx.options_period %}
            <option
              value="{{ item.key }}"
              {% if item.key == ctx.selected_period %}selected{% endif %}
            >
              {{ item.name }}
            </option>
          {% endfor %}
        </select>
        <div>
          <div>Date range</div>
        </div>
      </label>
      <label class="input-outlined input-bg-surface-container">
        <input
          id="txn-filter-start"
          name="start"
          type="date"
          value="{{ ctx.start or '' }}"
          autocomplete="off"
          {% if ctx.selected_period != "custom" %}disabled{% endif %}
          hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
          hx-trigger="blur changed"
          hx-disabled-elt="this"
          hx-indicator="unset"
          hx-target="#txn-filters"
        />
        <div>
          <div>Start date</div>
        </div>
      </label>
      <label class="input-outlined input-bg-surface-container">
        <input
          id="txn-filter-end"
          name="end"
          type="date"
          value="{{ ctx.end or '' }}"
          autocomplete="off"
          {% if ctx.selected_period != "custom" %}disabled{% endif %}
          hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
          hx-trigger="blur changed"
          hx-disabled-elt="this"
          hx-indicator="unset"
          hx-target="#txn-filters"
        />
        <div>
          <div>End date</div>
        </div>
      </label>
      {% if acct %}
        <div class="col-start-2 max-md:row-start-1 md:col-start-1"></div>
      {% else %}
        <label
          class="input-outlined input-bg-surface-container col-start-2 max-md:row-start-1 md:col-start-1"
        >
          <select
            name="account"
            autocomplete="off"
            {% if ctx.no_matches and not ctx.selected_account %}disabled{% endif %}
            hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
            hx-disabled-elt="this"
            hx-indicator="unset"
            hx-target="#txn-filters"
          >
            <option value=""></option>
            {% for item in ctx.options_account %}
              <option
                value="{{ item.key }}"
                {% if item.key == ctx.selected_account %}selected{% endif %}
              >
                {{ item.name }}
              </option>
            {% endfor %}
          </select>
          <div>
            <div>Account</div>
          </div>
        </label>
      {% endif %}
      <label class="input-outlined input-bg-surface-container col-span-2">
        <select
          name="category"
          autocomplete="off"
          {% if ctx.no_matches and not ctx.selected_category %}disabled{% endif %}
          hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
          hx-disabled-elt="this"
          hx-indicator="unset"
          hx-target="#txn-filters"
          onkeyup="onSelectKey(event)"
        >
          <option value=""></option>
          {% with category_groups=ctx.options_category, selected_uri=ctx.selected_category %}
            {% include "shared/category-options.jinja" %}
          {% endwith %}
        </select>
        <div>
          <div>Category</div>
        </div>
      </label>
      <label class="toggle col-span-full col-start-1 mx-auto gap-4">
        <input
          name="uncleared"
          type="checkbox"
          {% if ctx.uncleared %}checked{% endif %}
          autocomplete="off"
          hx-get="{{ url_for(endpoint + '_options',  **url_args) }}"
          hx-disabled-elt="this"
          hx-indicator="unset"
          hx-target="#txn-filters"
        />
        <div>Only uncleared</div>
        <switch></switch>
      </label>
      <div class="col-span-full flex justify-around" hx-target="#txn-table">
        <button
          class="btn-filled"
          hx-get="{{ url_for(endpoint,  **url_args) }}"
          hx-disabled-elt="this"
        >
          Apply filter
        </button>
        <button
          class="btn-text"
          type="button"
          hx-get="{{ url_for(endpoint,  **url_args) }}"
          hx-disabled-elt="this"
          hx-include="unset"
        >
          Clear all filters
        </button>
      </div>
    {% endblock inner %}
  </form>
{% else %}
  {{ self.inner() }}
{% endif %}
