import numpy as np
from scipy.stats import genextreme

from . import utils as cp_utils


def gev_fd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,i] = -v3*(-1 - 1/v3)*(1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2**2*(1 + v3*(-v1 + x)/v2)) - (1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2**2*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[1,i] = -(1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/v2**2 - v3*(-1 - 1/v3)*(1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*(-v1 + x)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2**3*(1 + v3*(-v1 + x)/v2)) - (1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*(-v1 + x)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2**3*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[2,i] = (1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*(np.log(1 + v3*(-v1 + x)/v2)/v3**2 + (-1 - 1/v3)*(-v1 + x)/(v2*(1 + v3*(-v1 + x)/v2)))*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/v2 - (1 + v3*(-v1 + x)/v2)**(-1 - 1/v3)*(np.log(1 + v3*(-v1 + x)/v2)/v3**2 - (-v1 + x)/(v2*v3*(1 + v3*(-v1 + x)/v2)))*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
	if len(x_all) == 1:
		result = result[:,0]
	return result 

def gev_fdd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim,dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,0,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(v3**2*(1 + 1/v3)*(2 + 1/v3) - 2*v3*(1 + 1/v3)/(1 - v3*(v1 - x)/v2)**(1/v3) - (v3 + 1 - 1/(1 - v3*(v1 - x)/v2)**(1/v3))/(1 - v3*(v1 - x)/v2)**(1/v3))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**3*(1 - v3*(v1 - x)/v2)**2)
		result[0,1,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(-2*v3*(1 + 1/v3) + 2/(1 - v3*(v1 - x)/v2)**(1/v3) - v3**2*(1 + 1/v3)**2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(2/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**3*(1 - v3*(v1 - x)/v2))
		result[0,2,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(v3*(1 + 1/v3)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2))) - (1 + 1/v3)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) + 1 - (np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(2/v3)) + v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[1,0,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(-2*v3*(1 + 1/v3) + 2/(1 - v3*(v1 - x)/v2)**(1/v3) - v3**2*(1 + 1/v3)**2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(2/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**3*(1 - v3*(v1 - x)/v2))
		result[1,1,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(2 + v3*(1 + 1/v3)*(v1 - x)*(2 + v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)*(2 + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/v2**3
		result[1,2,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*((np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - np.log(1 - v3*(v1 - x)/v2)/v3**2 - v3*(1 + 1/v3)*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)) - 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (1 + 1/v3)*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(2/v3)) - v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/v2**2
		result[2,0,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*(v3*(1 + 1/v3)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2))) - (1 + 1/v3)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) + 1 - (np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(2/v3)) + v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[2,1,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*((np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - np.log(1 - v3*(v1 - x)/v2)/v3**2 - v3*(1 + 1/v3)*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)) - 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (1 + 1/v3)*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(2/v3)) - v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/v2**2
		result[2,2,i] = (1 - v3*(v1 - x)/v2)**(-1 - 1/v3)*((np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2 - 2*(np.log(1 - v3*(v1 - x)/v2)/v3**2 + (1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (-(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/v3 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*np.log(1 - v3*(v1 - x)/v2)/v3**3 - 2*(v1 - x)/(v2*v3**2*(1 - v3*(v1 - x)/v2)) + (1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/v2
	if len(x_all) == 1:
		result = result[:,:,0]
	return result 

def gev_pd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,i] = -np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[1,i] = -(-v1 + x)*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(v2**2*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[2,i] = -(np.log(1 + v3*(-v1 + x)/v2)/v3**2 - (-v1 + x)/(v2*v3*(1 + v3*(-v1 + x)/v2)))*np.exp(-1/(1 + v3*(-v1 + x)/v2)**(1/v3))/(1 + v3*(-v1 + x)/v2)**(1/v3) 
	if len(x_all) == 1:
		result = result[:,0]
	return result 

def gev_pdd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim,dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,0,i] = (-v3 - 1 + (1 - v3*(v1 - x)/v2)**(-1/v3))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[0,1,i] = (1 + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[0,2,i] = (-(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/v3 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[1,0,i] = (1 + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[1,1,i] = (v1 - x)*(-2 - v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[1,2,i] = (v1 - x)*((np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/v3 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[2,0,i] = (-(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/v3 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[2,1,i] = (v1 - x)*((np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/v3 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3))
		result[2,2,i] = (-(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/v3 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))*np.exp(-1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3))
	if len(x_all) == 1:
		result = result[:,:,0]
	return result 

def gev_logfd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,i] = v3*(1 + 1/v3)/(v2*(1 + v3*(-v1 + x)/v2)) - 1/(v2*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[1,i] = -1/v2 + v3*(1 + 1/v3)*(-v1 + x)/(v2**2*(1 + v3*(-v1 + x)/v2)) - (-v1 + x)/(v2**2*(1 + v3*(-v1 + x)/v2)*(1 + v3*(-v1 + x)/v2)**(1/v3)) 
		result[2,i] = -(np.log(1 + v3*(-v1 + x)/v2)/v3**2 - (-v1 + x)/(v2*v3*(1 + v3*(-v1 + x)/v2)))/(1 + v3*(-v1 + x)/v2)**(1/v3) + np.log(1 + v3*(-v1 + x)/v2)/v3**2 - (1 + 1/v3)*(-v1 + x)/(v2*(1 + v3*(-v1 + x)/v2)) 
	if len(x_all) == 1:
		result = result[:,0]
	return result 

def gev_logfdd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim,dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,0,i] = (v3**2*(1 + 1/v3) - v3/(1 - v3*(v1 - x)/v2)**(1/v3) - 1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**2*(1 - v3*(v1 - x)/v2)**2)
		result[0,1,i] = (-v3*(1 + 1/v3) + (1 - v3*(v1 - x)/v2)**(-1/v3) - v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[0,2,i] = (1 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2))
		result[1,0,i] = (-v3*(1 + 1/v3) + (1 - v3*(v1 - x)/v2)**(-1/v3) - v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[1,1,i] = (1 + 2*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/v2**2
		result[1,2,i] = (v1 - x)*(-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[2,0,i] = (1 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2))
		result[2,1,i] = (v1 - x)*(-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2))
		result[2,2,i] = (2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*np.log(1 - v3*(v1 - x)/v2)/v3**3 - 2*(v1 - x)/(v2*v3**2*(1 - v3*(v1 - x)/v2)) + (1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2)
	if len(x_all) == 1:
		result = result[:,:,0]
	return result 

def gev_logfddd(x_all, v1, v2, v3): 
	#Automatically generated code.
	dim=3 
	if not (isinstance(x_all, list) or isinstance(x_all, np.ndarray)):
		x_all=[x_all]
	result = np.zeros((dim, dim, dim, len(x_all)))
	for i in range(len(x_all)):
		x = x_all[i]
		result[0,0,0,i] = (2*v3**3*(1 + 1/v3) - 2*v3**2/(1 - v3*(v1 - x)/v2)**(1/v3) - 3*v3/(1 - v3*(v1 - x)/v2)**(1/v3) - 1/(1 - v3*(v1 - x)/v2)**(1/v3))/(v2**3*(1 - v3*(v1 - x)/v2)**3) 
		result[0,0,1,i] = (-2*v3**2*(1 + 1/v3) + 2*v3/(1 - v3*(v1 - x)/v2)**(1/v3) + 2/(1 - v3*(v1 - x)/v2)**(1/v3) - 2*v3**3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3**2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 3*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)**2) 
		result[0,0,2,i] = (2*v3*(1 + 1/v3) - 1 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) - 1/(1 - v3*(v1 - x)/v2)**(1/v3) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)**2) 
		result[0,1,0,i] = (-2*v3**2*(1 + 1/v3) + 2*v3/(1 - v3*(v1 - x)/v2)**(1/v3) + 2/(1 - v3*(v1 - x)/v2)**(1/v3) - 2*v3**3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3**2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 3*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)**2) 
		result[0,1,1,i] = (2*v3*(1 + 1/v3) - 2/(1 - v3*(v1 - x)/v2)**(1/v3) + 4*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 4*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 4*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3**2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[0,1,2,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[0,2,0,i] = (2*v3*(1 + 1/v3) - 1 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) - 1/(1 - v3*(v1 - x)/v2)**(1/v3) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)**2) 
		result[0,2,1,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[0,2,2,i] = ((2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2)) 
		result[1,0,0,i] = (-2*v3**2*(1 + 1/v3) + 2*v3/(1 - v3*(v1 - x)/v2)**(1/v3) + 2/(1 - v3*(v1 - x)/v2)**(1/v3) - 2*v3**3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*v3**2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 3*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)**2) 
		result[1,0,1,i] = (2*v3*(1 + 1/v3) - 2/(1 - v3*(v1 - x)/v2)**(1/v3) + 4*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 4*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 4*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3**2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[1,0,2,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[1,1,0,i] = (2*v3*(1 + 1/v3) - 2/(1 - v3*(v1 - x)/v2)**(1/v3) + 4*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 4*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 4*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3**2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[1,1,1,i] = (-2 - 6*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 6*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 6*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 6*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 6*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**3*(1 + 1/v3)*(v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3) + 2*v3**2*(v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 3*v3*(v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3*(1 - v3*(v1 - x)/v2)**(1/v3)))/v2**3 
		result[1,1,2,i] = (v1 - x)*(2 - 2*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 4*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[1,2,0,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[1,2,1,i] = (v1 - x)*(2 - 2*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 4*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[1,2,2,i] = (v1 - x)*(-(2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[2,0,0,i] = (2*v3*(1 + 1/v3) - 1 - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(1 - v3*(v1 - x)/v2)**(1/v3) - 1/(1 - v3*(v1 - x)/v2)**(1/v3) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*v3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)**2) 
		result[2,0,1,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[2,0,2,i] = ((2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2)) 
		result[2,1,0,i] = (-1 + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[2,1,1,i] = (v1 - x)*(2 - 2*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 4*v3*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 3*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - (v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3**2*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*v3*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**3*(1 - v3*(v1 - x)/v2)) 
		result[2,1,2,i] = (v1 - x)*(-(2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[2,2,0,i] = ((2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) + 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) - 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2*(1 - v3*(v1 - x)/v2)) 
		result[2,2,1,i] = (v1 - x)*(-(2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**2/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*(1 + 1/v3)*(v1 - x)/(v2*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) + 2*(v1 - x)*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))/(v2*v3*(1 - v3*(v1 - x)/v2)*(1 - v3*(v1 - x)/v2)**(1/v3)) - 2*v3*(1 + 1/v3)*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2) + 2*(v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2*(1 - v3*(v1 - x)/v2)**(1/v3)))/(v2**2*(1 - v3*(v1 - x)/v2)) 
		result[2,2,2,i] = -(6*np.log(1 - v3*(v1 - x)/v2)/v3**3 + 6*(v1 - x)/(v2*v3**2*(1 - v3*(v1 - x)/v2)) - 3*(v1 - x)**2/(v2**2*v3*(1 - v3*(v1 - x)/v2)**2) + 2*(v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3))/(v3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 3*(np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))*(2*np.log(1 - v3*(v1 - x)/v2)/v3**2 + 2*(v1 - x)/(v2*v3*(1 - v3*(v1 - x)/v2)) - (v1 - x)**2/(v2**2*(1 - v3*(v1 - x)/v2)**2))/(v3**2*(1 - v3*(v1 - x)/v2)**(1/v3)) - (np.log(1 - v3*(v1 - x)/v2)/v3 + (v1 - x)/(v2*(1 - v3*(v1 - x)/v2)))**3/(v3**3*(1 - v3*(v1 - x)/v2)**(1/v3)) + 6*np.log(1 - v3*(v1 - x)/v2)/v3**4 + 6*(v1 - x)/(v2*v3**3*(1 - v3*(v1 - x)/v2)) - 3*(v1 - x)**2/(v2**2*v3**2*(1 - v3*(v1 - x)/v2)**2) + 2*(1 + 1/v3)*(v1 - x)**3/(v2**3*(1 - v3*(v1 - x)/v2)**3) 
	if len(x_all) == 1:
		result = result[:,:,:,0]
	return result 



# The first derivative of the density
def gev_f1fa(x, v1, v2, v3):
    v3 = cp_utils.movexiawayfromzero(v3)
    temp = gev_fd(x,v1,v2,v3)
    return temp


# The second derivative of the density
def gev_f2fa(x, v1, v2, v3):
    v3 = cp_utils.movexiawayfromzero(v3)
    f2 = gev_fdd(x, v1, v2, v3)
    return f2


# Minus the first derivative of the cdf, at alpha
def gev_mu1fa(alpha, v1, v2, v3):
    x = genextreme.ppf((1-alpha), -v3, loc=v1, scale=v2)
    v3 = cp_utils.movexiawayfromzero(v3)
    mu1 = -gev_pd(x, v1, v2, v3)
    return mu1


# Minus the second derivative of the cdf, at alpha
def gev_mu2fa(alpha, v1, v2, v3):
    x = genextreme.ppf((1-alpha), -v3, loc=v1, scale=v2)
    v3 = cp_utils.movexiawayfromzero(v3)
    mu2 = -gev_pdd(x, v1, v2, v3)
    return mu2


# The first derivative of the normalized log-likelihood
def gev_lda(x, v1, v2, v3):
    v3 = cp_utils.movexiawayfromzero(v3)
    ld =gev_logfd(x,v1,v2,v3)
    return ld


# The second derivative of the normalized log-likelihood
def gev_ldda(x, v1, v2, v3):
    v3 = cp_utils.movexiawayfromzero(v3)
    temp1 = gev_logfdd(x,v1,v2,v3)
    ldd = np.sum(temp1, axis=-1) / len(x)
    return ldd


# The third derivative of the normalized log-likelihood
def gev_lddda(x, v1, v2, v3):
    v3 = cp_utils.movexiawayfromzero(v3)
    temp1 = gev_logfddd(x,v1,v2,v3)
    lddd = np.sum(temp1, axis=-1) / len(x)
    return lddd


# The combined derivative of the normalized log-likelihood
def gev_ld12a(x, v1, v2, v3):
    nx = len(x)
    v3 = cp_utils.movexiawayfromzero(v3) 

    ld1  =gev_logfd(x,v1,v2,v3) 
    ld2 = gev_logfdd(x,v1,v2,v3)
    dim = 3
    ld12 = np.zeros((dim, dim, dim))
    for j in range(dim):
        for s in range(dim):
            for r in range(dim):
                for i in range(nx):
                    ld12[j, s, r] = ld12[j, s, r] + (ld2[j, s, i] * ld1[r, i] / nx)
    return ld12