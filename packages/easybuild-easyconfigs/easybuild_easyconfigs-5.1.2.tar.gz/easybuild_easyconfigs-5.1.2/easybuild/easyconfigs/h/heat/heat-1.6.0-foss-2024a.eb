easyblock = 'PythonPackage'

name = 'heat'
version = '1.6.0'

homepage = 'https://github.com/helmholtz-analytics/heat'
description = """
Heat builds on PyTorch and mpi4py to provide high-performance computing infrastructure for
memory-intensive applications within the NumPy/SciPy ecosystem.
"""

toolchain = {'name': 'foss', 'version': '2024a'}

source_urls = ['https://pypi.python.org/packages/source/h/%(name)s']
sources = [SOURCELOWER_TAR_GZ]
patches = ['heat-1.6.0-license-fix.patch', 'heat-1.6.0-scipy-version.patch']
checksums = [
    {'%(name)s-%(version)s.tar.gz': 'cd011e67c284b7f94d0f1c6ff8bf5309535fa26a895b0db2df83290c47dae55b'},
    {'heat-1.6.0-license-fix.patch': '89534b27af1dd3b260835e982d2a0df7ef823715b31fd4f92d14cd83c10314e2'},
    {'heat-1.6.0-scipy-version.patch': 'f5ce3b07da1ad984b0fff2a2c9a41583be155a8b05bf1a1a1af0499443aff849'}
]

dependencies = [
    ('Python', '3.12.3'),
    ('PyTorch', '2.6.0'),
    ('torchvision', '0.21.0'),
    ('SciPy-bundle', '2024.05'),
    ('Pillow-SIMD', '10.4.0'),
    ('mpi4py', '4.0.1'),
]

# `import heat` requires a valid MPI environment and an accessible CUDA device.
options = {'modulename': False}

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python%(pyshortver)s/site-packages/heat']
}

moduleclass = 'lib'
