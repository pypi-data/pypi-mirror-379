easyblock = 'ConfigureMake'

name = 'libtommath'
version = '1.3.0'

homepage = 'https://www.libtom.net/LibTomMath/'
description = """
LibTomMath is a free open source portable number theoretic
multiple-precision integer (MPI) library written entirely in C.
"""

toolchain = {'name': 'GCCcore', 'version': '14.3.0'}

github_account = 'libtom'
source_urls = [GITHUB_SOURCE]
sources = ['v%(version)s.tar.gz']
checksums = ['6d099e93ff00fa9b18346f4bcd97dcc48c3e91286f7e16c4ac5515a7171c3149']

builddependencies = [
    ('binutils', '2.44'),
    ('Autotools', '20250527'),  # for libtool
]

skipsteps = ['configure']

prebuildopts = 'sed -i -e "s/644 $(LIBNAME)/755 $(LIBNAME)/g" makefile.shared && '
buildopts = ['-f makefile.shared ', '-f makefile ']
installopts = ['-f makefile.shared PREFIX=%(installdir)s ', '-f makefile PREFIX=%(installdir)s ']

sanity_check_paths = {
    'files': ['include/tommath.h',
              'lib/libtommath.a',
              f'lib/libtommath.{SHLIB_EXT}'],
    'dirs': ['lib/pkgconfig'],
}

moduleclass = 'lib'
