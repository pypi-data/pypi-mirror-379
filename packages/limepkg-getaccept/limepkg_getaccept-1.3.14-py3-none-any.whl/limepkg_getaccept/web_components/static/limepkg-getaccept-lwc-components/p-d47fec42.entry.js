import{r as t,c as e,h as i,g as s}from"./p-02d8d51b.js";import{E as o}from"./p-76213b98.js";import{f as n,a,b as l,r as c}from"./p-de3a71d2.js";import{w as h}from"./p-f52cd8c2.js";const r="limel-dialog{--dialog-heading-icon-background-color:#f49132}limel-dialog.preview-view{--dialog-width:35rem;--dialog-height:45rem}limel-dialog.aside{--dialog-width:34rem}limel-dialog .ga-version{position:absolute;top:0;right:50px}limel-dialog .ga-body{overflow:auto;min-height:100%;margin-top:1rem}limel-dialog .ga-top-bar{position:sticky;top:0;height:5rem;background-color:rgb(var(--contrast-100));z-index:4;display:flex;align-items:center;z-index:9}@media (min-width: 1074px){limel-dialog{--dialog-width:65rem;--dialog-height:40rem}}@media (max-width: 1075px){limel-dialog{--dialog-width:55rem;--dialog-height:40rem}}@media (min-width: 1800px){limel-dialog{--dialog-width:70rem;--dialog-height:60rem}}limel-button{--lime-primary-color:#f49132}.logo-container{height:2.2rem;width:15rem;margin-bottom:1rem;cursor:pointer;transition:width 0.5s;overflow:hidden}.logo-container.compact{width:2.5rem}.logo-container:hover{opacity:0.8}.logo-container .logo{height:2.2rem}.close{display:block;position:absolute;right:-1rem;top:0rem;cursor:pointer}.close:hover{color:#eee}.actionpad-container{width:100%}.getaccept-button{width:100%;display:flex;justify-content:start;align-items:center;padding:0.425rem 0.875rem 0.425rem 0.875rem;border:none;border-radius:2rem;cursor:pointer;transition:background 0.8s;background-position:center;font-size:0.8rem;font-weight:bold;color:#444;background:#eee}.getaccept-button:focus{outline:0}.getaccept-button:hover{background:#f5f5f5 radial-gradient(circle, transparent 1%, #f5f5f5 1%) center/15000%}.getaccept-button:active{background-color:white;background-size:100%;transition:background 0s}.getaccept-button img{height:2rem;flex:0}.getaccept-button .button-text{margin-left:0.5rem;flex:2;text-align:left}.getaccept-button .document-count{margin-left:auto;display:flex;align-items:center}.getaccept-button .document-count limel-icon{margin-right:0.3rem}workflow-progress-bar{position:absolute;top:1.5rem;left:4rem;right:4rem}";const d=r;const u=class{constructor(i){t(this,i);this.errorHandler=e(this,"errorHandler",7);this.platform=undefined;this.context=undefined;this.company=undefined;this.externalId=undefined;this.isOpen=false;this.session=undefined;this.user=undefined;this.entities=[];this.documentId=undefined;this.activeView=o.login;this.documentData=undefined;this.isSealed=undefined;this.template=undefined;this.limeDocument=undefined;this.templateFields=undefined;this.templateRoles=undefined;this.errorMessage="";this.documents=[];this.isLoadingDocuments=undefined;this.isSending=false;this.openDialog=this.openDialog.bind(this);this.handleLogoClick=this.handleLogoClick.bind(this);this.renderLayout=this.renderLayout.bind(this);this.loadInitialData=this.loadInitialData.bind(this);this.loadSentDocuments=this.loadSentDocuments.bind(this);this.showWorkflow=this.showWorkflow.bind(this)}componentWillLoad(){this.externalId=`${this.context.limetype}_${this.context.id}`;this.activeView=this.checkIfSessionExists?o.home:o.login;if(this.session){this.loadInitialData()}this.setDefaultDocumentData()}async loadInitialData(){this.loadSentDocuments();try{const{user:t,entities:e}=await n(this.platform,this.session);this.user=t;this.entities=e}catch(t){this.errorHandler.emit("Could not load user session. Try relogging")}this.loadEntityDetails()}async loadEntityDetails(){try{const{entity:t}=await a(this.platform,this.session);this.session.entity_id=t.id;this.documentData.email_send_message=t.email_send_message!==""?t.email_send_message:t.default_email_send_message;this.documentData.email_send_subject=t.email_send_subject!==""?t.email_send_subject:t.default_email_send_subject}catch(t){this.errorHandler.emit("Could not load user session. Try relogging")}}render(){return[i("limel-flex-container",{key:"fbeb6317b6240426b71f28d92e65c463234d18e5",class:"actionpad-container"},i("button",{key:"803aa1e17fb61f4d1a5110d41aa8122069e7d622",class:"getaccept-button",onClick:this.openDialog},i("img",{key:"3d5cd8e96f36e574d4e43c640c7268f7ce8c350b",src:"https://static-vue-rc.getaccept.com/img/integrations/logo_only.png"}),i("span",{key:"03cb3179518ca8ddeae70ffa2c7503698fea5cf2",class:"button-text"},"Send document"),this.renderDocumentCount(!!this.session))),i("limel-dialog",{key:"1c9838054bd8cb206070a52e7b9738710f8bae1d",open:this.isOpen,closingActions:{escapeKey:true,scrimClick:false},onClose:()=>{this.isOpen=false},class:{aside:this.checkIsAside()}},i("div",{key:"287204612d9e1011ebd778fcdbc5ccb38886344c",class:"ga-top-bar"},this.renderLogo(this.showWorkflow()),i("limel-icon",{key:"4be4bc4dbeb583b1845bae71aa699afa28016ded",class:"close",name:"cancel",size:"small",onClick:()=>{this.isOpen=false}}),(()=>{if(this.activeView!==o.login){return[i("layout-menu",{activeView:this.activeView,isSending:this.isSending}),i("workflow-progress-bar",{isVisible:this.showWorkflow(),activeView:this.activeView})]}})()),i("div",{key:"d3cd2c6dee77432ded9b2d228518a8df4bd553bf",class:"ga-body"},this.renderLayout()),i("div",{key:"92baf0e4e5394361ad2e9c38bbcc80897f6771f3",class:"ga-version"},i("span",{key:"8d00157e0e0a8a42e54a69780a8f8250f5be3e24"},"Version: 1.3.13")),i("limel-button-group",{key:"f10868e722a00d6a31f410e64966ea8fbd0e28b4",slot:"button"},i("limel-button",{key:"b28504cdcc8f8db75a5a8b85d246a62f4bc5c5ce",label:"Cancel",onClick:()=>{this.isOpen=false}})),i("error-message",{key:"e4ca6f8b2d0e6162fd2768cd7dccd96068c7f7f8",error:this.errorMessage}))]}checkIsAside(){var t,e,i,s,o,n,a,l,c,h,r,d;return((d=(r=(h=(c=(l=(a=(n=(o=(s=(i=(e=(t=this.element.parentNode)===null||t===void 0?void 0:t.parentNode)===null||e===void 0?void 0:e.parentNode)===null||i===void 0?void 0:i.parentNode)===null||s===void 0?void 0:s.host)===null||o===void 0?void 0:o.parentNode)===null||n===void 0?void 0:n.parentNode)===null||a===void 0?void 0:a.host)===null||l===void 0?void 0:l.parentNode)===null||c===void 0?void 0:c.parentNode)===null||h===void 0?void 0:h.host)===null||r===void 0?void 0:r.parentNode)===null||d===void 0?void 0:d.tagName)==="ASIDE"}renderDocumentCount(t){if(t){return i("span",{class:"document-count"},i("limel-icon",{name:"file",size:"small"}),i("span",null,this.documents.length))}return[]}renderLogo(t){const e=`logo-container ${t?"compact":""}`;return i("div",{class:e},i("img",{onClick:this.handleLogoClick,src:"https://static-vue-rc.getaccept.com/img/integrations/logo-inverted.png",class:"logo"}))}showWorkflow(){if(this.isSending||this.isSealed){return false}return h.some((t=>t.currentView===this.activeView))}renderLayout(){switch(this.activeView){case o.home:return i("layout-overview",{platform:this.platform,session:this.session,externalId:this.externalId,documents:this.documents,isAside:this.checkIsAside()});case o.login:return i("layout-login",{platform:this.platform});case o.selectFile:return i("layout-select-file",{platform:this.platform,session:this.session,context:this.context,selectedLimeDocument:this.limeDocument,selectedTemplate:this.template,customFields:this.templateFields,templateRoles:this.templateRoles});case o.templateRoles:return i("layout-template-roles",{platform:this.platform,session:this.session,context:this.context,document:this.documentData,limeDocument:this.limeDocument,template:this.template,templateRoles:this.templateRoles});case o.recipient:return i("layout-select-recipient",{platform:this.platform,document:this.documentData,context:this.context,isAside:this.checkIsAside()});case o.settings:return i("layout-settings",{user:this.user,entities:this.entities,session:this.session,platform:this.platform});case o.help:return i("layout-help",null);case o.sendDocument:return i("layout-send-document",{context:this.context,document:this.documentData,limeDocument:this.limeDocument,template:this.template,session:this.session,platform:this.platform});case o.videoLibrary:return i("layout-video-library",{platform:this.platform,session:this.session});case o.documentDetail:return i("layout-document-details",{platform:this.platform,session:this.session,documentId:this.documentId});case o.documentValidation:return i("layout-validate-document",{platform:this.platform,session:this.session,document:this.documentData,limeDocument:this.limeDocument,template:this.template,fields:this.templateFields,isSealed:this.isSealed,isSending:this.isSending,templateRoles:this.templateRoles});default:return i("layout-overview",null)}}logout(){localStorage.removeItem("getaccept_session");this.documents=[];this.activeView=o.login}openDialog(){this.isOpen=true;if(this.checkIsPreviewView){this.element.shadowRoot.lastElementChild.classList.add("preview-view")}}handleLogoClick(){this.activeView=this.checkIfSessionExists?o.home:o.login}async loadSentDocuments(){this.isLoadingDocuments=true;try{this.documents=await l(this.platform,this.externalId,this.session)}catch(t){this.errorHandler.emit("Something went wrong while documents from GetAccept...")}this.isLoadingDocuments=false}changeViewHandler(t){if(t.detail===o.logout){this.logout()}else if(this.isSealed){this.activeView=o.home;this.setDefaultDocumentData()}else{this.activeView=t.detail}}loadRealtedDocumentsHandler(){this.loadSentDocuments()}setTemplate(t){this.template=t.detail;this.documentData.name=t.detail.text;this.limeDocument=null;this.templateFields=[]}setLimeDocument(t){this.limeDocument=t.detail;this.documentData.name=t.detail.text;this.template=null;this.templateRoles=null;this.templateFields=[]}setCustomFields(t){this.templateFields=t.detail}setTemplateRoles(t){this.templateRoles=t.detail;this.documentData=Object.assign(Object.assign({},this.documentData),{recipients:this.documentData.recipients.map((t=>Object.assign(Object.assign({},t),{role_id:""})))})}updateDocumentRecipientHandler(t){this.documentData.recipients=t.detail}documentTypeHandler(t){this.documentData.is_signing=t.detail}setSessionHandler(t){this.setSessionData(t.detail);this.activeView=o.home;this.loadInitialData()}setDocumentName(t){this.documentData=Object.assign(Object.assign({},this.documentData),{name:t.detail})}setDocumentValue(t){this.documentData=Object.assign(Object.assign({},this.documentData),{value:t.detail})}setDocumentSmartReminder(t){this.documentData.is_reminder_sending=t.detail}setDocumentIsSmsSending(t){this.documentData.is_sms_sending=t.detail}setDocumentEmailSubject(t){this.documentData.email_send_subject=t.detail}setDocumentEmailMessage(t){this.documentData.email_send_message=t.detail}validateDocumentHandler(){this.activeView=o.documentValidation}openDocumentDetails(t){this.activeView=o.documentDetail;this.documentId=t.detail.id}updateRecipientRole(t){const e=[...this.documentData.recipients];const i=e.findIndex((e=>e.email===t.detail.recipient.email&&e.lime_id===t.detail.recipient.lime_id));e[i].role_id=t.detail.role.role_id;this.documentData=Object.assign(Object.assign({},this.documentData),{recipients:[...e]})}setDocumentVideo(t){this.documentData.video_id=t.detail;this.documentData.is_video=true}removeDocumentVideo(){this.documentData.video_id="";this.documentData.is_video=false}setIsSending(t){this.isSending=t.detail}documentCompleted(t){this.setDefaultDocumentData();this.loadEntityDetails();this.isSealed=t.detail;if(!this.isSealed){this.activeView=o.home}this.loadSentDocuments()}onError(t){this.errorMessage=t.detail;setTimeout((()=>this.errorMessage=""),100)}get checkIfSessionExists(){const t=window.localStorage.getItem("getaccept_session");if(t){const e=JSON.parse(t);this.validateToken(e);this.session=e}return!!t}get checkIsPreviewView(){return document.querySelector("lime-webclient").shadowRoot.activeElement.classList.contains("has-side-panel-open")}async validateToken(t){try{const{data:e,success:i}=await c(this.platform,t);if(i){const t=window.localStorage.getItem("getaccept_session");if(t){const i=JSON.parse(t);i.expires_in=e.expires_in;i.access_token=e.access_token;this.setSessionData(i)}}else{this.errorMessage="Could not refresh token.";setTimeout((()=>this.errorMessage=""))}}catch(t){this.errorMessage="Could not refresh token.";setTimeout((()=>this.errorMessage=""));this.logout()}return true}setSessionData(t){window.localStorage.setItem("getaccept_session",JSON.stringify(t));this.session=t}setDefaultDocumentData(){this.documentData={is_signing:false,name:"",recipients:[],template_id:"",custom_fields:[],is_reminder_sending:false,is_sms_sending:false,email_send_subject:"",email_send_message:"",video_id:"",is_video:false,external_id:this.externalId,value:0};this.templateFields=[];this.isSealed=false;this.template=null;this.limeDocument=null}get element(){return s(this)}};u.style=d;export{u as lwc_getaccept_root};
//# sourceMappingURL=p-d47fec42.entry.js.map