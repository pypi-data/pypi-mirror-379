{"version":3,"file":"layout-send-document.js","sourceRoot":"","sources":["../../../src/components/layout-send-document/layout-send-document.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, State, Prop, Event, EventEmitter } from '@stencil/core';\nimport { IDocument } from '../../types/Document';\nimport { EnumViews } from '../../models/EnumViews';\nimport { IListItem } from '../../types/ListItem';\nimport {\n    LimeWebComponentContext,\n    LimeWebComponentPlatform,\n} from '@limetech/lime-web-components';\nimport { ISession } from '../../types/Session';\nimport { fetchDealValue } from 'src/services';\n\n@Component({\n    tag: 'layout-send-document',\n    shadow: true,\n    styleUrl: 'layout-send-document.scss',\n})\nexport class LayoutSendDocument {\n    @Prop() public document: IDocument;\n    @Prop() public template: IListItem;\n    @Prop() public limeDocument: IListItem;\n    @Prop() public platform: LimeWebComponentPlatform;\n    @Prop() public session: ISession;\n    @Prop() public context: LimeWebComponentContext;\n\n    @Event() setNewDocumentName: EventEmitter<string>;\n    @Event() setDocumentValue: EventEmitter<number>;\n    @Event() setIsSmsSending: EventEmitter<boolean>;\n    @Event() setSmartReminder: EventEmitter<boolean>;\n    @Event() private errorHandler: EventEmitter<string>;\n\n    @State() private documentName: string = '';\n    @State() private value: number = 0;\n    @State() private smartReminder: boolean = false;\n    @State() private sendLinkBySms: boolean = false;\n    @State() private documentVideo: boolean = false;\n\n    @Event() changeView: EventEmitter;\n    @Event() removeVideo: EventEmitter;\n\n    async componentWillLoad() {\n        this.documentName = this.fileName();\n        this.setNewDocumentName.emit(this.documentName);\n        this.value = this.document.value || 0;\n        this.smartReminder = this.document.is_reminder_sending;\n        this.sendLinkBySms = this.document.is_sms_sending;\n        this.documentVideo = this.document.video_id !== '';\n        await this.loadObjectValue();\n    }\n\n    componentDidUpdate() {\n        this.value = this.document.value;\n        this.documentName = this.document.name || this.fileName();\n    }\n\n    constructor() {\n        this.handleChangeDocumentName =\n            this.handleChangeDocumentName.bind(this);\n        this.handleChangeValue = this.handleChangeValue.bind(this);\n        this.handleChangeSmartReminder =\n            this.handleChangeSmartReminder.bind(this);\n        this.handleChangeSendLinkBySms =\n            this.handleChangeSendLinkBySms.bind(this);\n        this.handleAddVideo = this.handleAddVideo.bind(this);\n        this.handleRemoveVideo = this.handleRemoveVideo.bind(this);\n    }\n\n    public render() {\n        return [\n            <div class=\"send-document-container\">\n                <div class=\"send-document-prepare-container\">\n                    <h3>Prepare sending</h3>\n                    <limel-flex-container align=\"stretch\">\n                        <limel-input-field\n                            label=\"Document Name\"\n                            value={this.documentName}\n                            onChange={this.handleChangeDocumentName}\n                        />\n                        <limel-input-field\n                            label=\"Value\"\n                            value={this.value.toString()}\n                            onChange={this.handleChangeValue}\n                        />\n                    </limel-flex-container>\n                    <div>\n                        <h4>Document engagement</h4>\n                        {this.documentVideo ? (\n                            <div>\n                                <div class=\"video-is-added\">\n                                    <limel-icon\n                                        name=\"tv_show\"\n                                        size=\"large\"\n                                        class=\"video-is-added-icon\"\n                                    />\n                                    <span>Video is added</span>\n                                    <limel-icon\n                                        class=\"video-remove-icon\"\n                                        name=\"multiply\"\n                                        size=\"small\"\n                                        onClick={this.handleRemoveVideo}\n                                    />\n                                </div>\n                            </div>\n                        ) : (\n                            <limel-button\n                                class=\"add-video-button\"\n                                primary={true}\n                                label=\"Add Video introduction\"\n                                onClick={this.handleAddVideo}\n                            />\n                        )}\n\n                        <limel-checkbox\n                            label=\"Send smart reminders\"\n                            id=\"SmartReminder\"\n                            checked={this.smartReminder}\n                            onChange={this.handleChangeSmartReminder}\n                        />\n                        <limel-checkbox\n                            label=\"Send link by SMS\"\n                            id=\"SendLinkBySMS\"\n                            checked={this.sendLinkBySms}\n                            onChange={this.handleChangeSendLinkBySms}\n                        />\n                    </div>\n                </div>\n                <div class=\"send-document-email-container\">\n                    <create-email document={this.document} />\n                </div>\n            </div>,\n        ];\n    }\n\n    async loadObjectValue() {\n        // eslint-disable-next-line camelcase\n        const { id: record_id, limetype } = this.context;\n\n        try {\n            const value = await fetchDealValue(\n                this.platform,\n                this.session,\n                limetype,\n                record_id\n            );\n\n            this.setDocumentValue.emit(value);\n        } catch (e) {\n            this.errorHandler.emit('Could not fetch lime object...');\n        }\n    }\n\n    private fileName(): string {\n        if (this.limeDocument) {\n            return this.limeDocument.text;\n        } else if (this.template) {\n            return this.template.text;\n        } else {\n            return '';\n        }\n    }\n\n    private handleChangeDocumentName(event) {\n        this.setNewDocumentName.emit(event.detail);\n    }\n\n    private handleChangeValue(event) {\n        this.setDocumentValue.emit(event.detail);\n    }\n\n    private handleChangeSmartReminder(event) {\n        this.setSmartReminder.emit(event.detail);\n    }\n\n    private handleChangeSendLinkBySms(event) {\n        this.setIsSmsSending.emit(event.detail);\n    }\n\n    private handleAddVideo() {\n        // should open select video view\n        this.changeView.emit(EnumViews.videoLibrary);\n    }\n\n    // TODO: function for uploading file, in advance\n    // private async handleChange(event: CustomEvent<FileInfo>) {\n    //     this.fileValue = event.detail;\n    //     const { data, success } = await uploadFile(\n    //         this.platform,\n    //         this.session,\n    //         this.fileValue\n    //     );\n    //     console.log(data, success);\n    // }\n\n    private handleRemoveVideo() {\n        this.removeVideo.emit();\n        this.documentVideo = false;\n    }\n}\n"]}