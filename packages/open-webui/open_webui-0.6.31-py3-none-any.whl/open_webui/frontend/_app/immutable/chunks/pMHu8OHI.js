import{S as Oe,i as Pe,s as Ve,H as Ie,I as We,C as q,D as G,E as Z,K as je,q as k,r as I,F as Y,v as Ke,k as he,e as S,c as A,a as V,d as g,f as m,g as L,x as Tt,z as Ct,A as It,B as Dt,l as Q,p as $,t as se,b as ie,h as R,j as ae,m as _e,y as le,u as ne,w as St,_ as At,a0 as Ut,G as fe,O as Rt,V as Le,n as ce,M as oe,N as De,J as ll,W as nt,X as rt}from"./BpeRjEzf.js";import{e as Me}from"./C5oNBBkD.js";import"./IHki7fMi.js";import{t as ue}from"./W3liupZx.js";import{d as nl,n as rl,e as ze,g as st,a as sl,c as il,m as al}from"./B863V-9z.js";import{j as ol,k as cl,v as ul,n as fl,a as dl,o as ml,p as gl,q as hl,r as _l,t as pl,u as bl,w as vl}from"./BvhXBtnk.js";import{g as wl}from"./Baj-D0MD.js";import{T as Se}from"./t7JSQ-4O.js";import{V as kl,R as yl}from"./C-80Yj-p.js";import"./D1_AUG_k.js";import{b as El,c as it}from"./BcvTzfAu.js";import{f as Tl}from"./g5t9vw8M.js";import{D as Cl}from"./DHIcdO2O.js";import{C as Il,a as Dl,g as He,I as Sl,b as Al}from"./cXLBB2aJ.js";import{u as Ul,F as Rl}from"./B11kYlYQ.js";import{I as Ll}from"./CWGXEtOf.js";import{F as Ml}from"./D25sYDi4.js";import{L as Vl,H as Nl}from"./Desdf_fs.js";import{s as Bl}from"./DIT6ebk1.js";import{S as Fl}from"./7L_OyexU.js";function Hl(r){let e;const l=r[6].default,t=Tt(l,r,r[11],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,s){t&&t.m(n,s),e=!0},p(n,s){t&&t.p&&(!e||s&2048)&&Ct(t,l,n,n[11],e?Dt(l,n[11],s,null):It(n[11]),null)},i(n){e||(k(t,n),e=!0)},o(n){I(t,n),e=!1},d(n){t&&t.d(n)}}}function zl(r){let e,l;return e=new Se({props:{content:r[4].t("More"),$$slots:{default:[Hl]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){Z(e,t,n),l=!0},p(t,n){const s={};n&16&&(s.content=t[4].t("More")),n&2048&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){Y(e,t)}}}function Ol(r){let e,l,t,n=r[4].t("Upload Files")+"",s,a;return e=new Il({}),{c(){q(e.$$.fragment),l=Q(),t=S("div"),s=se(n),this.h()},l(c){G(e.$$.fragment,c),l=$(c),t=A(c,"DIV",{class:!0});var i=V(t);s=ie(i,n),i.forEach(g),this.h()},h(){m(t,"class","line-clamp-1")},m(c,i){Z(e,c,i),L(c,l,i),L(c,t,i),R(t,s),a=!0},p(c,i){(!a||i&16)&&n!==(n=c[4].t("Upload Files")+"")&&ae(s,n)},i(c){a||(k(e.$$.fragment,c),a=!0)},o(c){I(e.$$.fragment,c),a=!1},d(c){c&&(g(l),g(t)),Y(e,c)}}}function Pl(r){let e,l,t,n=r[4].t("Capture")+"",s,a;return e=new Dl({}),{c(){q(e.$$.fragment),l=Q(),t=S("div"),s=se(n),this.h()},l(c){G(e.$$.fragment,c),l=$(c),t=A(c,"DIV",{class:!0});var i=V(t);s=ie(i,n),i.forEach(g),this.h()},h(){m(t,"class","line-clamp-1")},m(c,i){Z(e,c,i),L(c,l,i),L(c,t,i),R(t,s),a=!0},p(c,i){(!a||i&16)&&n!==(n=c[4].t("Capture")+"")&&ae(s,n)},i(c){a||(k(e.$$.fragment,c),a=!0)},o(c){I(e.$$.fragment,c),a=!1},d(c){c&&(g(l),g(t)),Y(e,c)}}}function Wl(r){let e,l,t,n;return e=new it({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50 rounded-xl",$$slots:{default:[Ol]},$$scope:{ctx:r}}}),e.$on("click",r[7]),t=new it({props:{class:"flex gap-2 items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50  rounded-xl",$$slots:{default:[Pl]},$$scope:{ctx:r}}}),t.$on("click",r[8]),{c(){q(e.$$.fragment),l=Q(),q(t.$$.fragment)},l(s){G(e.$$.fragment,s),l=$(s),G(t.$$.fragment,s)},m(s,a){Z(e,s,a),L(s,l,a),Z(t,s,a),n=!0},p(s,a){const c={};a&2064&&(c.$$scope={dirty:a,ctx:s}),e.$set(c);const i={};a&2064&&(i.$$scope={dirty:a,ctx:s}),t.$set(i)},i(s){n||(k(e.$$.fragment,s),k(t.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),I(t.$$.fragment,s),n=!1},d(s){s&&g(l),Y(e,s),Y(t,s)}}}function jl(r){let e,l,t;return l=new El({props:{class:"w-full max-w-[200px] rounded-2xl px-1 py-1  border border-gray-100  dark:border-gray-800 z-999 bg-white dark:bg-gray-850 dark:text-white shadow-lg transition",sideOffset:4,alignOffset:-6,side:"bottom",align:"start",transition:Tl,$$slots:{default:[Wl]},$$scope:{ctx:r}}}),{c(){e=S("div"),q(l.$$.fragment),this.h()},l(n){e=A(n,"DIV",{slot:!0});var s=V(e);G(l.$$.fragment,s),s.forEach(g),this.h()},h(){m(e,"slot","content")},m(n,s){L(n,e,s),Z(l,e,null),t=!0},p(n,s){const a={};s&2067&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(k(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&g(e),Y(l)}}}function Kl(r){let e,l,t;function n(a){r[9](a)}let s={$$slots:{content:[jl],default:[zl]},$$scope:{ctx:r}};return r[3]!==void 0&&(s.show=r[3]),e=new Cl({props:s}),Ie.push(()=>We(e,"show",n)),e.$on("change",r[10]),{c(){q(e.$$.fragment)},l(a){G(e.$$.fragment,a)},m(a,c){Z(e,a,c),t=!0},p(a,[c]){const i={};c&2067&&(i.$$scope={dirty:c,ctx:a}),!l&&c&8&&(l=!0,i.show=a[3],je(()=>l=!1)),e.$set(i)},i(a){t||(k(e.$$.fragment,a),t=!0)},o(a){I(e.$$.fragment,a),t=!1},d(a){Y(e,a)}}}function ql(r,e,l){let t,{$$slots:n={},$$scope:s}=e;const a=Ke("i18n");he(r,a,C=>l(4,t=C));let{screenCaptureHandler:c}=e,{uploadFilesHandler:i}=e,{onClose:u=()=>{}}=e,d=!1;const D=async()=>{},v=()=>{i()},y=()=>{c()};function w(C){d=C,l(3,d)}const E=C=>{C.detail===!1&&u()};return r.$$set=C=>{"screenCaptureHandler"in C&&l(0,c=C.screenCaptureHandler),"uploadFilesHandler"in C&&l(1,i=C.uploadFilesHandler),"onClose"in C&&l(2,u=C.onClose),"$$scope"in C&&l(11,s=C.$$scope)},r.$$.update=()=>{r.$$.dirty&8&&d&&D()},[c,i,u,d,t,a,n,v,y,w,E,s]}class Gl extends Oe{constructor(e){super(),Pe(this,e,ql,Kl,Ve,{screenCaptureHandler:0,uploadFilesHandler:1,onClose:2})}}function at(r,e,l){const t=r.slice();return t[23]=e[l],t[25]=l,t}function ot(r){let e,l,t,n=Me(r[1]),s=[];for(let c=0;c<n.length;c+=1)s[c]=ut(at(r,n,c));const a=c=>I(s[c],1,1,()=>{s[c]=null});return{c(){e=S("div"),l=S("div");for(let c=0;c<s.length;c+=1)s[c].c();this.h()},l(c){e=A(c,"DIV",{class:!0,id:!0});var i=V(e);l=A(i,"DIV",{class:!0});var u=V(l);for(let d=0;d<s.length;d+=1)s[d].l(u);u.forEach(g),i.forEach(g),this.h()},h(){m(l,"class","overflow-y-auto scrollbar-thin max-h-60"),m(e,"class","mention-list text-black dark:text-white rounded-2xl shadow-lg border border-gray-200 dark:border-gray-800 flex flex-col bg-white dark:bg-gray-850 w-72 p-1"),m(e,"id","suggestions-container")},m(c,i){L(c,e,i),R(e,l);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(l,null);t=!0},p(c,i){if(i&23){n=Me(c[1]);let u;for(u=0;u<n.length;u+=1){const d=at(c,n,u);s[u]?(s[u].p(d,i),k(s[u],1)):(s[u]=ut(d),s[u].c(),k(s[u],1),s[u].m(l,null))}for(le(),u=n.length;u<s.length;u+=1)a(u);ne()}},i(c){if(!t){for(let i=0;i<n.length;i+=1)k(s[i]);t=!0}},o(c){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)I(s[i]);t=!1},d(c){c&&g(e),Ut(s,c)}}}function ct(r){let e;function l(s,a){var c,i,u;if(((c=s[23])==null?void 0:c.type)==="user")return Jl;if(((i=s[23])==null?void 0:i.type)==="model")return Yl;if(((u=s[23])==null?void 0:u.type)==="channel")return Zl}let t=l(r),n=t&&t(r);return{c(){e=S("div"),n&&n.c(),this.h()},l(s){e=A(s,"DIV",{class:!0});var a=V(e);n&&n.l(a),a.forEach(g),this.h()},h(){m(e,"class","px-2 text-xs text-gray-500 py-1")},m(s,a){L(s,e,a),n&&n.m(e,null)},p(s,a){t===(t=l(s))&&n?n.p(s,a):(n&&n.d(1),n=t&&t(s),n&&(n.c(),n.m(e,null)))},d(s){s&&g(e),n&&n.d()}}}function Zl(r){let e=r[2].t("Channels")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channels")+"")&&ae(l,e)},d(t){t&&g(l)}}}function Yl(r){let e=r[2].t("Models")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Models")+"")&&ae(l,e)},d(t){t&&g(l)}}}function Jl(r){let e=r[2].t("Users")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Users")+"")&&ae(l,e)},d(t){t&&g(l)}}}function Xl(r){let e,l,t;return{c(){e=S("img"),this.h()},l(n){e=A(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n;Le(e.src,l=`${ze}/users/${r[23].id}/profile/image`)||m(e,"src",l),m(e,"alt",t=((n=r[23])==null?void 0:n.label)??r[23].id),m(e,"class","rounded-full size-5 items-center mr-2")},m(n,s){L(n,e,s)},p(n,s){var a;s&2&&!Le(e.src,l=`${ze}/users/${n[23].id}/profile/image`)&&m(e,"src",l),s&2&&t!==(t=((a=n[23])==null?void 0:a.label)??n[23].id)&&m(e,"alt",t)},i:ce,o:ce,d(n){n&&g(e)}}}function Ql(r){let e,l,t;return{c(){e=S("img"),this.h()},l(n){e=A(n,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var n,s,a,c,i,u;Le(e.src,l=((c=(a=(s=(n=r[23])==null?void 0:n.data)==null?void 0:s.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??`${st}/static/favicon.png`)||m(e,"src",l),m(e,"alt",t=((u=(i=r[23])==null?void 0:i.data)==null?void 0:u.name)??r[23].id),m(e,"class","rounded-full size-5 items-center mr-2")},m(n,s){L(n,e,s)},p(n,s){var a,c,i,u,d,D;s&2&&!Le(e.src,l=((u=(i=(c=(a=n[23])==null?void 0:a.data)==null?void 0:c.info)==null?void 0:i.meta)==null?void 0:u.profile_image_url)??`${st}/static/favicon.png`)&&m(e,"src",l),s&2&&t!==(t=((D=(d=n[23])==null?void 0:d.data)==null?void 0:D.name)??n[23].id)&&m(e,"alt",t)},i:ce,o:ce,d(n){n&&g(e)}}}function $l(r){let e,l,t,n;const s=[en,xl],a=[];function c(i,u){var d,D;return((D=(d=i[23])==null?void 0:d.data)==null?void 0:D.access_control)===null?0:1}return l=c(r),t=a[l]=s[l](r),{c(){e=S("div"),t.c(),this.h()},l(i){e=A(i,"DIV",{class:!0});var u=V(e);t.l(u),u.forEach(g),this.h()},h(){m(e,"class","size-4 justify-center flex items-center mr-0.5")},m(i,u){L(i,e,u),a[l].m(e,null),n=!0},p(i,u){let d=l;l=c(i),l!==d&&(le(),I(a[d],1,1,()=>{a[d]=null}),ne(),t=a[l],t||(t=a[l]=s[l](i),t.c()),k(t,1),t.m(e,null))},i(i){n||(k(t),n=!0)},o(i){I(t),n=!1},d(i){i&&g(e),a[l].d()}}}function xl(r){let e,l;return e=new Vl({props:{className:"size-[15px]",strokeWidth:"2"}}),{c(){q(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){Z(e,t,n),l=!0},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){Y(e,t)}}}function en(r){let e,l;return e=new Nl({props:{className:"size-3",strokeWidth:"2.5"}}),{c(){q(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){Z(e,t,n),l=!0},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){Y(e,t)}}}function tn(r){let e=r[2].t("Channel")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Channel")+"")&&ae(l,e)},d(t){t&&g(l)}}}function ln(r){let e=r[2].t("Model")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("Model")+"")&&ae(l,e)},d(t){t&&g(l)}}}function nn(r){let e=r[2].t("User")+"",l;return{c(){l=se(e)},l(t){l=ie(t,e)},m(t,n){L(t,l,n)},p(t,n){n&4&&e!==(e=t[2].t("User")+"")&&ae(l,e)},d(t){t&&g(l)}}}function rn(r){let e,l,t,n,s,a=r[23].label+"",c,i,u,d,D,v,y,w,E;const C=[$l,Ql,Xl],B=[];function K(U,T){return U[23].type==="channel"?0:U[23].type==="model"?1:U[23].type==="user"?2:-1}~(l=K(r))&&(t=B[l]=C[l](r));function O(U,T){if(U[23].type==="user")return nn;if(U[23].type==="model")return ln;if(U[23].type==="channel")return tn}let N=O(r),M=N&&N(r);function W(){return r[16](r[25])}function z(){return r[17](r[25])}return{c(){e=S("button"),t&&t.c(),n=Q(),s=S("div"),c=se(a),i=Q(),u=S("div"),M&&M.c(),v=Q(),this.h()},l(U){e=A(U,"BUTTON",{type:!0,class:!0,"data-selected":!0});var T=V(e);t&&t.l(T),n=$(T),s=A(T,"DIV",{class:!0});var p=V(s);c=ie(p,a),p.forEach(g),i=$(T),u=A(T,"DIV",{class:!0});var f=V(u);M&&M.l(f),f.forEach(g),T.forEach(g),v=$(U),this.h()},h(){m(s,"class","truncate flex-1 pr-2"),m(u,"class","shrink-0 text-xs text-gray-500"),m(e,"type","button"),m(e,"class",d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(r[25]===r[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")),m(e,"data-selected",D=r[25]===r[0])},m(U,T){L(U,e,T),~l&&B[l].m(e,null),R(e,n),R(e,s),R(s,c),R(e,i),R(e,u),M&&M.m(u,null),L(U,v,T),y=!0,w||(E=[fe(e,"click",W),fe(e,"mousemove",z)],w=!0)},p(U,T){r=U;let p=l;l=K(r),l===p?~l&&B[l].p(r,T):(t&&(le(),I(B[p],1,1,()=>{B[p]=null}),ne()),~l?(t=B[l],t?t.p(r,T):(t=B[l]=C[l](r),t.c()),k(t,1),t.m(e,n)):t=null),(!y||T&2)&&a!==(a=r[23].label+"")&&ae(c,a),N===(N=O(r))&&M?M.p(r,T):(M&&M.d(1),M=N&&N(r),M&&(M.c(),M.m(u,null))),(!y||T&1&&d!==(d="flex items-center justify-between px-2.5 py-1.5 rounded-xl w-full text-left "+(r[25]===r[0]?"bg-gray-50 dark:bg-gray-800 selected-command-option-button":"")))&&m(e,"class",d),(!y||T&1&&D!==(D=r[25]===r[0]))&&m(e,"data-selected",D)},i(U){y||(k(t),y=!0)},o(U){I(t),y=!1},d(U){U&&(g(e),g(v)),~l&&B[l].d(),M&&M.d(),w=!1,Rt(E)}}}function ut(r){var s,a,c;let e,l,t,n=(r[25]===0||((s=r[23])==null?void 0:s.type)!==((a=r[1][r[25]-1])==null?void 0:a.type))&&ct(r);return l=new Se({props:{content:(c=r[23])==null?void 0:c.id,placement:"top-start",$$slots:{default:[rn]},$$scope:{ctx:r}}}),{c(){n&&n.c(),e=Q(),q(l.$$.fragment)},l(i){n&&n.l(i),e=$(i),G(l.$$.fragment,i)},m(i,u){n&&n.m(i,u),L(i,e,u),Z(l,i,u),t=!0},p(i,u){var D,v,y;i[25]===0||((D=i[23])==null?void 0:D.type)!==((v=i[1][i[25]-1])==null?void 0:v.type)?n?n.p(i,u):(n=ct(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null);const d={};u&2&&(d.content=(y=i[23])==null?void 0:y.id),u&67108871&&(d.$$scope={dirty:u,ctx:i}),l.$set(d)},i(i){t||(k(l.$$.fragment,i),t=!0)},o(i){I(l.$$.fragment,i),t=!1},d(i){i&&g(e),n&&n.d(i),Y(l,i)}}}function sn(r){let e,l,t=r[1].length&&ot(r);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,s){t&&t.m(n,s),L(n,e,s),l=!0},p(n,[s]){n[1].length?t?(t.p(n,s),s&2&&k(t,1)):(t=ot(n),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(le(),I(t,1,1,()=>{t=null}),ne())},i(n){l||(k(t),l=!0)},o(n){I(t),l=!1},d(n){n&&g(e),t&&t.d(n)}}}function an(r,e,l){let t,n,s,a;he(r,nl,p=>l(18,n=p)),he(r,rl,p=>l(19,s=p));const c=Ke("i18n");he(r,c,p=>l(2,a=p));let{query:i=""}=e,{command:u}=e,{selectedIndex:d=0}=e,{label:D=""}=e,{triggerChar:v="@"}=e,{modelSuggestions:y=!1}=e,{userSuggestions:w=!1}=e,{channelSuggestions:E=!1}=e,C=[],B=[],K=[];const O=async()=>{const p=await Bl(localStorage.token,i).catch(f=>null);p&&l(14,B=[...p.users.map(f=>({type:"user",id:f.id,label:f.name}))].sort((f,F)=>f.label.localeCompare(F.label)))},N=p=>{const f=t[p];f&&f&&u({id:`${f.type==="user"?"U":f.type==="model"?"M":"C"}:${f.id}|${f.label}`,label:f.label})},M=p=>{if(!["ArrowUp","ArrowDown","Enter","Tab","Escape"].includes(p.key))return!1;if(p.key==="ArrowUp"){l(0,d=Math.max(0,d-1));const f=document.querySelector('[data-selected="true"]');return f==null||f.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}if(p.key==="ArrowDown"){l(0,d=Math.min(d+1,t.length-1));const f=document.querySelector('[data-selected="true"]');return f==null||f.scrollIntoView({block:"center",inline:"nearest",behavior:"instant"}),!0}return p.key==="Enter"||p.key==="Tab"?(N(d),p.key==="Enter"&&p.preventDefault(),!0):p.key==="Escape"};function W(p){return M(p)}const z=p=>{p.key==="Enter"&&(p.preventDefault(),N(d))};St(async()=>{window.addEventListener("keydown",z),E?l(15,K=[...s.map(p=>({type:"channel",id:p.id,label:p.name,data:p}))]):(w&&await O(),y&&l(13,C=[...n.map(p=>({type:"model",id:p.id,label:p.name,data:p}))]))}),At(()=>{window.removeEventListener("keydown",z)});const U=p=>N(p),T=p=>{l(0,d=p)};return r.$$set=p=>{"query"in p&&l(5,i=p.query),"command"in p&&l(6,u=p.command),"selectedIndex"in p&&l(0,d=p.selectedIndex),"label"in p&&l(7,D=p.label),"triggerChar"in p&&l(8,v=p.triggerChar),"modelSuggestions"in p&&l(9,y=p.modelSuggestions),"userSuggestions"in p&&l(10,w=p.userSuggestions),"channelSuggestions"in p&&l(11,E=p.channelSuggestions)},r.$$.update=()=>{r.$$.dirty&57376&&l(1,t=[...B,...C,...K].filter(p=>p.label.toLowerCase().includes(i.toLowerCase())||p.id.toLowerCase().includes(i.toLowerCase()))),r.$$.dirty&1056&&i!==null&&w&&O()},[d,t,a,c,N,i,u,D,v,y,w,E,W,C,B,K,U,T]}class ft extends Oe{constructor(e){super(),Pe(this,e,an,sn,Ve,{query:5,command:6,selectedIndex:0,label:7,triggerChar:8,modelSuggestions:9,userSuggestions:10,channelSuggestions:11,_onKeyDown:12})}get _onKeyDown(){return this.$$.ctx[12]}}const on=r=>({}),dt=r=>({});function mt(r,e,l){const t=r.slice();return t[71]=e[l],t[73]=l,t}function gt(r){let e,l,t,n,s,a,c,i,u,d,D,v,y,w,E,C,B,K;e=new Ml({props:{show:r[13]}});let O=r[8]&&ht(r);function N(f){r[43](f)}let M={variables:r[20],onSave:r[19]};r[18]!==void 0&&(M.show=r[18]),n=new Sl({props:M}),Ie.push(()=>We(n,"show",N));let W=r[1]===!1&&_t(r),z=r[3].length>0&&pt(r);const U=[un,cn],T=[];function p(f,F){return f[14]?0:1}return E=p(r),C=T[E]=U[E](r),{c(){q(e.$$.fragment),l=Q(),O&&O.c(),t=Q(),q(n.$$.fragment),a=Q(),c=S("div"),i=S("div"),u=S("div"),d=S("div"),D=S("div"),W&&W.c(),v=Q(),z&&z.c(),y=Q(),w=S("div"),C.c(),this.h()},l(f){G(e.$$.fragment,f),l=$(f),O&&O.l(f),t=$(f),G(n.$$.fragment,f),a=$(f),c=A(f,"DIV",{class:!0});var F=V(c);i=A(F,"DIV",{class:!0});var x=V(i);u=A(x,"DIV",{class:!0});var b=V(u);d=A(b,"DIV",{class:!0});var H=V(d);D=A(H,"DIV",{class:!0});var J=V(D);W&&W.l(J),J.forEach(g),v=$(H),z&&z.l(H),H.forEach(g),b.forEach(g),y=$(x),w=A(x,"DIV",{class:!0});var te=V(w);C.l(te),te.forEach(g),x.forEach(g),F.forEach(g),this.h()},h(){m(D,"class","relative"),m(d,"class","flex flex-col px-3 w-full"),m(u,"class","absolute top-0 left-0 right-0 mx-auto inset-x-0 bg-transparent flex justify-center"),m(w,"class",B=(r[7]?"opacity-50 pointer-events-none cursor-not-allowed":"")+" relative z-20"),m(i,"class","max-w-full mx-auto inset-x-0 relative"),m(c,"class","bg-transparent")},m(f,F){Z(e,f,F),L(f,l,F),O&&O.m(f,F),L(f,t,F),Z(n,f,F),L(f,a,F),L(f,c,F),R(c,i),R(i,u),R(u,d),R(d,D),W&&W.m(D,null),R(d,v),z&&z.m(d,null),R(i,y),R(i,w),T[E].m(w,null),K=!0},p(f,F){const x={};F[0]&8192&&(x.show=f[13]),e.$set(x),f[8]?O?O.p(f,F):(O=ht(f),O.c(),O.m(t.parentNode,t)):O&&(O.d(1),O=null);const b={};F[0]&1048576&&(b.variables=f[20]),F[0]&524288&&(b.onSave=f[19]),!s&&F[0]&262144&&(s=!0,b.show=f[18],je(()=>s=!1)),n.$set(b),f[1]===!1?W?W.p(f,F):(W=_t(f),W.c(),W.m(D,null)):W&&(W.d(1),W=null),f[3].length>0?z?(z.p(f,F),F[0]&8&&k(z,1)):(z=pt(f),z.c(),k(z,1),z.m(d,null)):z&&(le(),I(z,1,1,()=>{z=null}),ne());let H=E;E=p(f),E===H?T[E].p(f,F):(le(),I(T[H],1,1,()=>{T[H]=null}),ne(),C=T[E],C?C.p(f,F):(C=T[E]=U[E](f),C.c()),k(C,1),C.m(w,null)),(!K||F[0]&128&&B!==(B=(f[7]?"opacity-50 pointer-events-none cursor-not-allowed":"")+" relative z-20"))&&m(w,"class",B)},i(f){K||(k(e.$$.fragment,f),k(n.$$.fragment,f),k(z),k(C),K=!0)},o(f){I(e.$$.fragment,f),I(n.$$.fragment,f),I(z),I(C),K=!1},d(f){f&&(g(l),g(t),g(a),g(c)),Y(e,f),O&&O.d(f),Y(n,f),W&&W.d(),z&&z.d(),T[E].d()}}}function ht(r){let e,l,t;return{c(){e=S("input"),this.h()},l(n){e=A(n,"INPUT",{type:!0}),this.h()},h(){m(e,"type","file"),e.hidden=!0,e.multiple=!0},m(n,s){L(n,e,s),r[40](e),l||(t=[fe(e,"change",r[41]),fe(e,"change",r[42])],l=!0)},p:ce,d(n){n&&g(e),r[40](null),l=!1,Rt(t)}}}function _t(r){let e,l,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',n,s;return{c(){e=S("div"),l=S("button"),l.innerHTML=t,this.h()},l(a){e=A(a,"DIV",{class:!0});var c=V(e);l=A(c,"BUTTON",{class:!0,"data-svelte-h":!0}),De(l)!=="svelte-1wiokab"&&(l.innerHTML=t),c.forEach(g),this.h()},h(){m(l,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),m(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(a,c){L(a,e,c),R(e,l),n||(s=fe(l,"click",r[44]),n=!0)},p:ce,d(a){a&&g(e),n=!1,s()}}}function pt(r){let e,l,t,n,s,a,c=r[3].map(Et).join(", ")+"",i,u,d=r[23].t("is typing...")+"",D,v,y;return t=new Fl({props:{size:"xs"}}),{c(){e=S("div"),l=S("div"),q(t.$$.fragment),n=Q(),s=S("div"),a=S("span"),i=se(c),u=Q(),D=se(d),this.h()},l(w){e=A(w,"DIV",{class:!0});var E=V(e);l=A(E,"DIV",{class:!0});var C=V(l);G(t.$$.fragment,C),n=$(C),s=A(C,"DIV",{});var B=V(s);a=A(B,"SPAN",{class:!0});var K=V(a);i=ie(K,c),K.forEach(g),u=$(B),D=ie(B,d),B.forEach(g),C.forEach(g),E.forEach(g),this.h()},h(){m(a,"class","font-normal text-black dark:text-white"),m(l,"class","text-xs px-1 mt-1.5 flex items-center gap-1.5"),m(e,"class",v="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+r[9]+" pointer-events-none select-none")},m(w,E){L(w,e,E),R(e,l),Z(t,l,null),R(l,n),R(l,s),R(s,a),R(a,i),R(s,u),R(s,D),y=!0},p(w,E){(!y||E[0]&8)&&c!==(c=w[3].map(Et).join(", ")+"")&&ae(i,c),(!y||E[0]&8388608)&&d!==(d=w[23].t("is typing...")+"")&&ae(D,d),(!y||E[0]&512&&v!==(v="-mt-7 pb-2.5 bg-gradient-to-t to-transparent "+w[9]+" pointer-events-none select-none"))&&m(e,"class",v)},i(w){y||(k(t.$$.fragment,w),y=!0)},o(w){I(t.$$.fragment,w),y=!1},d(w){w&&g(e),Y(t)}}}function cn(r){var x;let e,l,t,n,s,a=(x=r[22])==null?void 0:x.richTextInput,c,i,u,d,D,v,y,w,E,C,B,K,O,N=r[15].length>0&&bt(r),M=wt(r);const W=r[39].menu,z=Tt(W,r,r[59],dt),U=z||gn(r);let T=r[10]===""&&yt(r);const p=[pn,_n],f=[];function F(b,H){return b[4]&&b[5]?0:1}return w=F(r),E=f[w]=p[w](r),{c(){e=S("form"),l=S("div"),N&&N.c(),t=Q(),n=S("div"),s=S("div"),M.c(),c=Q(),i=S("div"),u=S("div"),U&&U.c(),d=Q(),D=S("div"),T&&T.c(),v=Q(),y=S("div"),E.c(),this.h()},l(b){e=A(b,"FORM",{class:!0});var H=V(e);l=A(H,"DIV",{id:!0,class:!0,dir:!0});var J=V(l);N&&N.l(J),t=$(J),n=A(J,"DIV",{class:!0});var te=V(n);s=A(te,"DIV",{class:!0});var de=V(s);M.l(de),de.forEach(g),te.forEach(g),c=$(J),i=A(J,"DIV",{class:!0});var me=V(i);u=A(me,"DIV",{class:!0});var we=V(u);U&&U.l(we),we.forEach(g),d=$(me),D=A(me,"DIV",{class:!0});var pe=V(D);T&&T.l(pe),v=$(pe),y=A(pe,"DIV",{class:!0});var Ce=V(y);E.l(Ce),Ce.forEach(g),pe.forEach(g),me.forEach(g),J.forEach(g),H.forEach(g),this.h()},h(){var b;m(s,"class","scrollbar-hidden rtl:text-right ltr:text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-2.5 pb-[5px] px-1 resize-none h-fit max-h-96 overflow-auto"),m(n,"class","px-2.5"),m(u,"class","ml-1 self-end flex space-x-1 flex-1"),m(y,"class","flex items-center"),m(D,"class","self-end flex space-x-1 mr-1"),m(i,"class","flex justify-between mb-2.5 mx-0.5"),m(l,"id","message-input-container"),m(l,"class","flex-1 flex flex-col relative w-full shadow-lg rounded-3xl border border-gray-50 dark:border-gray-850 hover:border-gray-100 focus-within:border-gray-100 hover:dark:border-gray-800 focus-within:dark:border-gray-800 transition px-1 bg-white/90 dark:bg-gray-400/5 dark:text-gray-100"),m(l,"dir",C=((b=r[22])==null?void 0:b.chatDirection)??"auto"),m(e,"class","w-full flex gap-1.5")},m(b,H){L(b,e,H),R(e,l),N&&N.m(l,null),R(l,t),R(l,n),R(n,s),M.m(s,null),R(l,c),R(l,i),R(i,u),U&&U.m(u,null),R(i,d),R(i,D),T&&T.m(D,null),R(D,v),R(D,y),f[w].m(y,null),B=!0,K||(O=fe(e,"submit",ll(r[58])),K=!0)},p(b,H){var te,de;b[15].length>0?N?(N.p(b,H),H[0]&32768&&k(N,1)):(N=bt(b),N.c(),k(N,1),N.m(l,t)):N&&(le(),I(N,1,1,()=>{N=null}),ne()),H[0]&4194304&&Ve(a,a=(te=b[22])==null?void 0:te.richTextInput)?(le(),I(M,1,1,ce),ne(),M=wt(b),M.c(),k(M,1),M.m(s,null)):M.p(b,H),z?z.p&&(!B||H[1]&268435456)&&Ct(z,W,b,b[59],B?Dt(W,b[59],H,on):It(b[59]),dt):U&&U.p&&(!B||H[0]&65792)&&U.p(b,B?H:[-1,-1,-1]),b[10]===""?T?(T.p(b,H),H[0]&1024&&k(T,1)):(T=yt(b),T.c(),k(T,1),T.m(D,v)):T&&(le(),I(T,1,1,()=>{T=null}),ne());let J=w;w=F(b),w===J?f[w].p(b,H):(le(),I(f[J],1,1,()=>{f[J]=null}),ne(),E=f[w],E?E.p(b,H):(E=f[w]=p[w](b),E.c()),k(E,1),E.m(y,null)),(!B||H[0]&4194304&&C!==(C=((de=b[22])==null?void 0:de.chatDirection)??"auto"))&&m(l,"dir",C)},i(b){B||(k(N),k(M),k(U,b),k(T),k(E),B=!0)},o(b){I(N),I(M),I(U,b),I(T),I(E),B=!1},d(b){b&&g(e),N&&N.d(),M.d(b),U&&U.d(b),T&&T.d(),f[w].d(),K=!1,O()}}}function un(r){let e,l,t;function n(a){r[47](a)}let s={onCancel:r[45],onConfirm:r[46]};return r[14]!==void 0&&(s.recording=r[14]),e=new kl({props:s}),Ie.push(()=>We(e,"recording",n)),{c(){q(e.$$.fragment)},l(a){G(e.$$.fragment,a)},m(a,c){Z(e,a,c),t=!0},p(a,c){const i={};c[0]&16385&&(i.onCancel=a[45]),c[0]&16385&&(i.onConfirm=a[46]),!l&&c[0]&16384&&(l=!0,i.recording=a[14],je(()=>l=!1)),e.$set(i)},i(a){t||(k(e.$$.fragment,a),t=!0)},o(a){I(e.$$.fragment,a),t=!1},d(a){Y(e,a)}}}function bt(r){let e,l,t=Me(r[15]),n=[];for(let a=0;a<t.length;a+=1)n[a]=vt(mt(r,t,a));const s=a=>I(n[a],1,1,()=>{n[a]=null});return{c(){e=S("div");for(let a=0;a<n.length;a+=1)n[a].c();this.h()},l(a){e=A(a,"DIV",{class:!0});var c=V(e);for(let i=0;i<n.length;i+=1)n[i].l(c);c.forEach(g),this.h()},h(){m(e,"class","mx-2 mt-2.5 -mb-1 flex flex-wrap gap-2")},m(a,c){L(a,e,c);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null);l=!0},p(a,c){if(c[0]&32768){t=Me(a[15]);let i;for(i=0;i<t.length;i+=1){const u=mt(a,t,i);n[i]?(n[i].p(u,c),k(n[i],1)):(n[i]=vt(u),n[i].c(),k(n[i],1),n[i].m(e,null))}for(le(),i=t.length;i<n.length;i+=1)s(i);ne()}},i(a){if(!l){for(let c=0;c<t.length;c+=1)k(n[c]);l=!0}},o(a){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)I(n[c]);l=!1},d(a){a&&g(e),Ut(n,a)}}}function fn(r){var s;let e,l;function t(){return r[49](r[73])}function n(){return r[50](r[71])}return e=new Rl({props:{item:r[71],name:r[71].name,type:r[71].type,size:(s=r[71])==null?void 0:s.size,small:!0,loading:r[71].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",t),e.$on("click",n),{c(){q(e.$$.fragment)},l(a){G(e.$$.fragment,a)},m(a,c){Z(e,a,c),l=!0},p(a,c){var u;r=a;const i={};c[0]&32768&&(i.item=r[71]),c[0]&32768&&(i.name=r[71].name),c[0]&32768&&(i.type=r[71].type),c[0]&32768&&(i.size=(u=r[71])==null?void 0:u.size),c[0]&32768&&(i.loading=r[71].status==="uploading"),e.$set(i)},i(a){l||(k(e.$$.fragment,a),l=!0)},o(a){I(e.$$.fragment,a),l=!1},d(a){Y(e,a)}}}function dn(r){let e,l,t,n,s,a,c='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',i,u,d,D;t=new Ll({props:{src:r[71].url,alt:"",imageClassName:" size-10 rounded-xl object-cover"}});function v(){return r[48](r[73])}return{c(){e=S("div"),l=S("div"),q(t.$$.fragment),n=Q(),s=S("div"),a=S("button"),a.innerHTML=c,i=Q(),this.h()},l(y){e=A(y,"DIV",{class:!0});var w=V(e);l=A(w,"DIV",{class:!0});var E=V(l);G(t.$$.fragment,E),E.forEach(g),n=$(w),s=A(w,"DIV",{class:!0});var C=V(s);a=A(C,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),De(a)!=="svelte-ixwiqw"&&(a.innerHTML=c),C.forEach(g),i=$(w),w.forEach(g),this.h()},h(){m(l,"class","relative"),m(a,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),m(a,"type","button"),m(s,"class","absolute -top-1 -right-1"),m(e,"class","relative group")},m(y,w){L(y,e,w),R(e,l),Z(t,l,null),R(e,n),R(e,s),R(s,a),R(e,i),u=!0,d||(D=fe(a,"click",v),d=!0)},p(y,w){r=y;const E={};w[0]&32768&&(E.src=r[71].url),t.$set(E)},i(y){u||(k(t.$$.fragment,y),u=!0)},o(y){I(t.$$.fragment,y),u=!1},d(y){y&&g(e),Y(t),d=!1,D()}}}function vt(r){let e,l,t,n;const s=[dn,fn],a=[];function c(i,u){return i[71].type==="image"?0:1}return e=c(r),l=a[e]=s[e](r),{c(){l.c(),t=_e()},l(i){l.l(i),t=_e()},m(i,u){a[e].m(i,u),L(i,t,u),n=!0},p(i,u){let d=e;e=c(i),e===d?a[e].p(i,u):(le(),I(a[d],1,1,()=>{a[d]=null}),ne(),l=a[e],l?l.p(i,u):(l=a[e]=s[e](i),l.c()),k(l,1),l.m(t.parentNode,t))},i(i){n||(k(l),n=!0)},o(i){I(l),n=!1},d(i){i&&g(t),a[e].d(i)}}}function wt(r){var n,s,a,c;let e,l,t={id:"chat-input",json:!0,messageInput:!0,editable:!r[7],placeholder:r[2],richText:((n=r[22])==null?void 0:n.richTextInput)??!0,showFormattingToolbar:((s=r[22])==null?void 0:s.showFormattingToolbar)??!1,shiftEnter:!(((a=r[22])==null?void 0:a.ctrlEnterToSend)??!1)&&(!r[24]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),largeTextAsFile:((c=r[22])==null?void 0:c.largeTextAsFile)??!1,floatingMenuPlacement:"top-start",suggestions:r[21],onChange:r[51]};return e=new yl({props:t}),r[52](e),e.$on("keydown",r[53]),e.$on("paste",r[54]),{c(){q(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,u){Z(e,i,u),l=!0},p(i,u){var D,v,y,w;const d={};u[0]&128&&(d.editable=!i[7]),u[0]&4&&(d.placeholder=i[2]),u[0]&4194304&&(d.richText=((D=i[22])==null?void 0:D.richTextInput)??!0),u[0]&4194304&&(d.showFormattingToolbar=((v=i[22])==null?void 0:v.showFormattingToolbar)??!1),u[0]&20971520&&(d.shiftEnter=!(((y=i[22])==null?void 0:y.ctrlEnterToSend)??!1)&&(!i[24]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))),u[0]&4194304&&(d.largeTextAsFile=((w=i[22])==null?void 0:w.largeTextAsFile)??!1),u[0]&2097152&&(d.suggestions=i[21]),u[0]&3072&&(d.onChange=i[51]),e.$set(d)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){I(e.$$.fragment,i),l=!1},d(i){r[52](null),Y(e,i)}}}function kt(r){let e,l;return e=new Gl({props:{screenCaptureHandler:r[28],uploadFilesHandler:r[55],$$slots:{default:[mn]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){Z(e,t,n),l=!0},p(t,n){const s={};n[0]&65536&&(s.uploadFilesHandler=t[55]),n[1]&268435456&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){Y(e,t)}}}function mn(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=S("button"),e.innerHTML=l,this.h()},l(t){e=A(t,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),De(e)!=="svelte-180cnf0"&&(e.innerHTML=l),this.h()},h(){m(e,"id","input-menu-button"),m(e,"class","bg-transparent hover:bg-white/80 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden"),m(e,"type","button"),m(e,"aria-label","More")},m(t,n){L(t,e,n)},p:ce,d(t){t&&g(e)}}}function gn(r){let e,l,t=r[8]&&kt(r);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,s){t&&t.m(n,s),L(n,e,s),l=!0},p(n,s){n[8]?t?(t.p(n,s),s[0]&256&&k(t,1)):(t=kt(n),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(le(),I(t,1,1,()=>{t=null}),ne())},i(n){l||(k(t),l=!0)},o(n){I(t),l=!1},d(n){n&&g(e),t&&t.d(n)}}}function yt(r){let e,l;return e=new Se({props:{content:r[23].t("Record voice"),$$slots:{default:[hn]},$$scope:{ctx:r}}}),{c(){q(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){Z(e,t,n),l=!0},p(t,n){const s={};n[0]&8388608&&(s.content=t[23].t("Record voice")),n[0]&8404992|n[1]&268435456&&(s.$$scope={dirty:n,ctx:t}),e.$set(s)},i(t){l||(k(e.$$.fragment,t),l=!0)},o(t){I(e.$$.fragment,t),l=!1},d(t){Y(e,t)}}}function hn(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',t,n;return{c(){e=S("button"),e.innerHTML=l,this.h()},l(s){e=A(s,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),De(e)!=="svelte-wjtw32"&&(e.innerHTML=l),this.h()},h(){m(e,"id","voice-input-button"),m(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),m(e,"type","button"),m(e,"aria-label","Voice Input")},m(s,a){L(s,e,a),t||(n=fe(e,"click",r[56]),t=!0)},p:ce,d(s){s&&g(e),t=!1,n()}}}function _n(r){let e,l,t;return l=new Se({props:{content:r[23].t("Send message"),$$slots:{default:[bn]},$$scope:{ctx:r}}}),{c(){e=S("div"),q(l.$$.fragment),this.h()},l(n){e=A(n,"DIV",{class:!0});var s=V(e);G(l.$$.fragment,s),s.forEach(g),this.h()},h(){m(e,"class","flex items-center")},m(n,s){L(n,e,s),Z(l,e,null),t=!0},p(n,s){const a={};s[0]&8388608&&(a.content=n[23].t("Send message")),s[0]&33792|s[1]&268435456&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(k(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&g(e),Y(l)}}}function pn(r){let e,l,t;return l=new Se({props:{content:r[23].t("Stop"),$$slots:{default:[vn]},$$scope:{ctx:r}}}),{c(){e=S("div"),q(l.$$.fragment),this.h()},l(n){e=A(n,"DIV",{class:!0});var s=V(e);G(l.$$.fragment,s),s.forEach(g),this.h()},h(){m(e,"class","flex items-center")},m(n,s){L(n,e,s),Z(l,e,null),t=!0},p(n,s){const a={};s[0]&8388608&&(a.content=n[23].t("Stop")),s[0]&32|s[1]&268435456&&(a.$$scope={dirty:s,ctx:n}),l.$set(a)},i(n){t||(k(l.$$.fragment,n),t=!0)},o(n){I(l.$$.fragment,n),t=!1},d(n){n&&g(e),Y(l)}}}function bn(r){let e,l,t,n,s;return{c(){e=S("button"),l=nt("svg"),t=nt("path"),this.h()},l(a){e=A(a,"BUTTON",{id:!0,class:!0,type:!0});var c=V(e);l=rt(c,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var i=V(l);t=rt(i,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),V(t).forEach(g),i.forEach(g),c.forEach(g),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),m(t,"clip-rule","evenodd"),m(l,"xmlns","http://www.w3.org/2000/svg"),m(l,"viewBox","0 0 16 16"),m(l,"fill","currentColor"),m(l,"class","size-5"),m(e,"id","send-message-button"),m(e,"class",n=(r[10]!==""||r[15].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center"),m(e,"type","submit"),e.disabled=s=r[10]===""&&r[15].length===0},m(a,c){L(a,e,c),R(e,l),R(l,t)},p(a,c){c[0]&33792&&n!==(n=(a[10]!==""||a[15].length!==0?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 self-center")&&m(e,"class",n),c[0]&33792&&s!==(s=a[10]===""&&a[15].length===0)&&(e.disabled=s)},d(a){a&&g(e)}}}function vn(r){let e,l='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',t,n;return{c(){e=S("button"),e.innerHTML=l,this.h()},l(s){e=A(s,"BUTTON",{class:!0,"data-svelte-h":!0}),De(e)!=="svelte-ciuta7"&&(e.innerHTML=l),this.h()},h(){m(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(s,a){L(s,e,a),t||(n=fe(e,"click",r[57]),t=!0)},p:ce,d(s){s&&g(e),t=!1,n()}}}function wn(r){let e,l,t=r[12]&&gt(r);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,s){t&&t.m(n,s),L(n,e,s),l=!0},p(n,s){n[12]?t?(t.p(n,s),s[0]&4096&&k(t,1)):(t=gt(n),t.c(),k(t,1),t.m(e.parentNode,e)):t&&(le(),I(t,1,1,()=>{t=null}),ne())},i(n){l||(k(t),l=!0)},o(n){I(t),l=!1},d(n){n&&g(e),t&&t.d(n)}}}const Et=r=>r.name;function kn(r,e,l){let t,n,s,a;he(r,sl,o=>l(22,t=o)),he(r,il,o=>l(61,s=o)),he(r,al,o=>l(24,a=o));let{$$slots:c={},$$scope:i}=e;const u=Ke("i18n");he(r,u,o=>l(23,n=o));let{placeholder:d=n.t("Type here...")}=e,{id:D=null}=e,{chatInputElement:v}=e,{typingUsers:y=[]}=e,{inputLoading:w=!1}=e,{onSubmit:E=o=>{}}=e,{onChange:C=o=>{}}=e,{onStop:B=o=>{}}=e,{scrollEnd:K=!0}=e,{scrollToBottom:O=()=>{}}=e,{disabled:N=!1}=e,{acceptFiles:M=!0}=e,{showFormattingToolbar:W=!0}=e,{userSuggestions:z=!1}=e,{channelSuggestions:U=!1}=e,{typingUsersClassName:T="from-white dark:from-gray-900"}=e,p=!1,f=!1,F=!1,x="",b=[],H,J,te=!1,de,me={},we={};const pe=async o=>(l(20,me=fl(o)),Object.keys(me).length===0?o:(l(18,te=!0),await new Promise(h=>{l(19,de=_=>{we={...we,..._},Lt(we),l(18,te=!1),h(o)})}))),Ce=async o=>{if(o.includes("{{CLIPBOARD}}")){const _=await navigator.clipboard.readText().catch(re=>(ue.error(n.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),j=await navigator.clipboard.read();let X=null;for(const re of j)for(const be of re.types)if(be.startsWith("image/")){const ve=await re.getType(be);X=URL.createObjectURL(ve)}X&&l(15,b=[...b,{type:"image",url:X}]),o=o.replaceAll("{{CLIPBOARD}}",_)}if(o.includes("{{USER_LOCATION}}")){let _;try{_=await dl()}catch{ue.error(n.t("Location access not allowed")),_="LOCATION_UNKNOWN"}o=o.replaceAll("{{USER_LOCATION}}",String(_))}const h=await wl(localStorage.token);if(o.includes("{{USER_NAME}}")){const _=(h==null?void 0:h.name)||"User";o=o.replaceAll("{{USER_NAME}}",_)}if(o.includes("{{USER_BIO}}")){const _=(h==null?void 0:h.bio)||"";_&&(o=o.replaceAll("{{USER_BIO}}",_))}if(o.includes("{{USER_GENDER}}")){const _=(h==null?void 0:h.gender)||"";_&&(o=o.replaceAll("{{USER_GENDER}}",_))}if(o.includes("{{USER_BIRTH_DATE}}")){const _=(h==null?void 0:h.date_of_birth)||"";_&&(o=o.replaceAll("{{USER_BIRTH_DATE}}",_))}if(o.includes("{{USER_AGE}}")){const _=(h==null?void 0:h.date_of_birth)||"";if(_){const j=ml(_);o=o.replaceAll("{{USER_AGE}}",j)}}if(o.includes("{{USER_LANGUAGE}}")){const _=localStorage.getItem("locale")||"en-US";o=o.replaceAll("{{USER_LANGUAGE}}",_)}if(o.includes("{{CURRENT_DATE}}")){const _=gl();o=o.replaceAll("{{CURRENT_DATE}}",_)}if(o.includes("{{CURRENT_TIME}}")){const _=hl();o=o.replaceAll("{{CURRENT_TIME}}",_)}if(o.includes("{{CURRENT_DATETIME}}")){const _=_l();o=o.replaceAll("{{CURRENT_DATETIME}}",_)}if(o.includes("{{CURRENT_TIMEZONE}}")){const _=pl();o=o.replaceAll("{{CURRENT_TIMEZONE}}",_)}if(o.includes("{{CURRENT_WEEKDAY}}")){const _=bl();o=o.replaceAll("{{CURRENT_WEEKDAY}}",_)}return o},Lt=o=>{document.getElementById("chat-input")&&(v.replaceVariables(o),v.focus())},Mt=async(o,h)=>{document.getElementById("chat-input")&&(o!==""&&(o=await Ce(o||"")),v==null||v.setText(o),v==null||v.focus(),o!==""&&(o=await pe(o)),await oe(),h&&await h(o))},qe=()=>{const o=document.getElementById("chat-input");let h="";return o&&(h=v==null?void 0:v.getWordAtDocPos()),h},Vt=o=>{document.getElementById("chat-input")&&(v==null||v.replaceCommandWithText(o))},Ne=async o=>{const h=document.getElementById("chat-input");if(!h)return;o=await Ce(o),ke?Vt(o):v==null||v.insertContent(o),await oe(),o=await pe(o),await oe();const _=document.getElementById("chat-input-container");_&&(_.scrollTop=_.scrollHeight),await oe(),h&&(h.focus(),h.dispatchEvent(new Event("input")),ol(prompt).length>0?await oe():h.scrollTop=h.scrollHeight)};let ke="",{showCommands:Be=!1}=e,Ge=null;const Nt=async()=>{try{const o=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),h=document.createElement("video");h.srcObject=o,await h.play();const _=document.createElement("canvas");_.width=h.videoWidth,_.height=h.videoHeight,_.getContext("2d").drawImage(h,0,0,_.width,_.height),o.getTracks().forEach(re=>re.stop()),window.focus();const X=_.toDataURL("image/png");l(15,b=[...b,{type:"image",url:X}]),h.srcObject=null}catch(o){}},Ae=async o=>{o.forEach(async h=>{var _,j,X,re;if(console.info("Processing file:",{name:h.name,type:h.type,size:h.size,extension:h.name.split(".").at(-1)}),(((_=s==null?void 0:s.file)==null?void 0:_.max_size)??null)!==null&&h.size>(((j=s==null?void 0:s.file)==null?void 0:j.max_size)??0)*1024*1024){h.size,(((X=s==null?void 0:s.file)==null?void 0:X.max_size)??0)*1024*1024,ue.error(n.t("File size should not exceed {{maxSize}} MB.",{maxSize:(re=s==null?void 0:s.file)==null?void 0:re.max_size}));return}if(h.type.startsWith("image/")){const be=async(ge,ee={},P={})=>{var Qe,$e,xe,et,tt,lt;const ye=(ee==null?void 0:ee.imageCompression)??!1,Ue=(($e=(Qe=P==null?void 0:P.file)==null?void 0:Qe.image_compression)==null?void 0:$e.width)??null,Re=((et=(xe=P==null?void 0:P.file)==null?void 0:xe.image_compression)==null?void 0:et.height)??null;if(!ye&&!Ue&&!Re)return ge;let Ee=null,Te=null;return ye&&(Ee=((tt=ee==null?void 0:ee.imageCompressionSize)==null?void 0:tt.width)??null,Te=((lt=ee==null?void 0:ee.imageCompressionSize)==null?void 0:lt.height)??null),Ue&&(Ee===null||Ee>Ue)&&(Ee=Ue),Re&&(Te===null||Te>Re)&&(Te=Re),Ee||Te?await vl(ge,Ee,Te):ge};let ve=new FileReader;ve.onload=async ge=>{let ee=ge.target.result;t!=null&&t.imageCompression&&(t!=null&&t.imageCompressionInChannels)&&(ee=await be(ee,t,s)),l(15,b=[...b,{type:"image",url:`${ee}`}])},ve.readAsDataURL(h.type==="image/heic"?await cl(h):h)}else Bt(h)})},Bt=async o=>{var j,X,re,be,ve,ge;const h=ul(),_={type:"file",file:"",id:null,url:"",name:o.name,collection_name:"",status:"uploading",size:o.size,error:"",itemId:h};if(_.size==0)return ue.error(n.t("You cannot upload an empty file.")),null;l(15,b=[...b,_]);try{let ee=null;(o.type.startsWith("audio/")||o.type.startsWith("video/"))&&((X=(j=t==null?void 0:t.audio)==null?void 0:j.stt)!=null&&X.language)&&(ee={language:(be=(re=t==null?void 0:t.audio)==null?void 0:re.stt)==null?void 0:be.language});const P=await Ul(localStorage.token,o,ee);P?(console.info("File upload completed:",{id:P.id,name:_.name,collection:(ve=P==null?void 0:P.meta)==null?void 0:ve.collection_name}),P.error&&(P.error,ue.warning(P.error)),_.status="uploaded",_.file=P,_.id=P.id,_.collection_name=((ge=P==null?void 0:P.meta)==null?void 0:ge.collection_name)||(P==null?void 0:P.collection_name),_.url=`${ze}/files/${P.id}`,l(15,b)):l(15,b=b.filter(ye=>(ye==null?void 0:ye.itemId)!==h))}catch(ee){ue.error(`${ee}`),l(15,b=b.filter(P=>(P==null?void 0:P.itemId)!==h))}},Ze=o=>{o.key==="Escape"&&l(13,f=!1)},Ye=o=>{var h,_;o.preventDefault(),(_=(h=o.dataTransfer)==null?void 0:h.types)!=null&&_.includes("Files")?l(13,f=!0):l(13,f=!1)},Je=()=>{l(13,f=!1)},Xe=async o=>{var h,_;if(o.preventDefault(),(h=o.dataTransfer)!=null&&h.files&&M){const j=Array.from((_=o.dataTransfer)==null?void 0:_.files);j&&j.length>0&&Ae(j)}l(13,f=!1)},Fe=async()=>{x===""&&b.length===0||(E({content:x,data:{files:b}}),l(10,x=""),l(15,b=[]),v&&(v==null||v.setText(""),await oe(),v.focus()))};St(async()=>{l(21,Ge=[{char:"@",render:He(ft,{i18n:u,triggerChar:"@",modelSuggestions:!0,userSuggestions:z})},...U?[{char:"#",render:He(ft,{i18n:u,triggerChar:"#",channelSuggestions:U})}]:[],{char:"/",render:He(Al,{i18n:u,onSelect:h=>{var X;const{type:_,data:j}=h;(X=document.getElementById("chat-input"))==null||X.focus()},insertTextHandler:Ne,onUpload:h=>{const{type:_,data:j}=h;if(_==="file"){if(b.find(X=>X.id===j.id))return;l(15,b=[...b,{...j,status:"processed"}])}}})}]),l(12,p=!0),window.setTimeout(()=>{v&&v.focus()},100),window.addEventListener("keydown",Ze),await oe();const o=document.getElementById("channel-container");o==null||o.addEventListener("dragover",Ye),o==null||o.addEventListener("drop",Xe),o==null||o.addEventListener("dragleave",Je)}),At(()=>{window.removeEventListener("keydown",Ze);const o=document.getElementById("channel-container");o&&(o==null||o.removeEventListener("dragover",Ye),o==null||o.removeEventListener("drop",Xe),o==null||o.removeEventListener("dragleave",Je))});function Ft(o){Ie[o?"unshift":"push"](()=>{H=o,l(16,H)})}function Ht(){J=this.files,l(17,J)}const zt=async()=>{J&&J.length>0?Ae(Array.from(J)):ue.error(n.t("File not found.")),l(16,H.value="",H)};function Ot(o){te=o,l(18,te)}const Pt=()=>{l(1,K=!0),O()},Wt=async()=>{l(14,F=!1),await oe(),v&&v.focus()},jt=async o=>{const{text:h,filename:_}=o;l(14,F=!1),await oe(),Ne(h),await oe(),v&&v.focus()};function Kt(o){F=o,l(14,F)}const qt=o=>{b.splice(o,1),l(15,b)},Gt=o=>{b.splice(o,1),l(15,b)},Zt=o=>{},Yt=o=>{const{md:h}=o;l(10,x=h),l(11,ke=qe())};function Jt(o){Ie[o?"unshift":"push"](()=>{v=o,l(0,v)})}const Xt=async o=>{o=o.detail.event,o.ctrlKey||o.metaKey,document.getElementById("suggestions-container")||(!a||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(o.keyCode===13&&!o.shiftKey&&o.preventDefault(),x!==""&&o.keyCode===13&&!o.shiftKey&&Fe()),o.key==="Escape"&&console.info("Escape")},Qt=async o=>{o=o.detail.event;const h=o.clipboardData||window.clipboardData;if(h&&h.items){for(const _ of h.items)if(_.type.indexOf("image")!==-1){const j=_.getAsFile(),X=new FileReader;X.onload=function(re){l(15,b=[...b,{type:"image",url:`${re.target.result}`}])},X.readAsDataURL(j)}else if((_==null?void 0:_.kind)==="file"){const j=_.getAsFile();j&&(await Ae([j]),o.preventDefault())}}},$t=()=>{H.click()},xt=async()=>{try{let o=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(h){return ue.error(n.t("Permission denied when accessing microphone: {{error}}",{error:h})),null});o&&(l(14,F=!0),o.getTracks().forEach(_=>_.stop())),o=null}catch{ue.error(n.t("Permission denied when accessing microphone"))}},el=()=>{B()},tl=()=>{Fe()};return r.$$set=o=>{"placeholder"in o&&l(2,d=o.placeholder),"id"in o&&l(32,D=o.id),"chatInputElement"in o&&l(0,v=o.chatInputElement),"typingUsers"in o&&l(3,y=o.typingUsers),"inputLoading"in o&&l(4,w=o.inputLoading),"onSubmit"in o&&l(33,E=o.onSubmit),"onChange"in o&&l(34,C=o.onChange),"onStop"in o&&l(5,B=o.onStop),"scrollEnd"in o&&l(1,K=o.scrollEnd),"scrollToBottom"in o&&l(6,O=o.scrollToBottom),"disabled"in o&&l(7,N=o.disabled),"acceptFiles"in o&&l(8,M=o.acceptFiles),"showFormattingToolbar"in o&&l(35,W=o.showFormattingToolbar),"userSuggestions"in o&&l(36,z=o.userSuggestions),"channelSuggestions"in o&&l(37,U=o.channelSuggestions),"typingUsersClassName"in o&&l(9,T=o.typingUsersClassName),"showCommands"in o&&l(31,Be=o.showCommands),"$$scope"in o&&l(59,i=o.$$scope)},r.$$.update=()=>{r.$$.dirty[0]&2048&&l(31,Be=["/"].includes(ke==null?void 0:ke.charAt(0))),r.$$.dirty[0]&1024|r.$$.dirty[1]&8&&x&&C()},[v,K,d,y,w,B,O,N,M,T,x,ke,p,f,F,b,H,J,te,de,me,Ge,t,n,a,u,qe,Ne,Nt,Ae,Fe,Be,D,E,C,W,z,U,Mt,c,Ft,Ht,zt,Ot,Pt,Wt,jt,Kt,qt,Gt,Zt,Yt,Jt,Xt,Qt,$t,xt,el,tl,i]}class Wn extends Oe{constructor(e){super(),Pe(this,e,kn,wn,Ve,{placeholder:2,id:32,chatInputElement:0,typingUsers:3,inputLoading:4,onSubmit:33,onChange:34,onStop:5,scrollEnd:1,scrollToBottom:6,disabled:7,acceptFiles:8,showFormattingToolbar:35,userSuggestions:36,channelSuggestions:37,typingUsersClassName:9,setText:38,showCommands:31},null,[-1,-1,-1])}get setText(){return this.$$.ctx[38]}}export{Wn as M};
//# sourceMappingURL=pMHu8OHI.js.map
