import{S as Ie,i as Te,s as Ve,e as b,t as W,l as Y,c as k,a as y,b as Z,d,p as G,N as et,f as c,g as j,h as _,L as se,G as M,j as Q,n as Ae,O as Ce,v as Me,k as ae,w as We,H as me,q as P,y as Ze,u as Qe,r as J,a0 as $e,C as ne,D as oe,E as ie,F as ue,I as Pe,T as tt,$ as qe,K as Xe,M as Ee,a1 as st}from"../chunks/BpeRjEzf.js";import"../chunks/IHki7fMi.js";import{e as De}from"../chunks/C5oNBBkD.js";import{t as lt}from"../chunks/W3liupZx.js";import{g as rt}from"../chunks/3K180Vpd.js";import{c as at,a as nt,u as ot,d as it,g as ut}from"../chunks/B863V-9z.js";import{c as ct}from"../chunks/Bv_Yi17F.js";import{i as ft}from"../chunks/BvhXBtnk.js";import{C as dt}from"../chunks/CWGXEtOf.js";import{C as ht}from"../chunks/bWw19DeO.js";import{P as gt}from"../chunks/wao1Aep9.js";function _t(l){let e,s,t,r=l[4].t(l[0].role)+"",i,n,o,a,g,D,m,f,T,w='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path></svg>',C,E;return{c(){e=b("div"),s=b("div"),t=b("div"),i=W(r),n=Y(),o=b("div"),a=b("textarea"),m=Y(),f=b("div"),T=b("button"),T.innerHTML=w,this.h()},l(h){e=k(h,"DIV",{class:!0});var p=y(e);s=k(p,"DIV",{class:!0});var z=y(s);t=k(z,"DIV",{class:!0});var S=y(t);i=Z(S,r),S.forEach(d),z.forEach(d),n=G(p),o=k(p,"DIV",{class:!0});var N=y(o);a=k(N,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),y(a).forEach(d),N.forEach(d),m=G(p),f=k(p,"DIV",{class:!0});var x=y(f);T=k(x,"BUTTON",{class:!0,"data-svelte-h":!0}),et(T)!=="svelte-8q5l7q"&&(T.innerHTML=w),x.forEach(d),p.forEach(d),this.h()},h(){c(t,"class","px-2 py-1 text-sm font-semibold uppercase min-w-[6rem] text-left rounded-lg transition"),c(s,"class","flex items-start pt-1"),c(a,"id",g=l[0].role+"-"+l[1]+"-textarea"),c(a,"class","w-full bg-transparent outline-hidden rounded-lg p-2 text-sm resize-none overflow-hidden"),c(a,"placeholder",D=l[4].t("Enter {{role}} message here",{role:l[0].role==="user"?l[4].t("a user"):l[4].t("an assistant")})),c(a,"rows","1"),c(o,"class","flex-1"),c(T,"class","group-hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-300 transition"),c(f,"class","pt-1"),c(e,"class","flex gap-2 group")},m(h,p){j(h,e,p),_(e,s),_(s,t),_(t,i),_(e,n),_(e,o),_(o,a),l[6](a),se(a,l[0].content),_(e,m),_(e,f),_(f,T),C||(E=[M(a,"input",l[7]),M(a,"focus",l[8]),M(a,"input",l[9]),M(T,"click",l[10])],C=!0)},p(h,[p]){p&17&&r!==(r=h[4].t(h[0].role)+"")&&Q(i,r),p&3&&g!==(g=h[0].role+"-"+h[1]+"-textarea")&&c(a,"id",g),p&17&&D!==(D=h[4].t("Enter {{role}} message here",{role:h[0].role==="user"?h[4].t("a user"):h[4].t("an assistant")}))&&c(a,"placeholder",D),p&1&&se(a,h[0].content)},i:Ae,o:Ae,d(h){h&&d(e),l[6](null),C=!1,Ce(E)}}}function mt(l,e,s){let t;const r=Me("i18n");ae(l,r,w=>s(4,t=w));let{message:i}=e,{idx:n}=e,{onDelete:o}=e,a;We(()=>{s(3,a.style.height="",a),s(3,a.style.height=a.scrollHeight+"px",a)});function g(w){me[w?"unshift":"push"](()=>{a=w,s(3,a)})}const D=w=>{s(3,a.style.height="",a),s(3,a.style.height=a.scrollHeight+"px",a)},m=w=>{s(3,a.style.height="",a),s(3,a.style.height=a.scrollHeight+"px",a)};function f(){i.content=this.value,s(0,i)}const T=()=>{o()};return l.$$set=w=>{"message"in w&&s(0,i=w.message),"idx"in w&&s(1,n=w.idx),"onDelete"in w&&s(2,o=w.onDelete)},[i,n,o,a,t,r,g,D,m,f,T]}class pt extends Ie{constructor(e){super(),Te(this,e,mt,_t,Ve,{message:0,idx:1,onDelete:2})}}function Fe(l,e,s){const t=l.slice();return t[3]=e[s],t[5]=s,t}function Ye(l){let e,s;function t(){return l[1](l[5])}return e=new pt({props:{message:l[3],idx:l[5],onDelete:t}}),{c(){ne(e.$$.fragment)},l(r){oe(e.$$.fragment,r)},m(r,i){ie(e,r,i),s=!0},p(r,i){l=r;const n={};i&1&&(n.message=l[3]),i&1&&(n.onDelete=t),e.$set(n)},i(r){s||(P(e.$$.fragment,r),s=!0)},o(r){J(e.$$.fragment,r),s=!1},d(r){ue(e,r)}}}function vt(l){let e,s,t=De(l[0]),r=[];for(let n=0;n<t.length;n+=1)r[n]=Ye(Fe(l,t,n));const i=n=>J(r[n],1,1,()=>{r[n]=null});return{c(){e=b("div");for(let n=0;n<r.length;n+=1)r[n].c();this.h()},l(n){e=k(n,"DIV",{class:!0});var o=y(e);for(let a=0;a<r.length;a+=1)r[a].l(o);o.forEach(d),this.h()},h(){c(e,"class","py-3 space-y-3")},m(n,o){j(n,e,o);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);s=!0},p(n,[o]){if(o&1){t=De(n[0]);let a;for(a=0;a<t.length;a+=1){const g=Fe(n,t,a);r[a]?(r[a].p(g,o),P(r[a],1)):(r[a]=Ye(g),r[a].c(),P(r[a],1),r[a].m(e,null))}for(Ze(),a=t.length;a<r.length;a+=1)i(a);Qe()}},i(n){if(!s){for(let o=0;o<t.length;o+=1)P(r[o]);s=!0}},o(n){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)J(r[o]);s=!1},d(n){n&&d(e),$e(r,n)}}}function bt(l,e,s){Me("i18n");let{messages:t=[]}=e;const r=i=>{s(0,t=t.filter((n,o)=>o!==i))};return l.$$set=i=>{"messages"in i&&s(0,t=i.messages)},[t,r]}class kt extends Ie{constructor(e){super(),Te(this,e,bt,vt,Ve,{messages:0})}}function Ge(l,e,s){const t=l.slice();return t[37]=e[s],t}function Je(l){let e,s;return{c(){e=b("div"),s=W(l[5]),this.h()},l(t){e=k(t,"DIV",{class:!0});var r=y(e);s=Z(r,l[5]),r.forEach(d),this.h()},h(){c(e,"class","flex-1 text-gray-500 line-clamp-1")},m(t,r){j(t,e,r),_(e,s)},p(t,r){r[0]&32&&Q(s,t[5])},d(t){t&&d(e)}}}function yt(l){let e,s;return e=new gt({props:{className:"size-3.5"}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){ie(e,t,r),s=!0},i(t){s||(P(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}function wt(l){let e,s;return e=new ht({props:{className:"size-3.5"}}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){ie(e,t,r),s=!0},i(t){s||(P(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}function Et(l){let e,s,t=l[11].t("System Instructions")+"",r,i,n,o,a,g,D,m,f=!l[0]&&Je(l);const T=[wt,yt],w=[];function C(E,h){return E[0]?0:1}return g=C(l),D=w[g]=T[g](l),{c(){e=b("div"),s=b("div"),r=W(t),i=Y(),f&&f.c(),n=Y(),o=b("div"),a=b("button"),D.c(),this.h()},l(E){e=k(E,"DIV",{class:!0});var h=y(e);s=k(h,"DIV",{class:!0});var p=y(s);r=Z(p,t),p.forEach(d),i=G(h),f&&f.l(h),n=G(h),o=k(h,"DIV",{class:!0});var z=y(o);a=k(z,"BUTTON",{class:!0});var S=y(a);D.l(S),S.forEach(d),z.forEach(d),h.forEach(d),this.h()},h(){c(s,"class","shrink-0 font-medium ml-1.5"),c(a,"class","p-1.5 bg-transparent hover:bg-white/5 transition rounded-lg"),c(o,"class","shrink-0"),c(e,"class","flex gap-2 justify-between items-center")},m(E,h){j(E,e,h),_(e,s),_(s,r),_(e,i),f&&f.m(e,null),_(e,n),_(e,o),_(o,a),w[g].m(a,null),m=!0},p(E,h){(!m||h[0]&2048)&&t!==(t=E[11].t("System Instructions")+"")&&Q(r,t),E[0]?f&&(f.d(1),f=null):f?f.p(E,h):(f=Je(E),f.c(),f.m(e,n));let p=g;g=C(E),g!==p&&(Ze(),J(w[p],1,1,()=>{w[p]=null}),Qe(),D=w[g],D||(D=w[g]=T[g](E),D.c()),P(D,1),D.m(a,null))},i(E){m||(P(D),m=!0)},o(E){J(D),m=!1},d(E){E&&d(e),f&&f.d(),w[g].d()}}}function Dt(l){let e,s,t,r,i,n;return{c(){e=b("div"),s=b("div"),t=b("textarea"),this.h()},l(o){e=k(o,"DIV",{slot:!0});var a=y(e);s=k(a,"DIV",{class:!0});var g=y(s);t=k(g,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),y(t).forEach(d),g.forEach(d),a.forEach(d),this.h()},h(){c(t,"class","w-full h-full bg-transparent resize-none outline-hidden text-sm"),c(t,"placeholder",r=l[11].t("You're a helpful assistant.")),c(t,"rows","4"),c(s,"class","pt-1 px-1.5"),c(e,"slot","content")},m(o,a){j(o,e,a),_(e,s),_(s,t),l[17](t),se(t,l[5]),i||(n=[M(t,"input",l[18]),M(t,"input",l[19])],i=!0)},p(o,a){a[0]&2048&&r!==(r=o[11].t("You're a helpful assistant."))&&c(t,"placeholder",r),a[0]&32&&se(t,o[5])},d(o){o&&d(e),l[17](null),i=!1,Ce(n)}}}function It(l){let e=l[11].t("Assistant")+"",s;return{c(){s=W(e)},l(t){s=Z(t,e)},m(t,r){j(t,s,r)},p(t,r){r[0]&2048&&e!==(e=t[11].t("Assistant")+"")&&Q(s,e)},d(t){t&&d(s)}}}function Tt(l){let e=l[11].t("User")+"",s;return{c(){s=W(e)},l(t){s=Z(t,e)},m(t,r){j(t,s,r)},p(t,r){r[0]&2048&&e!==(e=t[11].t("User")+"")&&Q(s,e)},d(t){t&&d(s)}}}function Ke(l){let e,s=l[37].name+"",t,r;return{c(){e=b("option"),t=W(s),this.h()},l(i){e=k(i,"OPTION",{class:!0});var n=y(e);t=Z(n,s),n.forEach(d),this.h()},h(){e.__value=r=l[37].id,se(e,e.__value),c(e,"class","bg-gray-50 dark:bg-gray-700")},m(i,n){j(i,e,n),_(e,t)},p(i,n){n[0]&1024&&s!==(s=i[37].name+"")&&Q(t,s),n[0]&1024&&r!==(r=i[37].id)&&(e.__value=r,se(e,e.__value))},d(i){i&&d(e)}}}function Vt(l){let e,s=l[11].t("Cancel")+"",t,r,i;return{c(){e=b("button"),t=W(s),this.h()},l(n){e=k(n,"BUTTON",{class:!0});var o=y(e);t=Z(o,s),o.forEach(d),this.h()},h(){c(e,"class","px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-lg")},m(n,o){j(n,e,o),_(e,t),r||(i=M(e,"click",l[30]),r=!0)},p(n,o){o[0]&2048&&s!==(s=n[11].t("Cancel")+"")&&Q(t,s)},d(n){n&&d(e),r=!1,i()}}}function Ct(l){let e,s=l[11].t("Add")+"",t,r,i,n,o=l[11].t("Run")+"",a,g,D;return{c(){e=b("button"),t=W(s),i=Y(),n=b("button"),a=W(o),this.h()},l(m){e=k(m,"BUTTON",{class:!0});var f=y(e);t=Z(f,s),f.forEach(d),i=G(m),n=k(m,"BUTTON",{class:!0});var T=y(n);a=Z(T,o),T.forEach(d),this.h()},h(){e.disabled=r=l[7]==="",c(e,"class","px-3.5 py-1.5 text-sm font-medium disabled:bg-gray-50 dark:disabled:hover:bg-gray-850 disabled:cursor-not-allowed bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg"),c(n,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-lg")},m(m,f){j(m,e,f),_(e,t),j(m,i,f),j(m,n,f),_(n,a),g||(D=[M(e,"click",l[28]),M(n,"click",l[29])],g=!0)},p(m,f){f[0]&2048&&s!==(s=m[11].t("Add")+"")&&Q(t,s),f[0]&128&&r!==(r=m[7]==="")&&(e.disabled=r),f[0]&2048&&o!==(o=m[11].t("Run")+"")&&Q(a,o)},d(m){m&&(d(e),d(i),d(n)),g=!1,Ce(D)}}}function xt(l){let e,s,t,r,i,n,o,a,g,D,m,f,T,w,C,E,h,p,z,S,N,x,$,le,re,ce,q,ee,U,fe,K,X,de,pe;function xe(u){l[20](u)}let ve={className:"w-full flex-1",buttonClassName:"w-full rounded-lg text-sm border border-gray-100 dark:border-gray-850 w-full py-1 px-1.5",grow:!0,$$slots:{content:[Dt],default:[Et]},$$scope:{ctx:l}};l[0]!==void 0&&(ve.open=l[0]),i=new dt({props:ve}),me.push(()=>Pe(i,"open",xe));function Se(u){l[21](u)}let be={};l[8]!==void 0&&(be.messages=l[8]),m=new kt({props:be}),me.push(()=>Pe(m,"messages",Se));function v(u,I){return u[6]==="user"?Tt:It}let te=v(l),B=te(l),L=De(l[10]),V=[];for(let u=0;u<L.length;u+=1)V[u]=Ke(Ge(l,L,u));function he(u,I){return u[2]?Vt:Ct}let F=he(l),O=F(l);return{c(){e=b("div"),s=b("div"),t=b("div"),r=b("div"),ne(i.$$.fragment),o=Y(),a=b("div"),g=b("div"),D=b("div"),ne(m.$$.fragment),T=Y(),w=b("div"),C=b("div"),E=b("div"),h=b("textarea"),z=Y(),S=b("div"),N=b("div"),x=b("button"),B.c(),ce=Y(),q=b("div"),ee=b("div"),U=b("select");for(let u=0;u<V.length;u+=1)V[u].c();fe=Y(),K=b("div"),O.c(),this.h()},l(u){e=k(u,"DIV",{class:!0});var I=y(e);s=k(I,"DIV",{class:!0});var H=y(s);t=k(H,"DIV",{class:!0});var R=y(t);r=k(R,"DIV",{class:!0});var ge=y(r);oe(i.$$.fragment,ge),ge.forEach(d),o=G(R),a=k(R,"DIV",{class:!0,id:!0});var A=y(a);g=k(A,"DIV",{class:!0});var _e=y(g);D=k(_e,"DIV",{class:!0});var Ne=y(D);oe(m.$$.fragment,Ne),Ne.forEach(d),_e.forEach(d),A.forEach(d),T=G(R),w=k(R,"DIV",{class:!0});var Ue=y(w);C=k(Ue,"DIV",{class:!0});var ke=y(C);E=k(ke,"DIV",{class:!0});var Be=y(E);h=k(Be,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),y(h).forEach(d),Be.forEach(d),z=G(ke),S=k(ke,"DIV",{class:!0});var ye=y(S);N=k(ye,"DIV",{class:!0});var Oe=y(N);x=k(Oe,"BUTTON",{type:!0,class:!0,"aria-pressed":!0,"aria-label":!0});var Re=y(x);B.l(Re),Re.forEach(d),Oe.forEach(d),ce=G(ye),q=k(ye,"DIV",{class:!0});var we=y(q);ee=k(we,"DIV",{class:!0});var je=y(ee);U=k(je,"SELECT",{class:!0});var ze=y(U);for(let He=0;He<V.length;He+=1)V[He].l(ze);ze.forEach(d),je.forEach(d),fe=G(we),K=k(we,"DIV",{class:!0});var Le=y(K);O.l(Le),Le.forEach(d),we.forEach(d),ye.forEach(d),ke.forEach(d),Ue.forEach(d),R.forEach(d),H.forEach(d),I.forEach(d),this.h()},h(){var u;c(r,"class","flex w-full items-start gap-1.5"),c(D,"class","flex-1 p-1"),c(g,"class","h-full w-full flex flex-col"),c(a,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0"),c(a,"id","messages-container"),c(h,"class","w-full h-full bg-transparent resize-none outline-hidden text-sm"),c(h,"placeholder",p=l[11].t("Enter {{role}} message here",{role:l[6]==="user"?l[11].t("a user"):l[11].t("an assistant")})),c(h,"rows","2"),c(E,"class","py-0.5"),c(x,"type","button"),c(x,"class",$="px-3.5 py-1.5 text-sm font-medium bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg shrink-0 "+(((u=l[9])==null?void 0:u.highContrastMode)??!1?"":"outline-hidden")),c(x,"aria-pressed",le=l[6]==="assistant"),c(x,"aria-label",re=l[11].t(l[6]==="user"?"Switch to Assistant role":"Switch to User role")),c(N,"class","flex-1 shrink-0"),c(U,"class","bg-transparent border border-gray-100 dark:border-gray-850 rounded-lg py-1 px-2 -mx-0.5 text-sm outline-hidden w-full"),l[1]===void 0&&tt(()=>l[27].call(U)),c(ee,"class","flex-1"),c(K,"class","flex gap-2 shrink-0"),c(q,"class","flex items-center justify-between gap-2 w-full sm:w-auto"),c(S,"class","flex justify-between flex-col sm:flex-row items-start sm:items-center gap-2 mt-2"),c(C,"class","border border-gray-100 dark:border-gray-850 w-full px-3 py-2.5 rounded-xl"),c(w,"class","pb-3"),c(t,"class","flex flex-col h-full px-3.5"),c(s,"class","mx-auto w-full md:px-0 h-full relative"),c(e,"class","flex flex-col justify-between w-full overflow-y-auto h-full")},m(u,I){j(u,e,I),_(e,s),_(s,t),_(t,r),ie(i,r,null),_(t,o),_(t,a),_(a,g),_(g,D),ie(m,D,null),l[22](a),_(t,T),_(t,w),_(w,C),_(C,E),_(E,h),se(h,l[7]),_(C,z),_(C,S),_(S,N),_(N,x),B.m(x,null),_(S,ce),_(S,q),_(q,ee),_(ee,U);for(let H=0;H<V.length;H+=1)V[H]&&V[H].m(U,null);qe(U,l[1],!0),_(q,fe),_(q,K),O.m(K,null),X=!0,de||(pe=[M(h,"input",l[23]),M(h,"input",l[24]),M(h,"focus",l[25]),M(x,"click",l[26]),M(U,"change",l[27])],de=!0)},p(u,I){var ge;const H={};I[0]&2089|I[1]&512&&(H.$$scope={dirty:I,ctx:u}),!n&&I[0]&1&&(n=!0,H.open=u[0],Xe(()=>n=!1)),i.$set(H);const R={};if(!f&&I[0]&256&&(f=!0,R.messages=u[8],Xe(()=>f=!1)),m.$set(R),(!X||I[0]&2112&&p!==(p=u[11].t("Enter {{role}} message here",{role:u[6]==="user"?u[11].t("a user"):u[11].t("an assistant")})))&&c(h,"placeholder",p),I[0]&128&&se(h,u[7]),te===(te=v(u))&&B?B.p(u,I):(B.d(1),B=te(u),B&&(B.c(),B.m(x,null))),(!X||I[0]&512&&$!==($="px-3.5 py-1.5 text-sm font-medium bg-gray-50 hover:bg-gray-100 text-gray-900 dark:bg-gray-850 dark:hover:bg-gray-800 dark:text-gray-200 transition rounded-lg shrink-0 "+(((ge=u[9])==null?void 0:ge.highContrastMode)??!1?"":"outline-hidden")))&&c(x,"class",$),(!X||I[0]&64&&le!==(le=u[6]==="assistant"))&&c(x,"aria-pressed",le),(!X||I[0]&2112&&re!==(re=u[11].t(u[6]==="user"?"Switch to Assistant role":"Switch to User role")))&&c(x,"aria-label",re),I[0]&1024){L=De(u[10]);let A;for(A=0;A<L.length;A+=1){const _e=Ge(u,L,A);V[A]?V[A].p(_e,I):(V[A]=Ke(_e),V[A].c(),V[A].m(U,null))}for(;A<V.length;A+=1)V[A].d(1);V.length=L.length}I[0]&1026&&qe(U,u[1]),F===(F=he(u))&&O?O.p(u,I):(O.d(1),O=F(u),O&&(O.c(),O.m(K,null)))},i(u){X||(P(i.$$.fragment,u),P(m.$$.fragment,u),X=!0)},o(u){J(i.$$.fragment,u),J(m.$$.fragment,u),X=!1},d(u){u&&d(e),ue(i),ue(m),l[22](null),B.d(),$e(V,u),O.d(),de=!1,Ce(pe)}}}function St(l,e,s){let t,r,i,n,o;ae(l,at,v=>s(33,t=v)),ae(l,nt,v=>s(9,r=v)),ae(l,ot,v=>s(34,i=v)),ae(l,it,v=>s(10,n=v));const a=Me("i18n");ae(l,a,v=>s(11,o=v));let g="",D=!1,m=!1,f,T,w=!1,C="",E="user",h="",p=[];const z=()=>{const v=T;v&&(v.scrollTop=v==null?void 0:v.scrollHeight)},S=()=>{m=!0},N=async()=>{await Ee(),f&&(s(3,f.style.height="",f),s(3,f.style.height=Math.min(f.scrollHeight,555)+"px",f))},x=async()=>{var he;if(g===""){lt.error(o.t("Please select a model."));return}const v=n.find(F=>F.id===g);if(!v){s(1,g="");return}const[te,B]=await ct(localStorage.token,{model:v.id,stream:!0,messages:[C?{role:"system",content:C}:void 0,...p].filter(F=>F)},`${ut}/api`);let L;((he=p.at(-1))==null?void 0:he.role)==="assistant"?L=p.at(-1):(L={role:"assistant",content:""},p.push(L),s(8,p)),await Ee();const V=document.getElementById(`assistant-${p.length-1}-textarea`);if(te&&te.ok){const F=te.body.pipeThrough(new TextDecoderStream).pipeThrough(ft(`
`)).getReader();for(;;){const{value:O,done:u}=await F.read();if(u||m){m&&B.abort("User: Stop Response");break}try{let I=O.split(`
`);for(const H of I)if(H!=="")if(H==="data: [DONE]")s(8,p);else{let R=JSON.parse(H.replace(/^data: /,""));if(L.content==""&&R.choices[0].delta.content==`
`)continue;V.style.height=V.scrollHeight+"px",L.content+=R.choices[0].delta.content??"",s(8,p),V.style.height=V.scrollHeight+"px",await Ee()}}catch(I){}z()}}},$=async()=>{h&&(p.push({role:E,content:h}),s(8,p),s(7,h=""),await Ee(),z())},le=async()=>{g&&(await $(),s(2,D=!0),await x(),s(2,D=!1),m=!1)};We(async()=>{(i==null?void 0:i.role)!=="admin"&&await rt("/"),r!=null&&r.models?s(1,g=r==null?void 0:r.models[0]):t!=null&&t.default_models?s(1,g=t==null?void 0:t.default_models.split(",")[0]):s(1,g="")});function re(v){me[v?"unshift":"push"](()=>{f=v,s(3,f)})}function ce(){C=this.value,s(5,C)}const q=()=>{N()};function ee(v){w=v,s(0,w)}function U(v){p=v,s(8,p)}function fe(v){me[v?"unshift":"push"](()=>{T=v,s(4,T)})}function K(){h=this.value,s(7,h)}const X=v=>{v.target.style.height="",v.target.style.height=Math.min(v.target.scrollHeight,150)+"px"},de=v=>{v.target.style.height="",v.target.style.height=Math.min(v.target.scrollHeight,150)+"px"},pe=()=>{s(6,E=E==="user"?"assistant":"user")};function xe(){g=st(this),s(1,g)}const ve=()=>{$(),s(6,E=E==="user"?"assistant":"user")},Se=()=>{le()},be=()=>{S()};return l.$$.update=()=>{l.$$.dirty[0]&1&&w&&N()},[w,g,D,f,T,C,E,h,p,r,n,o,a,S,N,$,le,re,ce,q,ee,U,fe,K,X,de,pe,xe,ve,Se,be]}class Ht extends Ie{constructor(e){super(),Te(this,e,St,xt,Ve,{},null,[-1,-1])}}function At(l){let e,s;return e=new Ht({}),{c(){ne(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,r){ie(e,t,r),s=!0},p:Ae,i(t){s||(P(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}class Xt extends Ie{constructor(e){super(),Te(this,e,null,At,Ve,{})}}export{Xt as component};
//# sourceMappingURL=26.BCIlBC0l.js.map
