import{S as $,i as ee,s as te,H as le,I as fe,e as _,C as se,l as W,c as v,a as g,D as ae,d as u,p as X,f as c,g as O,h as f,E as oe,L as Q,G as q,K as pe,q as re,r as ne,F as ie,k as H,v as me,w as he,t as ce,b as ue,j as de,n as _e}from"../chunks/BpeRjEzf.js";import"../chunks/IHki7fMi.js";import"../chunks/W3liupZx.js";import{g as ve}from"../chunks/3K180Vpd.js";import{c as ge,a as be,u as we,d as xe,g as ke}from"../chunks/B863V-9z.js";import{c as Ee}from"../chunks/Bv_Yi17F.js";import{i as ye}from"../chunks/BvhXBtnk.js";import{S as De}from"../chunks/CyvomhRm.js";function Ie(s){let e,t=s[5].t("Cancel")+"",l,r,d;return{c(){e=_("button"),l=ce(t),this.h()},l(a){e=v(a,"BUTTON",{class:!0});var i=g(e);l=ue(i,t),i.forEach(u),this.h()},h(){c(e,"class","px-3 py-1.5 text-sm font-medium bg-gray-300 text-black transition rounded-full")},m(a,i){O(a,e,i),f(e,l),r||(d=q(e,"click",s[13]),r=!0)},p(a,i){i&32&&t!==(t=a[5].t("Cancel")+"")&&de(l,t)},d(a){a&&u(e),r=!1,d()}}}function Se(s){let e,t=s[5].t("Run")+"",l,r,d;return{c(){e=_("button"),l=ce(t),this.h()},l(a){e=v(a,"BUTTON",{class:!0});var i=g(e);l=ue(i,t),i.forEach(u),this.h()},h(){c(e,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full")},m(a,i){O(a,e,i),f(e,l),r||(d=q(e,"click",s[12]),r=!0)},p(a,i){i&32&&t!==(t=a[5].t("Run")+"")&&de(l,t)},d(a){a&&u(e),r=!1,d()}}}function Ve(s){let e,t,l,r,d,a,i,D,p,w,V,x,k,S,m,C,R,I,T,U,N;function F(n){s[9](n)}let o={placeholder:s[5].t("Select a model"),items:s[4].map(Z)};s[1]!==void 0&&(o.value=s[1]),p=new De({props:o}),le.push(()=>fe(p,"value",F));function j(n,b){return n[2]?Ie:Se}let B=j(s),h=B(s);return{c(){e=_("div"),t=_("div"),l=_("div"),r=_("div"),d=_("div"),a=_("div"),i=_("div"),D=_("div"),se(p.$$.fragment),V=W(),x=_("div"),k=_("div"),S=_("div"),m=_("textarea"),R=W(),I=_("div"),h.c(),this.h()},l(n){e=v(n,"DIV",{class:!0});var b=g(e);t=v(b,"DIV",{class:!0});var E=g(t);l=v(E,"DIV",{class:!0});var y=g(l);r=v(y,"DIV",{class:!0});var A=g(r);d=v(A,"DIV",{class:!0});var L=g(d);a=v(L,"DIV",{class:!0});var M=g(a);i=v(M,"DIV",{class:!0});var Y=g(i);D=v(Y,"DIV",{class:!0});var z=g(D);ae(p.$$.fragment,z),z.forEach(u),Y.forEach(u),M.forEach(u),L.forEach(u),A.forEach(u),V=X(y),x=v(y,"DIV",{class:!0,id:!0});var G=g(x);k=v(G,"DIV",{class:!0});var J=g(k);S=v(J,"DIV",{class:!0});var K=g(S);m=v(K,"TEXTAREA",{id:!0,class:!0,placeholder:!0}),g(m).forEach(u),K.forEach(u),J.forEach(u),G.forEach(u),R=X(y),I=v(y,"DIV",{class:!0});var P=g(I);h.l(P),P.forEach(u),y.forEach(u),E.forEach(u),b.forEach(u),this.h()},h(){c(D,"class","max-w-full"),c(i,"class","overflow-hidden w-full"),c(a,"class","flex w-full"),c(d,"class","flex flex-col gap-1 w-full"),c(r,"class","flex flex-col justify-between mb-1 gap-1"),c(m,"id","text-completion-textarea"),c(m,"class","w-full h-full p-3 bg-transparent border border-gray-100 dark:border-gray-850 outline-hidden resize-none rounded-lg text-sm"),c(m,"placeholder",C=s[5].t("You're a helpful assistant.")),c(S,"class","flex-1"),c(k,"class","h-full w-full flex flex-col"),c(x,"class","pt-0.5 pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0"),c(x,"id","messages-container"),c(I,"class","pb-3 flex justify-end"),c(l,"class","flex flex-col h-full px-4"),c(t,"class","mx-auto w-full md:px-0 h-full"),c(e,"class","flex flex-col justify-between w-full overflow-y-auto h-full")},m(n,b){O(n,e,b),f(e,t),f(t,l),f(l,r),f(r,d),f(d,a),f(a,i),f(i,D),oe(p,D,null),f(l,V),f(l,x),f(x,k),f(k,S),f(S,m),s[10](m),Q(m,s[0]),f(l,R),f(l,I),h.m(I,null),T=!0,U||(N=q(m,"input",s[11]),U=!0)},p(n,[b]){const E={};b&32&&(E.placeholder=n[5].t("Select a model")),b&16&&(E.items=n[4].map(Z)),!w&&b&2&&(w=!0,E.value=n[1],pe(()=>w=!1)),p.$set(E),(!T||b&32&&C!==(C=n[5].t("You're a helpful assistant.")))&&c(m,"placeholder",C),b&1&&Q(m,n[0]),B===(B=j(n))&&h?h.p(n,b):(h.d(1),h=B(n),h&&(h.c(),h.m(I,null)))},i(n){T||(re(p.$$.fragment,n),T=!0)},o(n){ne(p.$$.fragment,n),T=!1},d(n){n&&u(e),ie(p),s[10](null),h.d(),U=!1,N()}}}const Z=s=>({value:s.id,label:s.name,model:s});function Te(s,e,t){let l,r,d,a,i;H(s,ge,o=>t(16,l=o)),H(s,be,o=>t(17,r=o)),H(s,we,o=>t(18,d=o)),H(s,xe,o=>t(4,a=o));const D=me("i18n");H(s,D,o=>t(5,i=o));let p="",w="",V=!1,x=!1,k;const S=()=>{const o=k;o&&(o.scrollTop=o==null?void 0:o.scrollHeight)},m=()=>{x=!0},C=async()=>{const o=a.find(h=>h.id===w),[j,B]=await Ee(localStorage.token,{model:o.id,stream:!0,messages:[{role:"assistant",content:p}]},`${ke}/api`);if(j&&j.ok){const h=j.body.pipeThrough(new TextDecoderStream).pipeThrough(ye(`
`)).getReader();for(;;){const{value:n,done:b}=await h.read();if(b||x){x&&B.abort("User: Stop Response");break}try{let E=n.split(`
`);for(const y of E)if(y!==""&&!y.includes("[DONE]")){let A=JSON.parse(y.replace(/^data: /,""));t(0,p+=A.choices[0].delta.content??"")}}catch(E){}S()}}},R=async()=>{w&&(t(2,V=!0),await C(),t(2,V=!1),x=!1)};he(async()=>{(d==null?void 0:d.role)!=="admin"&&await ve("/"),r!=null&&r.models?t(1,w=r==null?void 0:r.models[0]):l!=null&&l.default_models?t(1,w=l==null?void 0:l.default_models.split(",")[0]):t(1,w="")});function I(o){w=o,t(1,w)}function T(o){le[o?"unshift":"push"](()=>{k=o,t(3,k)})}function U(){p=this.value,t(0,p)}return[p,w,V,k,a,i,D,m,R,I,T,U,()=>{R()},()=>{m()}]}class Ce extends ${constructor(e){super(),ee(this,e,Te,Ve,te,{})}}function Re(s){let e,t;return e=new Ce({}),{c(){se(e.$$.fragment)},l(l){ae(e.$$.fragment,l)},m(l,r){oe(e,l,r),t=!0},p:_e,i(l){t||(re(e.$$.fragment,l),t=!0)},o(l){ne(e.$$.fragment,l),t=!1},d(l){ie(e,l)}}}class Fe extends ${constructor(e){super(),ee(this,e,null,Re,te,{})}}export{Fe as component};
//# sourceMappingURL=27.BY7aPHuj.js.map
